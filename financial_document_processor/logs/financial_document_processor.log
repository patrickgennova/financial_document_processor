2025-05-10 09:05:59.543 | INFO     | financial_document_processor.utils.logging:setup_logging:69 - Sistema de logging configurado com nível INFO
2025-05-10 09:05:59.564 | INFO     | logging:callHandlers:1706 - Inicializando aplicação...
2025-05-10 09:05:59.734 | INFO     | logging:callHandlers:1706 - Conexão estabelecida com o PostgreSQL. Pool criado com 5-20 conexões.
2025-05-10 09:05:59.750 | INFO     | logging:callHandlers:1706 - Esquema do banco de dados verificado/criado com sucesso
2025-05-10 09:05:59.782 | INFO     | logging:callHandlers:1706 - Produtor Kafka iniciado
2025-05-10 09:05:59.782 | ERROR    | logging:callHandlers:1706 - Erro ao inicializar aplicação: Chave de API da OpenAI não configurada
2025-05-10 09:05:59.782 | ERROR    | logging:callHandlers:1706 - Erro fatal na aplicação: Chave de API da OpenAI não configurada
2025-05-10 09:08:16.658 | INFO     | financial_document_processor.utils.logging:setup_logging:69 - Sistema de logging configurado com nível INFO
2025-05-10 09:08:16.675 | INFO     | logging:callHandlers:1706 - Inicializando aplicação...
2025-05-10 09:08:16.902 | INFO     | logging:callHandlers:1706 - Conexão estabelecida com o PostgreSQL. Pool criado com 5-20 conexões.
2025-05-10 09:08:16.911 | INFO     | logging:callHandlers:1706 - Esquema do banco de dados verificado/criado com sucesso
2025-05-10 09:08:16.936 | INFO     | logging:callHandlers:1706 - Produtor Kafka iniciado
2025-05-10 09:08:16.936 | ERROR    | logging:callHandlers:1706 - Erro ao inicializar aplicação: Chave de API da OpenAI não configurada
2025-05-10 09:08:16.937 | ERROR    | logging:callHandlers:1706 - Erro fatal na aplicação: Chave de API da OpenAI não configurada
2025-05-10 09:13:43.438 | INFO     | financial_document_processor.utils.logging:setup_logging:69 - Sistema de logging configurado com nível INFO
2025-05-10 09:13:43.455 | INFO     | logging:callHandlers:1706 - Inicializando aplicação...
2025-05-10 09:13:43.667 | INFO     | logging:callHandlers:1706 - Conexão estabelecida com o PostgreSQL. Pool criado com 5-20 conexões.
2025-05-10 09:13:43.675 | INFO     | logging:callHandlers:1706 - Esquema do banco de dados verificado/criado com sucesso
2025-05-10 09:13:43.707 | INFO     | logging:callHandlers:1706 - Produtor Kafka iniciado
2025-05-10 09:13:43.707 | ERROR    | logging:callHandlers:1706 - Erro ao inicializar aplicação: Chave de API da OpenAI não configurada
2025-05-10 09:13:43.707 | ERROR    | logging:callHandlers:1706 - Erro fatal na aplicação: Chave de API da OpenAI não configurada
2025-05-10 09:21:17.407 | INFO     | financial_document_processor.utils.logging:setup_logging:69 - Sistema de logging configurado com nível INFO
2025-05-10 09:21:17.428 | INFO     | logging:callHandlers:1706 - Inicializando aplicação...
2025-05-10 09:21:17.644 | INFO     | logging:callHandlers:1706 - Conexão estabelecida com o PostgreSQL. Pool criado com 5-20 conexões.
2025-05-10 09:21:17.696 | INFO     | logging:callHandlers:1706 - Esquema do banco de dados verificado/criado com sucesso
2025-05-10 09:21:17.718 | INFO     | logging:callHandlers:1706 - Produtor Kafka iniciado
2025-05-10 09:21:17.793 | INFO     | logging:callHandlers:1706 - Usando provedor de IA: claude
2025-05-10 09:21:17.794 | INFO     | logging:callHandlers:1706 - Carregadas 61 categorias padrão
2025-05-10 09:21:17.794 | INFO     | logging:callHandlers:1706 - Serviço de categorização inicializado
2025-05-10 09:21:17.794 | INFO     | logging:callHandlers:1706 - Updating subscribed topics to: frozenset({'documents-processing'})
2025-05-10 09:21:17.976 | WARNING  | logging:callHandlers:1706 - Topic documents-processing is not available during auto-create initialization
2025-05-10 09:21:18.082 | WARNING  | logging:callHandlers:1706 - Topic documents-processing is not available during auto-create initialization
2025-05-10 09:21:18.215 | ERROR    | logging:callHandlers:1706 - Group Coordinator Request failed: [Error 15] GroupCoordinatorNotAvailableError
2025-05-10 09:21:18.326 | ERROR    | logging:callHandlers:1706 - Group Coordinator Request failed: [Error 15] GroupCoordinatorNotAvailableError
2025-05-10 09:21:18.436 | ERROR    | logging:callHandlers:1706 - Group Coordinator Request failed: [Error 15] GroupCoordinatorNotAvailableError
2025-05-10 09:21:18.545 | ERROR    | logging:callHandlers:1706 - Group Coordinator Request failed: [Error 15] GroupCoordinatorNotAvailableError
2025-05-10 09:21:18.657 | INFO     | logging:callHandlers:1706 - Discovered coordinator 1 for group financial-document-processor
2025-05-10 09:21:18.657 | INFO     | logging:callHandlers:1706 - Revoking previously assigned partitions set() for group financial-document-processor
2025-05-10 09:21:18.657 | INFO     | logging:callHandlers:1706 - (Re-)joining group financial-document-processor
2025-05-10 09:21:21.696 | INFO     | logging:callHandlers:1706 - Joined group 'financial-document-processor' (generation 1) with member_id aiokafka-0.12.0-04fa2c48-07ea-454e-87e8-a4aa5a03d72b
2025-05-10 09:21:21.697 | INFO     | logging:callHandlers:1706 - Elected group leader -- performing partition assignments using roundrobin
2025-05-10 09:21:21.734 | INFO     | logging:callHandlers:1706 - Successfully synced group financial-document-processor with generation 1
2025-05-10 09:21:21.736 | INFO     | logging:callHandlers:1706 - Setting newly assigned partitions {TopicPartition(topic='documents-processing', partition=0)} for group financial-document-processor
2025-05-10 09:21:21.737 | INFO     | logging:callHandlers:1706 - Consumidor Kafka iniciado para o tópico documents-processing
2025-05-10 09:21:21.738 | INFO     | logging:callHandlers:1706 - Aplicação inicializada com sucesso
2025-05-10 09:21:21.738 | INFO     | logging:callHandlers:1706 - Aplicação em execução
2025-05-10 09:24:36.492 | ERROR    | logging:callHandlers:1706 - Erro de validação do documento: 4 validation errors for Document
id
  Field required [type=missing, input_value={'document_id': 'd0687398...[], 'status': 'pending'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
external_id
  Field required [type=missing, input_value={'document_id': 'd0687398...[], 'status': 'pending'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
created_at
  Field required [type=missing, input_value={'document_id': 'd0687398...[], 'status': 'pending'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
updated_at
  Field required [type=missing, input_value={'document_id': 'd0687398...[], 'status': 'pending'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
2025-05-10 09:28:30.541 | ERROR    | logging:callHandlers:1706 - Erro de validação do documento: 4 validation errors for Document
id
  Field required [type=missing, input_value={'document_id': 'fd588b0d...[], 'status': 'pending'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
external_id
  Field required [type=missing, input_value={'document_id': 'fd588b0d...[], 'status': 'pending'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
created_at
  Field required [type=missing, input_value={'document_id': 'fd588b0d...[], 'status': 'pending'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
updated_at
  Field required [type=missing, input_value={'document_id': 'fd588b0d...[], 'status': 'pending'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
2025-05-10 09:28:30.587 | ERROR    | logging:callHandlers:1706 - OffsetCommit failed for group financial-document-processor due to group error ([Error 25] UnknownMemberIdError: financial-document-processor), will rejoin
2025-05-10 09:28:30.589 | INFO     | logging:callHandlers:1706 - Revoking previously assigned partitions frozenset({TopicPartition(topic='documents-processing', partition=0)}) for group financial-document-processor
2025-05-10 09:28:30.590 | ERROR    | logging:callHandlers:1706 - Erro ao processar mensagem: CommitFailedError: ('Commit cannot be completed since the group has already\n            rebalanced and assigned the partitions to another member.\n            This means that the time between subsequent calls to poll()\n            was longer than the configured max_poll_interval_ms, which\n            typically implies that the poll loop is spending too much\n            time message processing. You can address this either by\n            increasing the rebalance timeout with max_poll_interval_ms,\n            or by reducing the maximum size of batches returned in poll()\n            with max_poll_records.\n            ', 'Commit cannot be completed since the group has already rebalanced and may have assigned the partitions to another member')
2025-05-10 09:28:30.591 | INFO     | logging:callHandlers:1706 - (Re-)joining group financial-document-processor
2025-05-10 09:28:33.612 | INFO     | logging:callHandlers:1706 - Joined group 'financial-document-processor' (generation 3) with member_id aiokafka-0.12.0-9f6c1672-7902-477e-9ee3-2439580de414
2025-05-10 09:28:33.612 | INFO     | logging:callHandlers:1706 - Elected group leader -- performing partition assignments using roundrobin
2025-05-10 09:28:33.631 | INFO     | logging:callHandlers:1706 - Successfully synced group financial-document-processor with generation 3
2025-05-10 09:28:33.637 | INFO     | logging:callHandlers:1706 - Setting newly assigned partitions {TopicPartition(topic='documents-processing', partition=0)} for group financial-document-processor
2025-05-10 09:28:48.694 | ERROR    | logging:callHandlers:1706 - Erro de validação do documento: 4 validation errors for Document
id
  Field required [type=missing, input_value={'document_id': 'fd588b0d...[], 'status': 'pending'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
external_id
  Field required [type=missing, input_value={'document_id': 'fd588b0d...[], 'status': 'pending'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
created_at
  Field required [type=missing, input_value={'document_id': 'fd588b0d...[], 'status': 'pending'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
updated_at
  Field required [type=missing, input_value={'document_id': 'fd588b0d...[], 'status': 'pending'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
2025-05-10 09:28:48.705 | ERROR    | logging:callHandlers:1706 - OffsetCommit failed for group financial-document-processor due to group error ([Error 25] UnknownMemberIdError: financial-document-processor), will rejoin
2025-05-10 09:28:48.706 | INFO     | logging:callHandlers:1706 - Revoking previously assigned partitions frozenset({TopicPartition(topic='documents-processing', partition=0)}) for group financial-document-processor
2025-05-10 09:28:48.709 | ERROR    | logging:callHandlers:1706 - Erro ao processar mensagem: CommitFailedError: ('Commit cannot be completed since the group has already\n            rebalanced and assigned the partitions to another member.\n            This means that the time between subsequent calls to poll()\n            was longer than the configured max_poll_interval_ms, which\n            typically implies that the poll loop is spending too much\n            time message processing. You can address this either by\n            increasing the rebalance timeout with max_poll_interval_ms,\n            or by reducing the maximum size of batches returned in poll()\n            with max_poll_records.\n            ', 'Commit cannot be completed since the group has already rebalanced and may have assigned the partitions to another member')
2025-05-10 09:28:48.710 | INFO     | logging:callHandlers:1706 - (Re-)joining group financial-document-processor
2025-05-10 09:28:50.187 | INFO     | logging:callHandlers:1706 - Sinal 2 recebido, iniciando desligamento...
2025-05-10 09:28:50.313 | INFO     | logging:callHandlers:1706 - Iniciando desligamento da aplicação...
2025-05-10 09:28:50.315 | INFO     | logging:callHandlers:1706 - Tarefa de consumo cancelada
2025-05-10 09:28:51.722 | INFO     | logging:callHandlers:1706 - Joined group 'financial-document-processor' (generation 5) with member_id aiokafka-0.12.0-cdedc95f-85f4-411f-b253-ef8249d8d320
2025-05-10 09:28:51.723 | INFO     | logging:callHandlers:1706 - Elected group leader -- performing partition assignments using roundrobin
2025-05-10 09:28:51.733 | INFO     | logging:callHandlers:1706 - Successfully synced group financial-document-processor with generation 5
2025-05-10 09:28:51.736 | INFO     | logging:callHandlers:1706 - Setting newly assigned partitions {TopicPartition(topic='documents-processing', partition=0)} for group financial-document-processor
2025-05-10 09:28:51.768 | INFO     | logging:callHandlers:1706 - LeaveGroup request succeeded
2025-05-10 09:28:51.773 | INFO     | logging:callHandlers:1706 - Consumidor Kafka parado
2025-05-10 09:28:51.774 | INFO     | logging:callHandlers:1706 - Produtor Kafka parado
2025-05-10 09:28:51.777 | INFO     | logging:callHandlers:1706 - Conexão com PostgreSQL encerrada
2025-05-10 09:28:51.777 | INFO     | logging:callHandlers:1706 - Aplicação desligada com sucesso
2025-05-10 09:28:54.593 | INFO     | financial_document_processor.utils.logging:setup_logging:69 - Sistema de logging configurado com nível INFO
2025-05-10 09:28:54.613 | INFO     | logging:callHandlers:1706 - Inicializando aplicação...
2025-05-10 09:28:54.797 | INFO     | logging:callHandlers:1706 - Conexão estabelecida com o PostgreSQL. Pool criado com 5-20 conexões.
2025-05-10 09:28:54.810 | INFO     | logging:callHandlers:1706 - Esquema do banco de dados verificado/criado com sucesso
2025-05-10 09:28:54.861 | INFO     | logging:callHandlers:1706 - Produtor Kafka iniciado
2025-05-10 09:28:54.899 | INFO     | logging:callHandlers:1706 - Usando provedor de IA: claude
2025-05-10 09:28:54.900 | INFO     | logging:callHandlers:1706 - Carregadas 61 categorias padrão
2025-05-10 09:28:54.901 | INFO     | logging:callHandlers:1706 - Serviço de categorização inicializado
2025-05-10 09:28:54.901 | INFO     | logging:callHandlers:1706 - Updating subscribed topics to: frozenset({'documents-processing'})
2025-05-10 09:28:54.939 | INFO     | logging:callHandlers:1706 - Discovered coordinator 1 for group financial-document-processor
2025-05-10 09:28:54.940 | INFO     | logging:callHandlers:1706 - Revoking previously assigned partitions set() for group financial-document-processor
2025-05-10 09:28:54.940 | INFO     | logging:callHandlers:1706 - (Re-)joining group financial-document-processor
2025-05-10 09:28:57.966 | INFO     | logging:callHandlers:1706 - Joined group 'financial-document-processor' (generation 7) with member_id aiokafka-0.12.0-1f8c72f3-b0ae-480f-953a-3cc3cb499380
2025-05-10 09:28:57.967 | INFO     | logging:callHandlers:1706 - Elected group leader -- performing partition assignments using roundrobin
2025-05-10 09:28:57.976 | INFO     | logging:callHandlers:1706 - Successfully synced group financial-document-processor with generation 7
2025-05-10 09:28:57.977 | INFO     | logging:callHandlers:1706 - Setting newly assigned partitions {TopicPartition(topic='documents-processing', partition=0)} for group financial-document-processor
2025-05-10 09:28:57.977 | INFO     | logging:callHandlers:1706 - Consumidor Kafka iniciado para o tópico documents-processing
2025-05-10 09:28:57.977 | INFO     | logging:callHandlers:1706 - Aplicação inicializada com sucesso
2025-05-10 09:28:57.977 | INFO     | logging:callHandlers:1706 - Aplicação em execução
2025-05-10 09:29:09.929 | ERROR    | logging:callHandlers:1706 - Erro de validação do documento: 1 validation error for Document
id
  Field required [type=missing, input_value={'document_id': 'fd588b0d...[], 'status': 'pending'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
2025-05-10 09:29:09.946 | ERROR    | logging:callHandlers:1706 - OffsetCommit failed for group financial-document-processor due to group error ([Error 25] UnknownMemberIdError: financial-document-processor), will rejoin
2025-05-10 09:29:09.947 | INFO     | logging:callHandlers:1706 - Revoking previously assigned partitions frozenset({TopicPartition(topic='documents-processing', partition=0)}) for group financial-document-processor
2025-05-10 09:29:09.948 | ERROR    | logging:callHandlers:1706 - Erro ao processar mensagem: CommitFailedError: ('Commit cannot be completed since the group has already\n            rebalanced and assigned the partitions to another member.\n            This means that the time between subsequent calls to poll()\n            was longer than the configured max_poll_interval_ms, which\n            typically implies that the poll loop is spending too much\n            time message processing. You can address this either by\n            increasing the rebalance timeout with max_poll_interval_ms,\n            or by reducing the maximum size of batches returned in poll()\n            with max_poll_records.\n            ', 'Commit cannot be completed since the group has already rebalanced and may have assigned the partitions to another member')
2025-05-10 09:29:09.949 | INFO     | logging:callHandlers:1706 - (Re-)joining group financial-document-processor
2025-05-10 09:29:12.966 | INFO     | logging:callHandlers:1706 - Joined group 'financial-document-processor' (generation 9) with member_id aiokafka-0.12.0-7e056e32-6732-45d7-9fcb-aa1d1ce622f3
2025-05-10 09:29:12.967 | INFO     | logging:callHandlers:1706 - Elected group leader -- performing partition assignments using roundrobin
2025-05-10 09:29:12.976 | INFO     | logging:callHandlers:1706 - Successfully synced group financial-document-processor with generation 9
2025-05-10 09:29:12.981 | INFO     | logging:callHandlers:1706 - Setting newly assigned partitions {TopicPartition(topic='documents-processing', partition=0)} for group financial-document-processor
2025-05-10 09:29:58.264 | INFO     | logging:callHandlers:1706 - Sinal 2 recebido, iniciando desligamento...
2025-05-10 09:30:01.001 | INFO     | financial_document_processor.utils.logging:setup_logging:69 - Sistema de logging configurado com nível INFO
2025-05-10 09:30:01.006 | INFO     | logging:callHandlers:1706 - Inicializando aplicação...
2025-05-10 09:30:01.175 | INFO     | logging:callHandlers:1706 - Conexão estabelecida com o PostgreSQL. Pool criado com 5-20 conexões.
2025-05-10 09:30:01.178 | INFO     | logging:callHandlers:1706 - Esquema do banco de dados verificado/criado com sucesso
2025-05-10 09:30:01.207 | INFO     | logging:callHandlers:1706 - Produtor Kafka iniciado
2025-05-10 09:30:01.244 | INFO     | logging:callHandlers:1706 - Usando provedor de IA: claude
2025-05-10 09:30:01.245 | INFO     | logging:callHandlers:1706 - Carregadas 61 categorias padrão
2025-05-10 09:30:01.245 | INFO     | logging:callHandlers:1706 - Serviço de categorização inicializado
2025-05-10 09:30:01.246 | INFO     | logging:callHandlers:1706 - Updating subscribed topics to: frozenset({'documents-processing'})
2025-05-10 09:30:01.276 | INFO     | logging:callHandlers:1706 - Discovered coordinator 1 for group financial-document-processor
2025-05-10 09:30:01.277 | INFO     | logging:callHandlers:1706 - Revoking previously assigned partitions set() for group financial-document-processor
2025-05-10 09:30:01.277 | INFO     | logging:callHandlers:1706 - (Re-)joining group financial-document-processor
2025-05-10 09:30:04.299 | INFO     | logging:callHandlers:1706 - Joined group 'financial-document-processor' (generation 11) with member_id aiokafka-0.12.0-32818510-f4e9-47f2-ae9c-076884b9827d
2025-05-10 09:30:04.300 | INFO     | logging:callHandlers:1706 - Elected group leader -- performing partition assignments using roundrobin
2025-05-10 09:30:04.311 | INFO     | logging:callHandlers:1706 - Successfully synced group financial-document-processor with generation 11
2025-05-10 09:30:04.314 | INFO     | logging:callHandlers:1706 - Setting newly assigned partitions {TopicPartition(topic='documents-processing', partition=0)} for group financial-document-processor
2025-05-10 09:30:04.315 | INFO     | logging:callHandlers:1706 - Consumidor Kafka iniciado para o tópico documents-processing
2025-05-10 09:30:04.315 | INFO     | logging:callHandlers:1706 - Aplicação inicializada com sucesso
2025-05-10 09:30:04.316 | INFO     | logging:callHandlers:1706 - Aplicação em execução
2025-05-10 09:30:10.459 | ERROR    | logging:callHandlers:1706 - Erro ao processar mensagem: 'Document' object has no attribute 'id'
2025-05-10 09:35:03.906 | ERROR    | logging:callHandlers:1706 - Erro ao processar mensagem: 'Document' object has no attribute 'id'
2025-05-10 09:36:07.684 | ERROR    | logging:callHandlers:1706 - Erro ao processar mensagem: 'Document' object has no attribute 'id'
2025-05-10 09:36:07.699 | ERROR    | logging:callHandlers:1706 - OffsetCommit failed for group financial-document-processor due to group error ([Error 25] UnknownMemberIdError: financial-document-processor), will rejoin
2025-05-10 09:36:07.700 | WARNING  | logging:callHandlers:1706 - Heartbeat failed: local member_id was not recognized; resetting and re-joining group
2025-05-10 09:36:07.700 | ERROR    | logging:callHandlers:1706 - Heartbeat session expired - marking coordinator dead
2025-05-10 09:36:07.700 | WARNING  | logging:callHandlers:1706 - Marking the coordinator dead (node 1)for group financial-document-processor.
2025-05-10 09:36:07.702 | ERROR    | logging:callHandlers:1706 - Erro ao processar mensagem: CommitFailedError: ('Commit cannot be completed since the group has already\n            rebalanced and assigned the partitions to another member.\n            This means that the time between subsequent calls to poll()\n            was longer than the configured max_poll_interval_ms, which\n            typically implies that the poll loop is spending too much\n            time message processing. You can address this either by\n            increasing the rebalance timeout with max_poll_interval_ms,\n            or by reducing the maximum size of batches returned in poll()\n            with max_poll_records.\n            ', 'Commit cannot be completed since the group has already rebalanced and may have assigned the partitions to another member')
2025-05-10 09:36:07.705 | INFO     | logging:callHandlers:1706 - Discovered coordinator 1 for group financial-document-processor
2025-05-10 09:36:07.706 | INFO     | logging:callHandlers:1706 - Revoking previously assigned partitions frozenset({TopicPartition(topic='documents-processing', partition=0)}) for group financial-document-processor
2025-05-10 09:36:07.706 | INFO     | logging:callHandlers:1706 - (Re-)joining group financial-document-processor
2025-05-10 09:36:10.719 | INFO     | logging:callHandlers:1706 - Joined group 'financial-document-processor' (generation 13) with member_id aiokafka-0.12.0-ee19eec7-f1b1-44c5-b66a-0d17ef0c2535
2025-05-10 09:36:10.720 | INFO     | logging:callHandlers:1706 - Elected group leader -- performing partition assignments using roundrobin
2025-05-10 09:36:10.729 | INFO     | logging:callHandlers:1706 - Successfully synced group financial-document-processor with generation 13
2025-05-10 09:36:10.732 | INFO     | logging:callHandlers:1706 - Setting newly assigned partitions {TopicPartition(topic='documents-processing', partition=0)} for group financial-document-processor
2025-05-10 09:36:34.220 | ERROR    | logging:callHandlers:1706 - Erro ao processar mensagem: 'Document' object has no attribute 'id'
2025-05-10 09:36:34.236 | ERROR    | logging:callHandlers:1706 - OffsetCommit failed for group financial-document-processor due to group error ([Error 25] UnknownMemberIdError: financial-document-processor), will rejoin
2025-05-10 09:36:34.236 | INFO     | logging:callHandlers:1706 - Revoking previously assigned partitions frozenset({TopicPartition(topic='documents-processing', partition=0)}) for group financial-document-processor
2025-05-10 09:36:34.237 | ERROR    | logging:callHandlers:1706 - Erro ao processar mensagem: CommitFailedError: ('Commit cannot be completed since the group has already\n            rebalanced and assigned the partitions to another member.\n            This means that the time between subsequent calls to poll()\n            was longer than the configured max_poll_interval_ms, which\n            typically implies that the poll loop is spending too much\n            time message processing. You can address this either by\n            increasing the rebalance timeout with max_poll_interval_ms,\n            or by reducing the maximum size of batches returned in poll()\n            with max_poll_records.\n            ', 'Commit cannot be completed since the group has already rebalanced and may have assigned the partitions to another member')
2025-05-10 09:36:34.238 | INFO     | logging:callHandlers:1706 - (Re-)joining group financial-document-processor
2025-05-10 09:36:37.254 | INFO     | logging:callHandlers:1706 - Joined group 'financial-document-processor' (generation 15) with member_id aiokafka-0.12.0-036e881e-e477-4c1c-8cf8-b81bf14b8e1a
2025-05-10 09:36:37.255 | INFO     | logging:callHandlers:1706 - Elected group leader -- performing partition assignments using roundrobin
2025-05-10 09:36:37.265 | INFO     | logging:callHandlers:1706 - Successfully synced group financial-document-processor with generation 15
2025-05-10 09:36:37.269 | INFO     | logging:callHandlers:1706 - Setting newly assigned partitions {TopicPartition(topic='documents-processing', partition=0)} for group financial-document-processor
2025-05-10 09:37:33.331 | INFO     | logging:callHandlers:1706 - Sinal 2 recebido, iniciando desligamento...
2025-05-10 09:39:58.602 | INFO     | financial_document_processor.utils.logging:setup_logging:69 - Sistema de logging configurado com nível INFO
2025-05-10 09:39:58.618 | INFO     | logging:callHandlers:1706 - Inicializando aplicação...
2025-05-10 09:39:58.804 | INFO     | logging:callHandlers:1706 - Conexão estabelecida com o PostgreSQL. Pool criado com 5-20 conexões.
2025-05-10 09:39:58.822 | INFO     | logging:callHandlers:1706 - Esquema do banco de dados verificado/criado com sucesso
2025-05-10 09:39:58.850 | INFO     | logging:callHandlers:1706 - Produtor Kafka iniciado
2025-05-10 09:39:58.988 | INFO     | logging:callHandlers:1706 - Usando provedor de IA: claude
2025-05-10 09:39:58.991 | INFO     | logging:callHandlers:1706 - Carregadas 61 categorias padrão
2025-05-10 09:39:58.992 | INFO     | logging:callHandlers:1706 - Serviço de categorização inicializado
2025-05-10 09:39:58.992 | INFO     | logging:callHandlers:1706 - Updating subscribed topics to: frozenset({'documents-processing'})
2025-05-10 09:39:59.042 | INFO     | logging:callHandlers:1706 - Discovered coordinator 1 for group financial-document-processor
2025-05-10 09:39:59.042 | INFO     | logging:callHandlers:1706 - Revoking previously assigned partitions set() for group financial-document-processor
2025-05-10 09:39:59.043 | INFO     | logging:callHandlers:1706 - (Re-)joining group financial-document-processor
2025-05-10 09:40:02.104 | INFO     | logging:callHandlers:1706 - Joined group 'financial-document-processor' (generation 17) with member_id aiokafka-0.12.0-bcd0c2fa-819f-4d9a-bcd8-4133884ea9ad
2025-05-10 09:40:02.105 | INFO     | logging:callHandlers:1706 - Elected group leader -- performing partition assignments using roundrobin
2025-05-10 09:40:02.124 | INFO     | logging:callHandlers:1706 - Successfully synced group financial-document-processor with generation 17
2025-05-10 09:40:02.127 | INFO     | logging:callHandlers:1706 - Setting newly assigned partitions {TopicPartition(topic='documents-processing', partition=0)} for group financial-document-processor
2025-05-10 09:40:02.127 | INFO     | logging:callHandlers:1706 - Consumidor Kafka iniciado para o tópico documents-processing
2025-05-10 09:40:02.128 | INFO     | logging:callHandlers:1706 - Aplicação inicializada com sucesso
2025-05-10 09:40:02.128 | INFO     | logging:callHandlers:1706 - Aplicação em execução
2025-05-10 09:40:07.478 | ERROR    | logging:callHandlers:1706 - Erro de validação do documento: 4 validation errors for Document
id
  Field required [type=missing, input_value={'document_id': '0d47fd6a...[], 'status': 'pending'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
external_id
  Field required [type=missing, input_value={'document_id': '0d47fd6a...[], 'status': 'pending'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
created_at
  Field required [type=missing, input_value={'document_id': '0d47fd6a...[], 'status': 'pending'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
updated_at
  Field required [type=missing, input_value={'document_id': '0d47fd6a...[], 'status': 'pending'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
2025-05-10 09:41:04.215 | INFO     | logging:callHandlers:1706 - Sinal 2 recebido, iniciando desligamento...
2025-05-10 09:41:04.362 | INFO     | logging:callHandlers:1706 - Iniciando desligamento da aplicação...
2025-05-10 09:41:04.364 | INFO     | logging:callHandlers:1706 - Tarefa de consumo cancelada
2025-05-10 09:41:04.389 | INFO     | logging:callHandlers:1706 - LeaveGroup request succeeded
2025-05-10 09:41:04.393 | INFO     | logging:callHandlers:1706 - Consumidor Kafka parado
2025-05-10 09:41:04.395 | INFO     | logging:callHandlers:1706 - Produtor Kafka parado
2025-05-10 09:41:04.406 | INFO     | logging:callHandlers:1706 - Conexão com PostgreSQL encerrada
2025-05-10 09:41:04.406 | INFO     | logging:callHandlers:1706 - Aplicação desligada com sucesso
2025-05-10 09:41:07.067 | INFO     | financial_document_processor.utils.logging:setup_logging:69 - Sistema de logging configurado com nível INFO
2025-05-10 09:41:07.076 | INFO     | logging:callHandlers:1706 - Inicializando aplicação...
2025-05-10 09:41:07.248 | INFO     | logging:callHandlers:1706 - Conexão estabelecida com o PostgreSQL. Pool criado com 5-20 conexões.
2025-05-10 09:41:07.252 | INFO     | logging:callHandlers:1706 - Esquema do banco de dados verificado/criado com sucesso
2025-05-10 09:41:07.287 | INFO     | logging:callHandlers:1706 - Produtor Kafka iniciado
2025-05-10 09:41:07.450 | INFO     | logging:callHandlers:1706 - Usando provedor de IA: claude
2025-05-10 09:41:07.452 | INFO     | logging:callHandlers:1706 - Carregadas 61 categorias padrão
2025-05-10 09:41:07.452 | INFO     | logging:callHandlers:1706 - Serviço de categorização inicializado
2025-05-10 09:41:07.455 | INFO     | logging:callHandlers:1706 - Updating subscribed topics to: frozenset({'documents-processing'})
2025-05-10 09:41:07.508 | INFO     | logging:callHandlers:1706 - Discovered coordinator 1 for group financial-document-processor
2025-05-10 09:41:07.508 | INFO     | logging:callHandlers:1706 - Revoking previously assigned partitions set() for group financial-document-processor
2025-05-10 09:41:07.508 | INFO     | logging:callHandlers:1706 - (Re-)joining group financial-document-processor
2025-05-10 09:41:10.541 | INFO     | logging:callHandlers:1706 - Joined group 'financial-document-processor' (generation 19) with member_id aiokafka-0.12.0-0ee31978-ee62-4683-833a-eb89ef085dfc
2025-05-10 09:41:10.542 | INFO     | logging:callHandlers:1706 - Elected group leader -- performing partition assignments using roundrobin
2025-05-10 09:41:10.553 | INFO     | logging:callHandlers:1706 - Successfully synced group financial-document-processor with generation 19
2025-05-10 09:41:10.556 | INFO     | logging:callHandlers:1706 - Setting newly assigned partitions {TopicPartition(topic='documents-processing', partition=0)} for group financial-document-processor
2025-05-10 09:41:10.556 | INFO     | logging:callHandlers:1706 - Consumidor Kafka iniciado para o tópico documents-processing
2025-05-10 09:41:10.557 | INFO     | logging:callHandlers:1706 - Aplicação inicializada com sucesso
2025-05-10 09:41:10.557 | INFO     | logging:callHandlers:1706 - Aplicação em execução
2025-05-10 09:41:32.899 | INFO     | logging:callHandlers:1706 - Processando documento 7 do tipo bank_statement
2025-05-10 09:41:32.907 | WARNING  | logging:callHandlers:1706 - Heartbeat failed: local member_id was not recognized; resetting and re-joining group
2025-05-10 09:41:32.907 | ERROR    | logging:callHandlers:1706 - Heartbeat session expired - marking coordinator dead
2025-05-10 09:41:32.907 | WARNING  | logging:callHandlers:1706 - Marking the coordinator dead (node 1)for group financial-document-processor.
2025-05-10 09:41:32.911 | INFO     | logging:callHandlers:1706 - Discovered coordinator 1 for group financial-document-processor
2025-05-10 09:41:32.912 | INFO     | logging:callHandlers:1706 - Revoking previously assigned partitions frozenset({TopicPartition(topic='documents-processing', partition=0)}) for group financial-document-processor
2025-05-10 09:41:32.912 | INFO     | logging:callHandlers:1706 - (Re-)joining group financial-document-processor
2025-05-10 09:41:32.970 | WARNING  | logging:callHandlers:1706 - Documento 7 não encontrado para atualização de status
2025-05-10 09:41:32.971 | INFO     | logging:callHandlers:1706 - Iniciando processamento do documento 7 do tipo bank_statement para o usuário 2
2025-05-10 09:41:33.162 | ERROR    | logging:callHandlers:1706 - Erro ao processar documento 7: Invalid format specifier ' "2023-01-15",
      "description": "TRANSFERÊNCIA RECEBIDA - JOÃO SILVA",
      "amount": "1500.00",
      "type": "CREDIT",
      "method": "TED",
      "categories": ["salário"],
      "confidence_score": 0.95
    ' for object of type 'str'
2025-05-10 09:41:33.162 | ERROR    | logging:callHandlers:1706 - Erro ao processar documento 7: Invalid format specifier ' "2023-01-15",
      "description": "TRANSFERÊNCIA RECEBIDA - JOÃO SILVA",
      "amount": "1500.00",
      "type": "CREDIT",
      "method": "TED",
      "categories": ["salário"],
      "confidence_score": 0.95
    ' for object of type 'str'
2025-05-10 09:41:33.164 | WARNING  | logging:callHandlers:1706 - Documento 7 não encontrado para atualização de status
2025-05-10 09:41:33.232 | WARNING  | logging:callHandlers:1706 - Topic processed-documents is not available during auto-create initialization
2025-05-10 09:41:33.352 | INFO     | logging:callHandlers:1706 - Mensagem processada em 15.48s: documento_id=7, tipo=bank_statement
2025-05-10 09:41:35.923 | INFO     | logging:callHandlers:1706 - Joined group 'financial-document-processor' (generation 21) with member_id aiokafka-0.12.0-0ceb7010-197a-4a21-a7f8-f3b246cf6b90
2025-05-10 09:41:35.923 | INFO     | logging:callHandlers:1706 - Elected group leader -- performing partition assignments using roundrobin
2025-05-10 09:41:35.925 | ERROR    | logging:callHandlers:1706 - OffsetCommit failed for group financial-document-processor due to group error ([Error 22] IllegalGenerationError: financial-document-processor), will rejoin
2025-05-10 09:41:35.926 | ERROR    | logging:callHandlers:1706 - Erro ao processar mensagem: CommitFailedError: ('Commit cannot be completed since the group has already\n            rebalanced and assigned the partitions to another member.\n            This means that the time between subsequent calls to poll()\n            was longer than the configured max_poll_interval_ms, which\n            typically implies that the poll loop is spending too much\n            time message processing. You can address this either by\n            increasing the rebalance timeout with max_poll_interval_ms,\n            or by reducing the maximum size of batches returned in poll()\n            with max_poll_records.\n            ', 'Commit cannot be completed since the group has already rebalanced and may have assigned the partitions to another member')
2025-05-10 09:41:35.927 | INFO     | logging:callHandlers:1706 - Successfully synced group financial-document-processor with generation -1
2025-05-10 09:41:35.929 | INFO     | logging:callHandlers:1706 - Setting newly assigned partitions {TopicPartition(topic='documents-processing', partition=0)} for group financial-document-processor
2025-05-10 09:41:35.930 | INFO     | logging:callHandlers:1706 - Revoking previously assigned partitions frozenset({TopicPartition(topic='documents-processing', partition=0)}) for group financial-document-processor
2025-05-10 09:41:35.930 | INFO     | logging:callHandlers:1706 - (Re-)joining group financial-document-processor
2025-05-10 09:41:35.937 | INFO     | logging:callHandlers:1706 - Joined group 'financial-document-processor' (generation 22) with member_id aiokafka-0.12.0-0ceb7010-197a-4a21-a7f8-f3b246cf6b90
2025-05-10 09:41:35.937 | INFO     | logging:callHandlers:1706 - Elected group leader -- performing partition assignments using roundrobin
2025-05-10 09:41:35.940 | INFO     | logging:callHandlers:1706 - Successfully synced group financial-document-processor with generation 22
2025-05-10 09:41:35.941 | INFO     | logging:callHandlers:1706 - Setting newly assigned partitions {TopicPartition(topic='documents-processing', partition=0)} for group financial-document-processor
2025-05-10 09:41:35.945 | INFO     | logging:callHandlers:1706 - Processando documento 7 do tipo bank_statement
2025-05-10 09:41:35.946 | WARNING  | logging:callHandlers:1706 - Documento 7 não encontrado para atualização de status
2025-05-10 09:41:35.947 | INFO     | logging:callHandlers:1706 - Iniciando processamento do documento 7 do tipo bank_statement para o usuário 2
2025-05-10 09:41:36.076 | ERROR    | logging:callHandlers:1706 - Erro ao processar documento 7: Invalid format specifier ' "2023-01-15",
      "description": "TRANSFERÊNCIA RECEBIDA - JOÃO SILVA",
      "amount": "1500.00",
      "type": "CREDIT",
      "method": "TED",
      "categories": ["salário"],
      "confidence_score": 0.95
    ' for object of type 'str'
2025-05-10 09:41:36.076 | ERROR    | logging:callHandlers:1706 - Erro ao processar documento 7: Invalid format specifier ' "2023-01-15",
      "description": "TRANSFERÊNCIA RECEBIDA - JOÃO SILVA",
      "amount": "1500.00",
      "type": "CREDIT",
      "method": "TED",
      "categories": ["salário"],
      "confidence_score": 0.95
    ' for object of type 'str'
2025-05-10 09:41:36.077 | WARNING  | logging:callHandlers:1706 - Documento 7 não encontrado para atualização de status
2025-05-10 09:41:36.082 | INFO     | logging:callHandlers:1706 - Mensagem processada em 0.14s: documento_id=7, tipo=bank_statement
2025-05-10 09:44:00.867 | INFO     | logging:callHandlers:1706 - Processando documento 8 do tipo bank_statement
2025-05-10 09:44:00.886 | WARNING  | logging:callHandlers:1706 - Documento 8 não encontrado para atualização de status
2025-05-10 09:44:00.896 | INFO     | logging:callHandlers:1706 - Iniciando processamento do documento 8 do tipo bank_statement para o usuário 2
2025-05-10 09:45:49.337 | ERROR    | logging:callHandlers:1706 - Erro ao processar documento 8: Invalid format specifier ' "2023-01-15",
      "description": "TRANSFERÊNCIA RECEBIDA - JOÃO SILVA",
      "amount": "1500.00",
      "type": "CREDIT",
      "method": "TED",
      "categories": ["salário"],
      "confidence_score": 0.95
    ' for object of type 'str'
2025-05-10 09:45:49.340 | ERROR    | logging:callHandlers:1706 - Erro ao processar documento 8: Invalid format specifier ' "2023-01-15",
      "description": "TRANSFERÊNCIA RECEBIDA - JOÃO SILVA",
      "amount": "1500.00",
      "type": "CREDIT",
      "method": "TED",
      "categories": ["salário"],
      "confidence_score": 0.95
    ' for object of type 'str'
2025-05-10 09:45:49.345 | WARNING  | logging:callHandlers:1706 - Documento 8 não encontrado para atualização de status
2025-05-10 09:45:49.362 | WARNING  | logging:callHandlers:1706 - Heartbeat failed: local member_id was not recognized; resetting and re-joining group
2025-05-10 09:45:49.362 | ERROR    | logging:callHandlers:1706 - Heartbeat session expired - marking coordinator dead
2025-05-10 09:45:49.363 | WARNING  | logging:callHandlers:1706 - Marking the coordinator dead (node 1)for group financial-document-processor.
2025-05-10 09:45:49.370 | INFO     | logging:callHandlers:1706 - Discovered coordinator 1 for group financial-document-processor
2025-05-10 09:45:49.370 | INFO     | logging:callHandlers:1706 - Revoking previously assigned partitions frozenset({TopicPartition(topic='documents-processing', partition=0)}) for group financial-document-processor
2025-05-10 09:45:49.371 | INFO     | logging:callHandlers:1706 - (Re-)joining group financial-document-processor
2025-05-10 09:45:49.384 | INFO     | logging:callHandlers:1706 - Mensagem processada em 112.21s: documento_id=8, tipo=bank_statement
2025-05-10 09:45:52.390 | INFO     | logging:callHandlers:1706 - Joined group 'financial-document-processor' (generation 24) with member_id aiokafka-0.12.0-75dd7438-102d-4726-bb3c-a6ee96607088
2025-05-10 09:45:52.391 | INFO     | logging:callHandlers:1706 - Elected group leader -- performing partition assignments using roundrobin
2025-05-10 09:45:52.396 | ERROR    | logging:callHandlers:1706 - OffsetCommit failed for group financial-document-processor due to group error ([Error 22] IllegalGenerationError: financial-document-processor), will rejoin
2025-05-10 09:45:52.399 | ERROR    | logging:callHandlers:1706 - Erro ao processar mensagem: CommitFailedError: ('Commit cannot be completed since the group has already\n            rebalanced and assigned the partitions to another member.\n            This means that the time between subsequent calls to poll()\n            was longer than the configured max_poll_interval_ms, which\n            typically implies that the poll loop is spending too much\n            time message processing. You can address this either by\n            increasing the rebalance timeout with max_poll_interval_ms,\n            or by reducing the maximum size of batches returned in poll()\n            with max_poll_records.\n            ', 'Commit cannot be completed since the group has already rebalanced and may have assigned the partitions to another member')
2025-05-10 09:45:52.400 | INFO     | logging:callHandlers:1706 - Successfully synced group financial-document-processor with generation -1
2025-05-10 09:45:52.402 | INFO     | logging:callHandlers:1706 - Setting newly assigned partitions {TopicPartition(topic='documents-processing', partition=0)} for group financial-document-processor
2025-05-10 09:45:52.402 | INFO     | logging:callHandlers:1706 - Revoking previously assigned partitions frozenset({TopicPartition(topic='documents-processing', partition=0)}) for group financial-document-processor
2025-05-10 09:45:52.403 | INFO     | logging:callHandlers:1706 - (Re-)joining group financial-document-processor
2025-05-10 09:45:52.405 | INFO     | logging:callHandlers:1706 - Joined group 'financial-document-processor' (generation 25) with member_id aiokafka-0.12.0-75dd7438-102d-4726-bb3c-a6ee96607088
2025-05-10 09:45:52.405 | INFO     | logging:callHandlers:1706 - Elected group leader -- performing partition assignments using roundrobin
2025-05-10 09:45:52.408 | INFO     | logging:callHandlers:1706 - Successfully synced group financial-document-processor with generation 25
2025-05-10 09:45:52.409 | INFO     | logging:callHandlers:1706 - Setting newly assigned partitions {TopicPartition(topic='documents-processing', partition=0)} for group financial-document-processor
2025-05-10 09:45:52.413 | INFO     | logging:callHandlers:1706 - Processando documento 8 do tipo bank_statement
2025-05-10 09:45:52.414 | WARNING  | logging:callHandlers:1706 - Documento 8 não encontrado para atualização de status
2025-05-10 09:45:52.415 | INFO     | logging:callHandlers:1706 - Iniciando processamento do documento 8 do tipo bank_statement para o usuário 2
2025-05-10 09:49:22.678 | ERROR    | logging:callHandlers:1706 - Erro ao processar documento 8: Invalid format specifier ' "2023-01-15",
      "description": "TRANSFERÊNCIA RECEBIDA - JOÃO SILVA",
      "amount": "1500.00",
      "type": "CREDIT",
      "method": "TED",
      "categories": ["salário"],
      "confidence_score": 0.95
    ' for object of type 'str'
2025-05-10 09:49:22.681 | ERROR    | logging:callHandlers:1706 - Erro ao processar documento 8: Invalid format specifier ' "2023-01-15",
      "description": "TRANSFERÊNCIA RECEBIDA - JOÃO SILVA",
      "amount": "1500.00",
      "type": "CREDIT",
      "method": "TED",
      "categories": ["salário"],
      "confidence_score": 0.95
    ' for object of type 'str'
2025-05-10 09:49:22.700 | WARNING  | logging:callHandlers:1706 - Documento 8 não encontrado para atualização de status
2025-05-10 09:49:22.703 | WARNING  | logging:callHandlers:1706 - Heartbeat failed: local member_id was not recognized; resetting and re-joining group
2025-05-10 09:49:22.703 | ERROR    | logging:callHandlers:1706 - Heartbeat session expired - marking coordinator dead
2025-05-10 09:49:22.703 | WARNING  | logging:callHandlers:1706 - Marking the coordinator dead (node 1)for group financial-document-processor.
2025-05-10 09:49:22.713 | INFO     | logging:callHandlers:1706 - Discovered coordinator 1 for group financial-document-processor
2025-05-10 09:49:22.713 | INFO     | logging:callHandlers:1706 - Revoking previously assigned partitions frozenset({TopicPartition(topic='documents-processing', partition=0)}) for group financial-document-processor
2025-05-10 09:49:22.713 | INFO     | logging:callHandlers:1706 - (Re-)joining group financial-document-processor
2025-05-10 09:49:22.723 | INFO     | logging:callHandlers:1706 - Mensagem processada em 210.31s: documento_id=8, tipo=bank_statement
2025-05-10 09:49:25.735 | INFO     | logging:callHandlers:1706 - Joined group 'financial-document-processor' (generation 27) with member_id aiokafka-0.12.0-b2b810ee-b4ea-423c-a754-e26d64663403
2025-05-10 09:49:25.736 | INFO     | logging:callHandlers:1706 - Elected group leader -- performing partition assignments using roundrobin
2025-05-10 09:49:25.736 | ERROR    | logging:callHandlers:1706 - OffsetCommit failed for group financial-document-processor due to group error ([Error 22] IllegalGenerationError: financial-document-processor), will rejoin
2025-05-10 09:49:25.737 | ERROR    | logging:callHandlers:1706 - Erro ao processar mensagem: CommitFailedError: ('Commit cannot be completed since the group has already\n            rebalanced and assigned the partitions to another member.\n            This means that the time between subsequent calls to poll()\n            was longer than the configured max_poll_interval_ms, which\n            typically implies that the poll loop is spending too much\n            time message processing. You can address this either by\n            increasing the rebalance timeout with max_poll_interval_ms,\n            or by reducing the maximum size of batches returned in poll()\n            with max_poll_records.\n            ', 'Commit cannot be completed since the group has already rebalanced and may have assigned the partitions to another member')
2025-05-10 09:49:25.739 | INFO     | logging:callHandlers:1706 - Successfully synced group financial-document-processor with generation -1
2025-05-10 09:49:25.740 | INFO     | logging:callHandlers:1706 - Setting newly assigned partitions {TopicPartition(topic='documents-processing', partition=0)} for group financial-document-processor
2025-05-10 09:49:25.741 | INFO     | logging:callHandlers:1706 - Revoking previously assigned partitions frozenset({TopicPartition(topic='documents-processing', partition=0)}) for group financial-document-processor
2025-05-10 09:49:25.741 | INFO     | logging:callHandlers:1706 - (Re-)joining group financial-document-processor
2025-05-10 09:49:25.744 | INFO     | logging:callHandlers:1706 - Joined group 'financial-document-processor' (generation 28) with member_id aiokafka-0.12.0-b2b810ee-b4ea-423c-a754-e26d64663403
2025-05-10 09:49:25.744 | INFO     | logging:callHandlers:1706 - Elected group leader -- performing partition assignments using roundrobin
2025-05-10 09:49:25.747 | INFO     | logging:callHandlers:1706 - Successfully synced group financial-document-processor with generation 28
2025-05-10 09:49:25.748 | INFO     | logging:callHandlers:1706 - Setting newly assigned partitions {TopicPartition(topic='documents-processing', partition=0)} for group financial-document-processor
2025-05-10 09:49:25.764 | INFO     | logging:callHandlers:1706 - Processando documento 8 do tipo bank_statement
2025-05-10 09:49:25.773 | WARNING  | logging:callHandlers:1706 - Documento 8 não encontrado para atualização de status
2025-05-10 09:49:25.774 | INFO     | logging:callHandlers:1706 - Iniciando processamento do documento 8 do tipo bank_statement para o usuário 2
2025-05-10 09:51:11.883 | ERROR    | logging:callHandlers:1706 - Erro ao processar documento 8: Invalid format specifier ' "2023-01-15",
      "description": "TRANSFERÊNCIA RECEBIDA - JOÃO SILVA",
      "amount": "1500.00",
      "type": "CREDIT",
      "method": "TED",
      "categories": ["salário"],
      "confidence_score": 0.95
    ' for object of type 'str'
2025-05-10 09:51:11.887 | ERROR    | logging:callHandlers:1706 - Erro ao processar documento 8: Invalid format specifier ' "2023-01-15",
      "description": "TRANSFERÊNCIA RECEBIDA - JOÃO SILVA",
      "amount": "1500.00",
      "type": "CREDIT",
      "method": "TED",
      "categories": ["salário"],
      "confidence_score": 0.95
    ' for object of type 'str'
2025-05-10 09:51:11.890 | WARNING  | logging:callHandlers:1706 - Documento 8 não encontrado para atualização de status
2025-05-10 09:51:11.898 | WARNING  | logging:callHandlers:1706 - Heartbeat failed: local member_id was not recognized; resetting and re-joining group
2025-05-10 09:51:11.898 | ERROR    | logging:callHandlers:1706 - Heartbeat session expired - marking coordinator dead
2025-05-10 09:51:11.899 | WARNING  | logging:callHandlers:1706 - Marking the coordinator dead (node 1)for group financial-document-processor.
2025-05-10 09:51:11.902 | INFO     | logging:callHandlers:1706 - Discovered coordinator 1 for group financial-document-processor
2025-05-10 09:51:11.902 | INFO     | logging:callHandlers:1706 - Revoking previously assigned partitions frozenset({TopicPartition(topic='documents-processing', partition=0)}) for group financial-document-processor
2025-05-10 09:51:11.902 | INFO     | logging:callHandlers:1706 - (Re-)joining group financial-document-processor
2025-05-10 09:51:11.910 | INFO     | logging:callHandlers:1706 - Mensagem processada em 106.15s: documento_id=8, tipo=bank_statement
2025-05-10 09:51:14.918 | INFO     | logging:callHandlers:1706 - Joined group 'financial-document-processor' (generation 30) with member_id aiokafka-0.12.0-84a73bb0-deaf-42fb-80a2-3bdabec38968
2025-05-10 09:51:14.919 | INFO     | logging:callHandlers:1706 - Elected group leader -- performing partition assignments using roundrobin
2025-05-10 09:51:14.920 | ERROR    | logging:callHandlers:1706 - OffsetCommit failed for group financial-document-processor due to group error ([Error 22] IllegalGenerationError: financial-document-processor), will rejoin
2025-05-10 09:51:14.920 | ERROR    | logging:callHandlers:1706 - Erro ao processar mensagem: CommitFailedError: ('Commit cannot be completed since the group has already\n            rebalanced and assigned the partitions to another member.\n            This means that the time between subsequent calls to poll()\n            was longer than the configured max_poll_interval_ms, which\n            typically implies that the poll loop is spending too much\n            time message processing. You can address this either by\n            increasing the rebalance timeout with max_poll_interval_ms,\n            or by reducing the maximum size of batches returned in poll()\n            with max_poll_records.\n            ', 'Commit cannot be completed since the group has already rebalanced and may have assigned the partitions to another member')
2025-05-10 09:51:14.925 | INFO     | logging:callHandlers:1706 - Successfully synced group financial-document-processor with generation -1
2025-05-10 09:51:14.926 | INFO     | logging:callHandlers:1706 - Setting newly assigned partitions {TopicPartition(topic='documents-processing', partition=0)} for group financial-document-processor
2025-05-10 09:51:14.927 | INFO     | logging:callHandlers:1706 - Revoking previously assigned partitions frozenset({TopicPartition(topic='documents-processing', partition=0)}) for group financial-document-processor
2025-05-10 09:51:14.927 | INFO     | logging:callHandlers:1706 - (Re-)joining group financial-document-processor
2025-05-10 09:51:14.930 | INFO     | logging:callHandlers:1706 - Joined group 'financial-document-processor' (generation 31) with member_id aiokafka-0.12.0-84a73bb0-deaf-42fb-80a2-3bdabec38968
2025-05-10 09:51:14.930 | INFO     | logging:callHandlers:1706 - Elected group leader -- performing partition assignments using roundrobin
2025-05-10 09:51:14.932 | INFO     | logging:callHandlers:1706 - Successfully synced group financial-document-processor with generation 31
2025-05-10 09:51:14.933 | INFO     | logging:callHandlers:1706 - Setting newly assigned partitions {TopicPartition(topic='documents-processing', partition=0)} for group financial-document-processor
2025-05-10 09:51:14.938 | INFO     | logging:callHandlers:1706 - Processando documento 8 do tipo bank_statement
2025-05-10 09:51:14.939 | WARNING  | logging:callHandlers:1706 - Documento 8 não encontrado para atualização de status
2025-05-10 09:51:14.940 | INFO     | logging:callHandlers:1706 - Iniciando processamento do documento 8 do tipo bank_statement para o usuário 2
2025-05-10 09:51:37.826 | ERROR    | logging:callHandlers:1706 - Erro ao processar documento 8: Invalid format specifier ' "2023-01-15",
      "description": "TRANSFERÊNCIA RECEBIDA - JOÃO SILVA",
      "amount": "1500.00",
      "type": "CREDIT",
      "method": "TED",
      "categories": ["salário"],
      "confidence_score": 0.95
    ' for object of type 'str'
2025-05-10 09:51:37.827 | ERROR    | logging:callHandlers:1706 - Erro ao processar documento 8: Invalid format specifier ' "2023-01-15",
      "description": "TRANSFERÊNCIA RECEBIDA - JOÃO SILVA",
      "amount": "1500.00",
      "type": "CREDIT",
      "method": "TED",
      "categories": ["salário"],
      "confidence_score": 0.95
    ' for object of type 'str'
2025-05-10 09:51:37.837 | WARNING  | logging:callHandlers:1706 - Documento 8 não encontrado para atualização de status
2025-05-10 09:51:37.851 | WARNING  | logging:callHandlers:1706 - Heartbeat failed: local member_id was not recognized; resetting and re-joining group
2025-05-10 09:51:37.852 | ERROR    | logging:callHandlers:1706 - Heartbeat session expired - marking coordinator dead
2025-05-10 09:51:37.852 | WARNING  | logging:callHandlers:1706 - Marking the coordinator dead (node 1)for group financial-document-processor.
2025-05-10 09:51:37.864 | INFO     | logging:callHandlers:1706 - Discovered coordinator 1 for group financial-document-processor
2025-05-10 09:51:37.865 | INFO     | logging:callHandlers:1706 - Revoking previously assigned partitions frozenset({TopicPartition(topic='documents-processing', partition=0)}) for group financial-document-processor
2025-05-10 09:51:37.865 | INFO     | logging:callHandlers:1706 - (Re-)joining group financial-document-processor
2025-05-10 09:51:37.876 | INFO     | logging:callHandlers:1706 - Mensagem processada em 22.94s: documento_id=8, tipo=bank_statement
2025-05-10 09:51:40.883 | INFO     | logging:callHandlers:1706 - Joined group 'financial-document-processor' (generation 33) with member_id aiokafka-0.12.0-9e91a43a-bfb1-4595-9d0b-521c9ed18963
2025-05-10 09:51:40.884 | INFO     | logging:callHandlers:1706 - Elected group leader -- performing partition assignments using roundrobin
2025-05-10 09:51:40.886 | ERROR    | logging:callHandlers:1706 - OffsetCommit failed for group financial-document-processor due to group error ([Error 22] IllegalGenerationError: financial-document-processor), will rejoin
2025-05-10 09:51:40.887 | ERROR    | logging:callHandlers:1706 - Erro ao processar mensagem: CommitFailedError: ('Commit cannot be completed since the group has already\n            rebalanced and assigned the partitions to another member.\n            This means that the time between subsequent calls to poll()\n            was longer than the configured max_poll_interval_ms, which\n            typically implies that the poll loop is spending too much\n            time message processing. You can address this either by\n            increasing the rebalance timeout with max_poll_interval_ms,\n            or by reducing the maximum size of batches returned in poll()\n            with max_poll_records.\n            ', 'Commit cannot be completed since the group has already rebalanced and may have assigned the partitions to another member')
2025-05-10 09:51:40.890 | INFO     | logging:callHandlers:1706 - Successfully synced group financial-document-processor with generation -1
2025-05-10 09:51:40.893 | INFO     | logging:callHandlers:1706 - Setting newly assigned partitions {TopicPartition(topic='documents-processing', partition=0)} for group financial-document-processor
2025-05-10 09:51:40.894 | INFO     | logging:callHandlers:1706 - Revoking previously assigned partitions frozenset({TopicPartition(topic='documents-processing', partition=0)}) for group financial-document-processor
2025-05-10 09:51:40.894 | INFO     | logging:callHandlers:1706 - (Re-)joining group financial-document-processor
2025-05-10 09:51:40.900 | INFO     | logging:callHandlers:1706 - Joined group 'financial-document-processor' (generation 34) with member_id aiokafka-0.12.0-9e91a43a-bfb1-4595-9d0b-521c9ed18963
2025-05-10 09:51:40.900 | INFO     | logging:callHandlers:1706 - Elected group leader -- performing partition assignments using roundrobin
2025-05-10 09:51:40.904 | INFO     | logging:callHandlers:1706 - Successfully synced group financial-document-processor with generation 34
2025-05-10 09:51:40.905 | INFO     | logging:callHandlers:1706 - Setting newly assigned partitions {TopicPartition(topic='documents-processing', partition=0)} for group financial-document-processor
2025-05-10 09:51:40.911 | INFO     | logging:callHandlers:1706 - Processando documento 8 do tipo bank_statement
2025-05-10 09:51:40.912 | WARNING  | logging:callHandlers:1706 - Documento 8 não encontrado para atualização de status
2025-05-10 09:51:40.913 | INFO     | logging:callHandlers:1706 - Iniciando processamento do documento 8 do tipo bank_statement para o usuário 2
2025-05-10 09:51:49.969 | ERROR    | logging:callHandlers:1706 - Erro ao processar documento 8: Invalid format specifier ' "2023-01-15",
      "description": "TRANSFERÊNCIA RECEBIDA - JOÃO SILVA",
      "amount": "1500.00",
      "type": "CREDIT",
      "method": "TED",
      "categories": ["salário"],
      "confidence_score": 0.95
    ' for object of type 'str'
2025-05-10 09:51:49.973 | ERROR    | logging:callHandlers:1706 - Erro ao processar documento 8: Invalid format specifier ' "2023-01-15",
      "description": "TRANSFERÊNCIA RECEBIDA - JOÃO SILVA",
      "amount": "1500.00",
      "type": "CREDIT",
      "method": "TED",
      "categories": ["salário"],
      "confidence_score": 0.95
    ' for object of type 'str'
2025-05-10 09:51:49.981 | WARNING  | logging:callHandlers:1706 - Documento 8 não encontrado para atualização de status
2025-05-10 09:51:50.013 | INFO     | logging:callHandlers:1706 - Mensagem processada em 9.10s: documento_id=8, tipo=bank_statement
2025-05-10 09:59:13.910 | INFO     | logging:callHandlers:1706 - Processando documento 9 do tipo bank_statement
2025-05-10 09:59:14.598 | WARNING  | logging:callHandlers:1706 - Documento 9 não encontrado para atualização de status
2025-05-10 09:59:14.629 | INFO     | logging:callHandlers:1706 - Iniciando processamento do documento 9 do tipo bank_statement para o usuário 2
2025-05-10 10:00:31.955 | ERROR    | logging:callHandlers:1706 - Erro ao processar documento 9: Invalid format specifier ' "2023-01-15",
      "description": "TRANSFERÊNCIA RECEBIDA - JOÃO SILVA",
      "amount": "1500.00",
      "type": "CREDIT",
      "method": "TED",
      "categories": ["salário"],
      "confidence_score": 0.95
    ' for object of type 'str'
2025-05-10 10:00:31.958 | ERROR    | logging:callHandlers:1706 - Erro ao processar documento 9: Invalid format specifier ' "2023-01-15",
      "description": "TRANSFERÊNCIA RECEBIDA - JOÃO SILVA",
      "amount": "1500.00",
      "type": "CREDIT",
      "method": "TED",
      "categories": ["salário"],
      "confidence_score": 0.95
    ' for object of type 'str'
2025-05-10 10:00:31.970 | WARNING  | logging:callHandlers:1706 - Documento 9 não encontrado para atualização de status
2025-05-10 10:00:31.971 | WARNING  | logging:callHandlers:1706 - Heartbeat failed: local member_id was not recognized; resetting and re-joining group
2025-05-10 10:00:31.972 | ERROR    | logging:callHandlers:1706 - Heartbeat session expired - marking coordinator dead
2025-05-10 10:00:31.972 | WARNING  | logging:callHandlers:1706 - Marking the coordinator dead (node 1)for group financial-document-processor.
2025-05-10 10:00:31.981 | INFO     | logging:callHandlers:1706 - Discovered coordinator 1 for group financial-document-processor
2025-05-10 10:00:31.981 | INFO     | logging:callHandlers:1706 - Revoking previously assigned partitions frozenset({TopicPartition(topic='documents-processing', partition=0)}) for group financial-document-processor
2025-05-10 10:00:31.981 | INFO     | logging:callHandlers:1706 - (Re-)joining group financial-document-processor
2025-05-10 10:00:31.991 | INFO     | logging:callHandlers:1706 - Mensagem processada em 78.09s: documento_id=9, tipo=bank_statement
2025-05-10 10:00:35.005 | INFO     | logging:callHandlers:1706 - Joined group 'financial-document-processor' (generation 36) with member_id aiokafka-0.12.0-fe9e09a9-e103-4bbc-bacc-2c2f3794bc05
2025-05-10 10:00:35.006 | INFO     | logging:callHandlers:1706 - Elected group leader -- performing partition assignments using roundrobin
2025-05-10 10:00:35.009 | ERROR    | logging:callHandlers:1706 - OffsetCommit failed for group financial-document-processor due to group error ([Error 22] IllegalGenerationError: financial-document-processor), will rejoin
2025-05-10 10:00:35.011 | ERROR    | logging:callHandlers:1706 - Erro ao processar mensagem: CommitFailedError: ('Commit cannot be completed since the group has already\n            rebalanced and assigned the partitions to another member.\n            This means that the time between subsequent calls to poll()\n            was longer than the configured max_poll_interval_ms, which\n            typically implies that the poll loop is spending too much\n            time message processing. You can address this either by\n            increasing the rebalance timeout with max_poll_interval_ms,\n            or by reducing the maximum size of batches returned in poll()\n            with max_poll_records.\n            ', 'Commit cannot be completed since the group has already rebalanced and may have assigned the partitions to another member')
2025-05-10 10:00:35.015 | INFO     | logging:callHandlers:1706 - Successfully synced group financial-document-processor with generation -1
2025-05-10 10:00:35.016 | INFO     | logging:callHandlers:1706 - Setting newly assigned partitions {TopicPartition(topic='documents-processing', partition=0)} for group financial-document-processor
2025-05-10 10:00:35.017 | INFO     | logging:callHandlers:1706 - Revoking previously assigned partitions frozenset({TopicPartition(topic='documents-processing', partition=0)}) for group financial-document-processor
2025-05-10 10:00:35.018 | INFO     | logging:callHandlers:1706 - (Re-)joining group financial-document-processor
2025-05-10 10:00:35.020 | INFO     | logging:callHandlers:1706 - Joined group 'financial-document-processor' (generation 37) with member_id aiokafka-0.12.0-fe9e09a9-e103-4bbc-bacc-2c2f3794bc05
2025-05-10 10:00:35.021 | INFO     | logging:callHandlers:1706 - Elected group leader -- performing partition assignments using roundrobin
2025-05-10 10:00:35.024 | INFO     | logging:callHandlers:1706 - Successfully synced group financial-document-processor with generation 37
2025-05-10 10:00:35.024 | INFO     | logging:callHandlers:1706 - Setting newly assigned partitions {TopicPartition(topic='documents-processing', partition=0)} for group financial-document-processor
2025-05-10 10:00:35.033 | INFO     | logging:callHandlers:1706 - Processando documento 9 do tipo bank_statement
2025-05-10 10:00:35.034 | WARNING  | logging:callHandlers:1706 - Documento 9 não encontrado para atualização de status
2025-05-10 10:00:35.035 | INFO     | logging:callHandlers:1706 - Iniciando processamento do documento 9 do tipo bank_statement para o usuário 2
2025-05-10 10:02:40.738 | ERROR    | logging:callHandlers:1706 - Erro ao processar documento 9: Invalid format specifier ' "2023-01-15",
      "description": "TRANSFERÊNCIA RECEBIDA - JOÃO SILVA",
      "amount": "1500.00",
      "type": "CREDIT",
      "method": "TED",
      "categories": ["salário"],
      "confidence_score": 0.95
    ' for object of type 'str'
2025-05-10 10:02:40.768 | ERROR    | logging:callHandlers:1706 - Erro ao processar documento 9: Invalid format specifier ' "2023-01-15",
      "description": "TRANSFERÊNCIA RECEBIDA - JOÃO SILVA",
      "amount": "1500.00",
      "type": "CREDIT",
      "method": "TED",
      "categories": ["salário"],
      "confidence_score": 0.95
    ' for object of type 'str'
2025-05-10 10:02:40.788 | WARNING  | logging:callHandlers:1706 - Heartbeat failed: local member_id was not recognized; resetting and re-joining group
2025-05-10 10:02:40.788 | ERROR    | logging:callHandlers:1706 - Heartbeat session expired - marking coordinator dead
2025-05-10 10:02:40.788 | WARNING  | logging:callHandlers:1706 - Marking the coordinator dead (node 1)for group financial-document-processor.
2025-05-10 10:02:40.793 | INFO     | logging:callHandlers:1706 - Discovered coordinator 1 for group financial-document-processor
2025-05-10 10:02:40.793 | INFO     | logging:callHandlers:1706 - Revoking previously assigned partitions frozenset({TopicPartition(topic='documents-processing', partition=0)}) for group financial-document-processor
2025-05-10 10:02:40.794 | INFO     | logging:callHandlers:1706 - (Re-)joining group financial-document-processor
2025-05-10 10:02:40.829 | WARNING  | logging:callHandlers:1706 - Documento 9 não encontrado para atualização de status
2025-05-10 10:02:40.867 | INFO     | logging:callHandlers:1706 - Mensagem processada em 125.83s: documento_id=9, tipo=bank_statement
2025-05-10 10:02:43.809 | INFO     | logging:callHandlers:1706 - Joined group 'financial-document-processor' (generation 39) with member_id aiokafka-0.12.0-a8ac48fb-3f0c-475d-b8c5-a7faa5e5a546
2025-05-10 10:02:43.809 | INFO     | logging:callHandlers:1706 - Elected group leader -- performing partition assignments using roundrobin
2025-05-10 10:02:43.811 | ERROR    | logging:callHandlers:1706 - OffsetCommit failed for group financial-document-processor due to group error ([Error 22] IllegalGenerationError: financial-document-processor), will rejoin
2025-05-10 10:02:43.813 | ERROR    | logging:callHandlers:1706 - Erro ao processar mensagem: CommitFailedError: ('Commit cannot be completed since the group has already\n            rebalanced and assigned the partitions to another member.\n            This means that the time between subsequent calls to poll()\n            was longer than the configured max_poll_interval_ms, which\n            typically implies that the poll loop is spending too much\n            time message processing. You can address this either by\n            increasing the rebalance timeout with max_poll_interval_ms,\n            or by reducing the maximum size of batches returned in poll()\n            with max_poll_records.\n            ', 'Commit cannot be completed since the group has already rebalanced and may have assigned the partitions to another member')
2025-05-10 10:02:43.818 | INFO     | logging:callHandlers:1706 - Successfully synced group financial-document-processor with generation -1
2025-05-10 10:02:43.819 | INFO     | logging:callHandlers:1706 - Setting newly assigned partitions {TopicPartition(topic='documents-processing', partition=0)} for group financial-document-processor
2025-05-10 10:02:43.820 | INFO     | logging:callHandlers:1706 - Revoking previously assigned partitions frozenset({TopicPartition(topic='documents-processing', partition=0)}) for group financial-document-processor
2025-05-10 10:02:43.820 | INFO     | logging:callHandlers:1706 - (Re-)joining group financial-document-processor
2025-05-10 10:02:43.823 | INFO     | logging:callHandlers:1706 - Joined group 'financial-document-processor' (generation 40) with member_id aiokafka-0.12.0-a8ac48fb-3f0c-475d-b8c5-a7faa5e5a546
2025-05-10 10:02:43.823 | INFO     | logging:callHandlers:1706 - Elected group leader -- performing partition assignments using roundrobin
2025-05-10 10:02:43.828 | INFO     | logging:callHandlers:1706 - Successfully synced group financial-document-processor with generation 40
2025-05-10 10:02:43.828 | INFO     | logging:callHandlers:1706 - Setting newly assigned partitions {TopicPartition(topic='documents-processing', partition=0)} for group financial-document-processor
2025-05-10 10:02:43.842 | INFO     | logging:callHandlers:1706 - Processando documento 9 do tipo bank_statement
2025-05-10 10:02:43.844 | WARNING  | logging:callHandlers:1706 - Documento 9 não encontrado para atualização de status
2025-05-10 10:02:43.844 | INFO     | logging:callHandlers:1706 - Iniciando processamento do documento 9 do tipo bank_statement para o usuário 2
2025-05-10 10:03:30.571 | INFO     | logging:callHandlers:1706 - Sinal 2 recebido, iniciando desligamento...
2025-05-10 10:03:33.521 | INFO     | financial_document_processor.utils.logging:setup_logging:69 - Sistema de logging configurado com nível INFO
2025-05-10 10:03:33.542 | INFO     | logging:callHandlers:1706 - Inicializando aplicação...
2025-05-10 10:03:33.804 | INFO     | logging:callHandlers:1706 - Conexão estabelecida com o PostgreSQL. Pool criado com 5-20 conexões.
2025-05-10 10:03:33.815 | INFO     | logging:callHandlers:1706 - Esquema do banco de dados verificado/criado com sucesso
2025-05-10 10:03:33.847 | INFO     | logging:callHandlers:1706 - Produtor Kafka iniciado
2025-05-10 10:03:33.881 | INFO     | logging:callHandlers:1706 - Usando provedor de IA: claude
2025-05-10 10:03:33.882 | INFO     | logging:callHandlers:1706 - Carregadas 61 categorias padrão
2025-05-10 10:03:33.882 | INFO     | logging:callHandlers:1706 - Serviço de categorização inicializado
2025-05-10 10:03:33.883 | INFO     | logging:callHandlers:1706 - Updating subscribed topics to: frozenset({'documents-processing'})
2025-05-10 10:03:33.906 | INFO     | logging:callHandlers:1706 - Discovered coordinator 1 for group financial-document-processor
2025-05-10 10:03:33.906 | INFO     | logging:callHandlers:1706 - Revoking previously assigned partitions set() for group financial-document-processor
2025-05-10 10:03:33.906 | INFO     | logging:callHandlers:1706 - (Re-)joining group financial-document-processor
2025-05-10 10:03:36.919 | INFO     | logging:callHandlers:1706 - Joined group 'financial-document-processor' (generation 42) with member_id aiokafka-0.12.0-4fa0bdb3-bfa0-4383-872b-61eb8515d1e4
2025-05-10 10:03:36.919 | INFO     | logging:callHandlers:1706 - Elected group leader -- performing partition assignments using roundrobin
2025-05-10 10:03:36.937 | INFO     | logging:callHandlers:1706 - Successfully synced group financial-document-processor with generation 42
2025-05-10 10:03:36.940 | INFO     | logging:callHandlers:1706 - Setting newly assigned partitions {TopicPartition(topic='documents-processing', partition=0)} for group financial-document-processor
2025-05-10 10:03:36.941 | INFO     | logging:callHandlers:1706 - Consumidor Kafka iniciado para o tópico documents-processing
2025-05-10 10:03:36.941 | INFO     | logging:callHandlers:1706 - Aplicação inicializada com sucesso
2025-05-10 10:03:36.941 | INFO     | logging:callHandlers:1706 - Aplicação em execução
2025-05-10 10:03:36.954 | INFO     | logging:callHandlers:1706 - Processando documento 9 do tipo bank_statement
2025-05-10 10:03:36.997 | WARNING  | logging:callHandlers:1706 - Documento 9 não encontrado para atualização de status
2025-05-10 10:03:36.998 | INFO     | logging:callHandlers:1706 - Iniciando processamento do documento 9 do tipo bank_statement para o usuário 2
2025-05-10 10:03:50.004 | ERROR    | logging:callHandlers:1706 - Erro ao processar documento 9: Invalid format specifier ' "2023-01-15",
      "description": "TRANSFERÊNCIA RECEBIDA - JOÃO SILVA",
      "amount": "1500.00",
      "type": "CREDIT",
      "method": "TED",
      "categories": ["salário"],
      "confidence_score": 0.95
    ' for object of type 'str'
2025-05-10 10:03:50.005 | ERROR    | logging:callHandlers:1706 - Erro ao processar documento 9: Invalid format specifier ' "2023-01-15",
      "description": "TRANSFERÊNCIA RECEBIDA - JOÃO SILVA",
      "amount": "1500.00",
      "type": "CREDIT",
      "method": "TED",
      "categories": ["salário"],
      "confidence_score": 0.95
    ' for object of type 'str'
2025-05-10 10:03:50.013 | WARNING  | logging:callHandlers:1706 - Documento 9 não encontrado para atualização de status
2025-05-10 10:03:50.019 | WARNING  | logging:callHandlers:1706 - Heartbeat failed: local member_id was not recognized; resetting and re-joining group
2025-05-10 10:03:50.019 | ERROR    | logging:callHandlers:1706 - Heartbeat session expired - marking coordinator dead
2025-05-10 10:03:50.019 | WARNING  | logging:callHandlers:1706 - Marking the coordinator dead (node 1)for group financial-document-processor.
2025-05-10 10:03:50.026 | INFO     | logging:callHandlers:1706 - Discovered coordinator 1 for group financial-document-processor
2025-05-10 10:03:50.026 | INFO     | logging:callHandlers:1706 - Revoking previously assigned partitions frozenset({TopicPartition(topic='documents-processing', partition=0)}) for group financial-document-processor
2025-05-10 10:03:50.026 | INFO     | logging:callHandlers:1706 - (Re-)joining group financial-document-processor
2025-05-10 10:03:50.039 | INFO     | logging:callHandlers:1706 - Mensagem processada em 13.09s: documento_id=9, tipo=bank_statement
2025-05-10 10:03:53.054 | INFO     | logging:callHandlers:1706 - Joined group 'financial-document-processor' (generation 44) with member_id aiokafka-0.12.0-9e38a1a1-0b8a-4070-9989-d07f648a27a9
2025-05-10 10:03:53.055 | INFO     | logging:callHandlers:1706 - Elected group leader -- performing partition assignments using roundrobin
2025-05-10 10:03:53.059 | ERROR    | logging:callHandlers:1706 - OffsetCommit failed for group financial-document-processor due to group error ([Error 22] IllegalGenerationError: financial-document-processor), will rejoin
2025-05-10 10:03:53.060 | ERROR    | logging:callHandlers:1706 - Erro ao processar mensagem: CommitFailedError: ('Commit cannot be completed since the group has already\n            rebalanced and assigned the partitions to another member.\n            This means that the time between subsequent calls to poll()\n            was longer than the configured max_poll_interval_ms, which\n            typically implies that the poll loop is spending too much\n            time message processing. You can address this either by\n            increasing the rebalance timeout with max_poll_interval_ms,\n            or by reducing the maximum size of batches returned in poll()\n            with max_poll_records.\n            ', 'Commit cannot be completed since the group has already rebalanced and may have assigned the partitions to another member')
2025-05-10 10:03:53.062 | INFO     | logging:callHandlers:1706 - Successfully synced group financial-document-processor with generation -1
2025-05-10 10:03:53.064 | INFO     | logging:callHandlers:1706 - Setting newly assigned partitions {TopicPartition(topic='documents-processing', partition=0)} for group financial-document-processor
2025-05-10 10:03:53.065 | INFO     | logging:callHandlers:1706 - Revoking previously assigned partitions frozenset({TopicPartition(topic='documents-processing', partition=0)}) for group financial-document-processor
2025-05-10 10:03:53.065 | INFO     | logging:callHandlers:1706 - (Re-)joining group financial-document-processor
2025-05-10 10:03:53.069 | INFO     | logging:callHandlers:1706 - Joined group 'financial-document-processor' (generation 45) with member_id aiokafka-0.12.0-9e38a1a1-0b8a-4070-9989-d07f648a27a9
2025-05-10 10:03:53.069 | INFO     | logging:callHandlers:1706 - Elected group leader -- performing partition assignments using roundrobin
2025-05-10 10:03:53.077 | INFO     | logging:callHandlers:1706 - Successfully synced group financial-document-processor with generation 45
2025-05-10 10:03:53.079 | INFO     | logging:callHandlers:1706 - Setting newly assigned partitions {TopicPartition(topic='documents-processing', partition=0)} for group financial-document-processor
2025-05-10 10:03:53.084 | INFO     | logging:callHandlers:1706 - Processando documento 9 do tipo bank_statement
2025-05-10 10:03:53.085 | WARNING  | logging:callHandlers:1706 - Documento 9 não encontrado para atualização de status
2025-05-10 10:03:53.088 | INFO     | logging:callHandlers:1706 - Iniciando processamento do documento 9 do tipo bank_statement para o usuário 2
2025-05-10 10:05:22.704 | INFO     | logging:callHandlers:1706 - Sinal 2 recebido, iniciando desligamento...
2025-05-10 10:07:08.365 | INFO     | financial_document_processor.utils.logging:setup_logging:69 - Sistema de logging configurado com nível INFO
2025-05-10 10:07:08.390 | INFO     | logging:callHandlers:1706 - Inicializando aplicação...
2025-05-10 10:07:08.593 | INFO     | logging:callHandlers:1706 - Conexão estabelecida com o PostgreSQL. Pool criado com 5-20 conexões.
2025-05-10 10:07:08.601 | INFO     | logging:callHandlers:1706 - Esquema do banco de dados verificado/criado com sucesso
2025-05-10 10:07:08.628 | INFO     | logging:callHandlers:1706 - Produtor Kafka iniciado
2025-05-10 10:07:08.661 | INFO     | logging:callHandlers:1706 - Usando provedor de IA: claude
2025-05-10 10:07:08.662 | INFO     | logging:callHandlers:1706 - Carregadas 61 categorias padrão
2025-05-10 10:07:08.662 | INFO     | logging:callHandlers:1706 - Serviço de categorização inicializado
2025-05-10 10:07:08.663 | INFO     | logging:callHandlers:1706 - Updating subscribed topics to: frozenset({'documents-processing'})
2025-05-10 10:07:08.687 | INFO     | logging:callHandlers:1706 - Discovered coordinator 1 for group financial-document-processor
2025-05-10 10:07:08.687 | INFO     | logging:callHandlers:1706 - Revoking previously assigned partitions set() for group financial-document-processor
2025-05-10 10:07:08.688 | INFO     | logging:callHandlers:1706 - (Re-)joining group financial-document-processor
2025-05-10 10:07:11.723 | INFO     | logging:callHandlers:1706 - Joined group 'financial-document-processor' (generation 47) with member_id aiokafka-0.12.0-b1d24045-104d-4393-9ce8-be97a22dc6f4
2025-05-10 10:07:11.724 | INFO     | logging:callHandlers:1706 - Elected group leader -- performing partition assignments using roundrobin
2025-05-10 10:07:11.738 | INFO     | logging:callHandlers:1706 - Successfully synced group financial-document-processor with generation 47
2025-05-10 10:07:11.740 | INFO     | logging:callHandlers:1706 - Setting newly assigned partitions {TopicPartition(topic='documents-processing', partition=0)} for group financial-document-processor
2025-05-10 10:07:11.742 | INFO     | logging:callHandlers:1706 - Consumidor Kafka iniciado para o tópico documents-processing
2025-05-10 10:07:11.742 | INFO     | logging:callHandlers:1706 - Aplicação inicializada com sucesso
2025-05-10 10:07:11.742 | INFO     | logging:callHandlers:1706 - Aplicação em execução
2025-05-10 10:07:11.762 | INFO     | logging:callHandlers:1706 - Processando documento 9 do tipo bank_statement
2025-05-10 10:07:11.846 | WARNING  | logging:callHandlers:1706 - Documento 9 não encontrado para atualização de status
2025-05-10 10:07:11.847 | INFO     | logging:callHandlers:1706 - Iniciando processamento do documento 9 do tipo bank_statement para o usuário 2
2025-05-10 10:08:52.525 | INFO     | logging:callHandlers:1706 - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-05-10 10:10:56.595 | ERROR    | logging:callHandlers:1706 - Erro ao converter item para Transaction: 4 validation errors for Transaction
document_id
  Field required [type=missing, input_value={'date': '2025-04-29', 'd...10, 10, 10, 56, 591296)}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
user_id
  Field required [type=missing, input_value={'date': '2025-04-29', 'd...10, 10, 10, 56, 591296)}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
type
  Input should be 'credit' or 'debit' [type=enum, input_value='CREDIT', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/enum
method
  Input should be 'pix', 'ted', 'doc', 'boleto', 'payment', 'transfer', 'withdrawal', 'deposit', 'loan' or 'other' [type=enum, input_value='PIX', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/enum
2025-05-10 10:10:56.596 | ERROR    | logging:callHandlers:1706 - Erro ao converter item para Transaction: 4 validation errors for Transaction
document_id
  Field required [type=missing, input_value={'date': '2025-05-02', 'd...10, 10, 10, 56, 596652)}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
user_id
  Field required [type=missing, input_value={'date': '2025-05-02', 'd...10, 10, 10, 56, 596652)}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
type
  Input should be 'credit' or 'debit' [type=enum, input_value='DEBIT', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/enum
method
  Input should be 'pix', 'ted', 'doc', 'boleto', 'payment', 'transfer', 'withdrawal', 'deposit', 'loan' or 'other' [type=enum, input_value='PIX', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/enum
2025-05-10 10:10:56.596 | ERROR    | logging:callHandlers:1706 - Erro ao converter item para Transaction: 3 validation errors for Transaction
document_id
  Field required [type=missing, input_value={'date': '2025-05-02', 'd...10, 10, 10, 56, 596851)}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
user_id
  Field required [type=missing, input_value={'date': '2025-05-02', 'd...10, 10, 10, 56, 596851)}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
type
  Input should be 'credit' or 'debit' [type=enum, input_value='DEBIT', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/enum
2025-05-10 10:10:56.597 | ERROR    | logging:callHandlers:1706 - Erro ao converter item para Transaction: 3 validation errors for Transaction
document_id
  Field required [type=missing, input_value={'date': '2025-05-02', 'd...10, 10, 10, 56, 597019)}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
user_id
  Field required [type=missing, input_value={'date': '2025-05-02', 'd...10, 10, 10, 56, 597019)}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
type
  Input should be 'credit' or 'debit' [type=enum, input_value='DEBIT', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/enum
2025-05-10 10:10:56.597 | ERROR    | logging:callHandlers:1706 - Erro ao converter item para Transaction: 3 validation errors for Transaction
document_id
  Field required [type=missing, input_value={'date': '2025-05-02', 'd...10, 10, 10, 56, 597157)}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
user_id
  Field required [type=missing, input_value={'date': '2025-05-02', 'd...10, 10, 10, 56, 597157)}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
type
  Input should be 'credit' or 'debit' [type=enum, input_value='DEBIT', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/enum
2025-05-10 10:10:56.597 | ERROR    | logging:callHandlers:1706 - Erro ao converter item para Transaction: 4 validation errors for Transaction
document_id
  Field required [type=missing, input_value={'date': '2025-05-05', 'd...10, 10, 10, 56, 597281)}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
user_id
  Field required [type=missing, input_value={'date': '2025-05-05', 'd...10, 10, 10, 56, 597281)}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
type
  Input should be 'credit' or 'debit' [type=enum, input_value='CREDIT', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/enum
method
  Input should be 'pix', 'ted', 'doc', 'boleto', 'payment', 'transfer', 'withdrawal', 'deposit', 'loan' or 'other' [type=enum, input_value='PIX', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/enum
2025-05-10 10:10:56.597 | ERROR    | logging:callHandlers:1706 - Erro ao converter item para Transaction: 4 validation errors for Transaction
document_id
  Field required [type=missing, input_value={'date': '2025-05-05', 'd...10, 10, 10, 56, 597522)}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
user_id
  Field required [type=missing, input_value={'date': '2025-05-05', 'd...10, 10, 10, 56, 597522)}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
type
  Input should be 'credit' or 'debit' [type=enum, input_value='DEBIT', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/enum
method
  Input should be 'pix', 'ted', 'doc', 'boleto', 'payment', 'transfer', 'withdrawal', 'deposit', 'loan' or 'other' [type=enum, input_value='PIX', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/enum
2025-05-10 10:10:56.597 | ERROR    | logging:callHandlers:1706 - Erro ao converter item para Transaction: 4 validation errors for Transaction
document_id
  Field required [type=missing, input_value={'date': '2025-05-05', 'd...10, 10, 10, 56, 597732)}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
user_id
  Field required [type=missing, input_value={'date': '2025-05-05', 'd...10, 10, 10, 56, 597732)}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
type
  Input should be 'credit' or 'debit' [type=enum, input_value='DEBIT', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/enum
method
  Input should be 'pix', 'ted', 'doc', 'boleto', 'payment', 'transfer', 'withdrawal', 'deposit', 'loan' or 'other' [type=enum, input_value='PIX', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/enum
2025-05-10 10:10:56.597 | ERROR    | logging:callHandlers:1706 - Erro ao converter item para Transaction: 4 validation errors for Transaction
document_id
  Field required [type=missing, input_value={'date': '2025-05-05', 'd...10, 10, 10, 56, 597889)}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
user_id
  Field required [type=missing, input_value={'date': '2025-05-05', 'd...10, 10, 10, 56, 597889)}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
type
  Input should be 'credit' or 'debit' [type=enum, input_value='DEBIT', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/enum
method
  Input should be 'pix', 'ted', 'doc', 'boleto', 'payment', 'transfer', 'withdrawal', 'deposit', 'loan' or 'other' [type=enum, input_value='PIX', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/enum
2025-05-10 10:10:56.598 | ERROR    | logging:callHandlers:1706 - Erro ao converter item para Transaction: 3 validation errors for Transaction
document_id
  Field required [type=missing, input_value={'date': '2025-05-05', 'd...10, 10, 10, 56, 598031)}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
user_id
  Field required [type=missing, input_value={'date': '2025-05-05', 'd...10, 10, 10, 56, 598031)}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
type
  Input should be 'credit' or 'debit' [type=enum, input_value='CREDIT', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/enum
2025-05-10 10:10:56.598 | ERROR    | logging:callHandlers:1706 - Erro ao converter item para Transaction: 4 validation errors for Transaction
document_id
  Field required [type=missing, input_value={'date': '2025-05-06', 'd...10, 10, 10, 56, 598204)}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
user_id
  Field required [type=missing, input_value={'date': '2025-05-06', 'd...10, 10, 10, 56, 598204)}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
type
  Input should be 'credit' or 'debit' [type=enum, input_value='CREDIT', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/enum
method
  Input should be 'pix', 'ted', 'doc', 'boleto', 'payment', 'transfer', 'withdrawal', 'deposit', 'loan' or 'other' [type=enum, input_value='PIX', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/enum
2025-05-10 10:10:56.598 | ERROR    | logging:callHandlers:1706 - Erro ao converter item para Transaction: 4 validation errors for Transaction
document_id
  Field required [type=missing, input_value={'date': '2025-05-06', 'd...10, 10, 10, 56, 598331)}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
user_id
  Field required [type=missing, input_value={'date': '2025-05-06', 'd...10, 10, 10, 56, 598331)}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
type
  Input should be 'credit' or 'debit' [type=enum, input_value='DEBIT', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/enum
method
  Input should be 'pix', 'ted', 'doc', 'boleto', 'payment', 'transfer', 'withdrawal', 'deposit', 'loan' or 'other' [type=enum, input_value='PIX', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/enum
2025-05-10 10:10:56.598 | ERROR    | logging:callHandlers:1706 - Erro ao converter item para Transaction: 3 validation errors for Transaction
document_id
  Field required [type=missing, input_value={'date': '2025-05-06', 'd...10, 10, 10, 56, 598538)}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
user_id
  Field required [type=missing, input_value={'date': '2025-05-06', 'd...10, 10, 10, 56, 598538)}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
type
  Input should be 'credit' or 'debit' [type=enum, input_value='DEBIT', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/enum
2025-05-10 10:10:56.598 | ERROR    | logging:callHandlers:1706 - Erro ao converter item para Transaction: 4 validation errors for Transaction
document_id
  Field required [type=missing, input_value={'date': '2025-05-06', 'd...10, 10, 10, 56, 598660)}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
user_id
  Field required [type=missing, input_value={'date': '2025-05-06', 'd...10, 10, 10, 56, 598660)}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
type
  Input should be 'credit' or 'debit' [type=enum, input_value='DEBIT', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/enum
method
  Input should be 'pix', 'ted', 'doc', 'boleto', 'payment', 'transfer', 'withdrawal', 'deposit', 'loan' or 'other' [type=enum, input_value='DEPÓSITO', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/enum
2025-05-10 10:10:56.599 | ERROR    | logging:callHandlers:1706 - Erro ao converter item para Transaction: 3 validation errors for Transaction
document_id
  Field required [type=missing, input_value={'date': '2025-05-06', 'd...10, 10, 10, 56, 599243)}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
user_id
  Field required [type=missing, input_value={'date': '2025-05-06', 'd...10, 10, 10, 56, 599243)}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
type
  Input should be 'credit' or 'debit' [type=enum, input_value='DEBIT', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/enum
2025-05-10 10:10:56.599 | ERROR    | logging:callHandlers:1706 - Erro ao converter item para Transaction: 4 validation errors for Transaction
document_id
  Field required [type=missing, input_value={'date': '2025-05-06', 'd...10, 10, 10, 56, 599507)}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
user_id
  Field required [type=missing, input_value={'date': '2025-05-06', 'd...10, 10, 10, 56, 599507)}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
type
  Input should be 'credit' or 'debit' [type=enum, input_value='DEBIT', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/enum
method
  Input should be 'pix', 'ted', 'doc', 'boleto', 'payment', 'transfer', 'withdrawal', 'deposit', 'loan' or 'other' [type=enum, input_value='PIX', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/enum
2025-05-10 10:10:56.599 | ERROR    | logging:callHandlers:1706 - Erro ao converter item para Transaction: 4 validation errors for Transaction
document_id
  Field required [type=missing, input_value={'date': '2025-05-06', 'd...10, 10, 10, 56, 599678)}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
user_id
  Field required [type=missing, input_value={'date': '2025-05-06', 'd...10, 10, 10, 56, 599678)}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
type
  Input should be 'credit' or 'debit' [type=enum, input_value='DEBIT', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/enum
method
  Input should be 'pix', 'ted', 'doc', 'boleto', 'payment', 'transfer', 'withdrawal', 'deposit', 'loan' or 'other' [type=enum, input_value='PIX', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/enum
2025-05-10 10:10:56.599 | ERROR    | logging:callHandlers:1706 - Erro ao converter item para Transaction: 4 validation errors for Transaction
document_id
  Field required [type=missing, input_value={'date': '2025-05-06', 'd...10, 10, 10, 56, 599807)}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
user_id
  Field required [type=missing, input_value={'date': '2025-05-06', 'd...10, 10, 10, 56, 599807)}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
type
  Input should be 'credit' or 'debit' [type=enum, input_value='DEBIT', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/enum
method
  Input should be 'pix', 'ted', 'doc', 'boleto', 'payment', 'transfer', 'withdrawal', 'deposit', 'loan' or 'other' [type=enum, input_value='PIX', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/enum
2025-05-10 10:10:56.600 | ERROR    | logging:callHandlers:1706 - Erro ao converter item para Transaction: 4 validation errors for Transaction
document_id
  Field required [type=missing, input_value={'date': '2025-05-06', 'd...10, 10, 10, 56, 599943)}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
user_id
  Field required [type=missing, input_value={'date': '2025-05-06', 'd...10, 10, 10, 56, 599943)}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
type
  Input should be 'credit' or 'debit' [type=enum, input_value='CREDIT', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/enum
method
  Input should be 'pix', 'ted', 'doc', 'boleto', 'payment', 'transfer', 'withdrawal', 'deposit', 'loan' or 'other' [type=enum, input_value='PIX', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/enum
2025-05-10 10:10:56.600 | ERROR    | logging:callHandlers:1706 - Erro ao converter item para Transaction: 4 validation errors for Transaction
document_id
  Field required [type=missing, input_value={'date': '2025-05-07', 'd...10, 10, 10, 56, 600109)}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
user_id
  Field required [type=missing, input_value={'date': '2025-05-07', 'd...10, 10, 10, 56, 600109)}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
type
  Input should be 'credit' or 'debit' [type=enum, input_value='CREDIT', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/enum
method
  Input should be 'pix', 'ted', 'doc', 'boleto', 'payment', 'transfer', 'withdrawal', 'deposit', 'loan' or 'other' [type=enum, input_value='TRANSFERÊNCIA', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/enum
2025-05-10 10:10:56.600 | ERROR    | logging:callHandlers:1706 - Erro ao converter item para Transaction: 4 validation errors for Transaction
document_id
  Field required [type=missing, input_value={'date': '2025-05-08', 'd...10, 10, 10, 56, 600270)}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
user_id
  Field required [type=missing, input_value={'date': '2025-05-08', 'd...10, 10, 10, 56, 600270)}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
type
  Input should be 'credit' or 'debit' [type=enum, input_value='CREDIT', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/enum
method
  Input should be 'pix', 'ted', 'doc', 'boleto', 'payment', 'transfer', 'withdrawal', 'deposit', 'loan' or 'other' [type=enum, input_value='TRANSFERÊNCIA', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/enum
2025-05-10 10:10:56.600 | ERROR    | logging:callHandlers:1706 - Erro ao converter item para Transaction: 4 validation errors for Transaction
document_id
  Field required [type=missing, input_value={'date': '2025-05-09', 'd...10, 10, 10, 56, 600414)}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
user_id
  Field required [type=missing, input_value={'date': '2025-05-09', 'd...10, 10, 10, 56, 600414)}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
type
  Input should be 'credit' or 'debit' [type=enum, input_value='DEBIT', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/enum
method
  Input should be 'pix', 'ted', 'doc', 'boleto', 'payment', 'transfer', 'withdrawal', 'deposit', 'loan' or 'other' [type=enum, input_value='PIX', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/enum
2025-05-10 10:10:56.601 | WARNING  | logging:callHandlers:1706 - Nenhuma transação extraída do documento 9
2025-05-10 10:10:56.602 | WARNING  | logging:callHandlers:1706 - Nenhuma transação extraída do documento 9
2025-05-10 10:10:56.612 | WARNING  | logging:callHandlers:1706 - Documento 9 não encontrado para atualização de status
2025-05-10 10:10:56.616 | WARNING  | logging:callHandlers:1706 - Heartbeat failed: local member_id was not recognized; resetting and re-joining group
2025-05-10 10:10:56.617 | ERROR    | logging:callHandlers:1706 - Heartbeat session expired - marking coordinator dead
2025-05-10 10:10:56.617 | WARNING  | logging:callHandlers:1706 - Marking the coordinator dead (node 1)for group financial-document-processor.
2025-05-10 10:10:56.624 | INFO     | logging:callHandlers:1706 - Discovered coordinator 1 for group financial-document-processor
2025-05-10 10:10:56.624 | INFO     | logging:callHandlers:1706 - Revoking previously assigned partitions frozenset({TopicPartition(topic='documents-processing', partition=0)}) for group financial-document-processor
2025-05-10 10:10:56.625 | INFO     | logging:callHandlers:1706 - (Re-)joining group financial-document-processor
2025-05-10 10:10:56.644 | INFO     | logging:callHandlers:1706 - Mensagem processada em 224.88s: documento_id=9, tipo=bank_statement
2025-05-10 10:10:59.653 | INFO     | logging:callHandlers:1706 - Joined group 'financial-document-processor' (generation 49) with member_id aiokafka-0.12.0-6e1b876c-767f-4d75-9e5b-660c438d8ebf
2025-05-10 10:10:59.654 | INFO     | logging:callHandlers:1706 - Elected group leader -- performing partition assignments using roundrobin
2025-05-10 10:10:59.662 | ERROR    | logging:callHandlers:1706 - OffsetCommit failed for group financial-document-processor due to group error ([Error 22] IllegalGenerationError: financial-document-processor), will rejoin
2025-05-10 10:10:59.663 | ERROR    | logging:callHandlers:1706 - Erro ao processar mensagem: CommitFailedError: ('Commit cannot be completed since the group has already\n            rebalanced and assigned the partitions to another member.\n            This means that the time between subsequent calls to poll()\n            was longer than the configured max_poll_interval_ms, which\n            typically implies that the poll loop is spending too much\n            time message processing. You can address this either by\n            increasing the rebalance timeout with max_poll_interval_ms,\n            or by reducing the maximum size of batches returned in poll()\n            with max_poll_records.\n            ', 'Commit cannot be completed since the group has already rebalanced and may have assigned the partitions to another member')
2025-05-10 10:10:59.673 | INFO     | logging:callHandlers:1706 - Successfully synced group financial-document-processor with generation -1
2025-05-10 10:10:59.676 | INFO     | logging:callHandlers:1706 - Setting newly assigned partitions {TopicPartition(topic='documents-processing', partition=0)} for group financial-document-processor
2025-05-10 10:10:59.677 | INFO     | logging:callHandlers:1706 - Revoking previously assigned partitions frozenset({TopicPartition(topic='documents-processing', partition=0)}) for group financial-document-processor
2025-05-10 10:10:59.677 | INFO     | logging:callHandlers:1706 - (Re-)joining group financial-document-processor
2025-05-10 10:10:59.682 | INFO     | logging:callHandlers:1706 - Joined group 'financial-document-processor' (generation 50) with member_id aiokafka-0.12.0-6e1b876c-767f-4d75-9e5b-660c438d8ebf
2025-05-10 10:10:59.682 | INFO     | logging:callHandlers:1706 - Elected group leader -- performing partition assignments using roundrobin
2025-05-10 10:10:59.686 | INFO     | logging:callHandlers:1706 - Successfully synced group financial-document-processor with generation 50
2025-05-10 10:10:59.687 | INFO     | logging:callHandlers:1706 - Setting newly assigned partitions {TopicPartition(topic='documents-processing', partition=0)} for group financial-document-processor
2025-05-10 10:10:59.695 | INFO     | logging:callHandlers:1706 - Processando documento 9 do tipo bank_statement
2025-05-10 10:10:59.696 | WARNING  | logging:callHandlers:1706 - Documento 9 não encontrado para atualização de status
2025-05-10 10:10:59.697 | INFO     | logging:callHandlers:1706 - Iniciando processamento do documento 9 do tipo bank_statement para o usuário 2
2025-05-10 10:13:11.293 | INFO     | logging:callHandlers:1706 - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-05-10 10:13:11.302 | ERROR    | logging:callHandlers:1706 - Erro ao converter item para Transaction: 4 validation errors for Transaction
document_id
  Field required [type=missing, input_value={'date': '2025-04-29', 'd...10, 10, 13, 11, 302532)}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
user_id
  Field required [type=missing, input_value={'date': '2025-04-29', 'd...10, 10, 13, 11, 302532)}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
type
  Input should be 'credit' or 'debit' [type=enum, input_value='CREDIT', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/enum
method
  Input should be 'pix', 'ted', 'doc', 'boleto', 'payment', 'transfer', 'withdrawal', 'deposit', 'loan' or 'other' [type=enum, input_value='PIX', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/enum
2025-05-10 10:13:11.303 | ERROR    | logging:callHandlers:1706 - Erro ao converter item para Transaction: 4 validation errors for Transaction
document_id
  Field required [type=missing, input_value={'date': '2025-05-02', 'd...10, 10, 13, 11, 302983)}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
user_id
  Field required [type=missing, input_value={'date': '2025-05-02', 'd...10, 10, 13, 11, 302983)}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
type
  Input should be 'credit' or 'debit' [type=enum, input_value='DEBIT', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/enum
method
  Input should be 'pix', 'ted', 'doc', 'boleto', 'payment', 'transfer', 'withdrawal', 'deposit', 'loan' or 'other' [type=enum, input_value='PIX', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/enum
2025-05-10 10:13:11.303 | ERROR    | logging:callHandlers:1706 - Erro ao converter item para Transaction: 3 validation errors for Transaction
document_id
  Field required [type=missing, input_value={'date': '2025-05-02', 'd...10, 10, 13, 11, 303136)}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
user_id
  Field required [type=missing, input_value={'date': '2025-05-02', 'd...10, 10, 13, 11, 303136)}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
type
  Input should be 'credit' or 'debit' [type=enum, input_value='DEBIT', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/enum
2025-05-10 10:13:11.303 | ERROR    | logging:callHandlers:1706 - Erro ao converter item para Transaction: 3 validation errors for Transaction
document_id
  Field required [type=missing, input_value={'date': '2025-05-02', 'd...10, 10, 13, 11, 303718)}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
user_id
  Field required [type=missing, input_value={'date': '2025-05-02', 'd...10, 10, 13, 11, 303718)}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
type
  Input should be 'credit' or 'debit' [type=enum, input_value='DEBIT', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/enum
2025-05-10 10:13:11.303 | ERROR    | logging:callHandlers:1706 - Erro ao converter item para Transaction: 3 validation errors for Transaction
document_id
  Field required [type=missing, input_value={'date': '2025-05-02', 'd...10, 10, 13, 11, 303881)}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
user_id
  Field required [type=missing, input_value={'date': '2025-05-02', 'd...10, 10, 13, 11, 303881)}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
type
  Input should be 'credit' or 'debit' [type=enum, input_value='DEBIT', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/enum
2025-05-10 10:13:11.304 | ERROR    | logging:callHandlers:1706 - Erro ao converter item para Transaction: 4 validation errors for Transaction
document_id
  Field required [type=missing, input_value={'date': '2025-05-05', 'd...10, 10, 13, 11, 304015)}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
user_id
  Field required [type=missing, input_value={'date': '2025-05-05', 'd...10, 10, 13, 11, 304015)}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
type
  Input should be 'credit' or 'debit' [type=enum, input_value='CREDIT', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/enum
method
  Input should be 'pix', 'ted', 'doc', 'boleto', 'payment', 'transfer', 'withdrawal', 'deposit', 'loan' or 'other' [type=enum, input_value='PIX', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/enum
2025-05-10 10:13:11.304 | ERROR    | logging:callHandlers:1706 - Erro ao converter item para Transaction: 4 validation errors for Transaction
document_id
  Field required [type=missing, input_value={'date': '2025-05-05', 'd...10, 10, 13, 11, 304527)}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
user_id
  Field required [type=missing, input_value={'date': '2025-05-05', 'd...10, 10, 13, 11, 304527)}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
type
  Input should be 'credit' or 'debit' [type=enum, input_value='DEBIT', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/enum
method
  Input should be 'pix', 'ted', 'doc', 'boleto', 'payment', 'transfer', 'withdrawal', 'deposit', 'loan' or 'other' [type=enum, input_value='PIX', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/enum
2025-05-10 10:13:11.304 | ERROR    | logging:callHandlers:1706 - Erro ao converter item para Transaction: 4 validation errors for Transaction
document_id
  Field required [type=missing, input_value={'date': '2025-05-05', 'd...10, 10, 13, 11, 304647)}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
user_id
  Field required [type=missing, input_value={'date': '2025-05-05', 'd...10, 10, 13, 11, 304647)}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
type
  Input should be 'credit' or 'debit' [type=enum, input_value='DEBIT', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/enum
method
  Input should be 'pix', 'ted', 'doc', 'boleto', 'payment', 'transfer', 'withdrawal', 'deposit', 'loan' or 'other' [type=enum, input_value='PIX', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/enum
2025-05-10 10:13:11.304 | ERROR    | logging:callHandlers:1706 - Erro ao converter item para Transaction: 4 validation errors for Transaction
document_id
  Field required [type=missing, input_value={'date': '2025-05-05', 'd...10, 10, 13, 11, 304770)}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
user_id
  Field required [type=missing, input_value={'date': '2025-05-05', 'd...10, 10, 13, 11, 304770)}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
type
  Input should be 'credit' or 'debit' [type=enum, input_value='DEBIT', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/enum
method
  Input should be 'pix', 'ted', 'doc', 'boleto', 'payment', 'transfer', 'withdrawal', 'deposit', 'loan' or 'other' [type=enum, input_value='PIX', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/enum
2025-05-10 10:13:11.304 | ERROR    | logging:callHandlers:1706 - Erro ao converter item para Transaction: 3 validation errors for Transaction
document_id
  Field required [type=missing, input_value={'date': '2025-05-05', 'd...10, 10, 13, 11, 304878)}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
user_id
  Field required [type=missing, input_value={'date': '2025-05-05', 'd...10, 10, 13, 11, 304878)}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
type
  Input should be 'credit' or 'debit' [type=enum, input_value='CREDIT', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/enum
2025-05-10 10:13:11.305 | ERROR    | logging:callHandlers:1706 - Erro ao converter item para Transaction: 4 validation errors for Transaction
document_id
  Field required [type=missing, input_value={'date': '2025-05-06', 'd...10, 10, 13, 11, 304997)}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
user_id
  Field required [type=missing, input_value={'date': '2025-05-06', 'd...10, 10, 13, 11, 304997)}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
type
  Input should be 'credit' or 'debit' [type=enum, input_value='CREDIT', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/enum
method
  Input should be 'pix', 'ted', 'doc', 'boleto', 'payment', 'transfer', 'withdrawal', 'deposit', 'loan' or 'other' [type=enum, input_value='PIX', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/enum
2025-05-10 10:13:11.305 | ERROR    | logging:callHandlers:1706 - Erro ao converter item para Transaction: 4 validation errors for Transaction
document_id
  Field required [type=missing, input_value={'date': '2025-05-06', 'd...10, 10, 13, 11, 305109)}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
user_id
  Field required [type=missing, input_value={'date': '2025-05-06', 'd...10, 10, 13, 11, 305109)}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
type
  Input should be 'credit' or 'debit' [type=enum, input_value='DEBIT', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/enum
method
  Input should be 'pix', 'ted', 'doc', 'boleto', 'payment', 'transfer', 'withdrawal', 'deposit', 'loan' or 'other' [type=enum, input_value='PIX', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/enum
2025-05-10 10:13:11.305 | ERROR    | logging:callHandlers:1706 - Erro ao converter item para Transaction: 3 validation errors for Transaction
document_id
  Field required [type=missing, input_value={'date': '2025-05-06', 'd...10, 10, 13, 11, 305221)}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
user_id
  Field required [type=missing, input_value={'date': '2025-05-06', 'd...10, 10, 13, 11, 305221)}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
type
  Input should be 'credit' or 'debit' [type=enum, input_value='DEBIT', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/enum
2025-05-10 10:13:11.305 | ERROR    | logging:callHandlers:1706 - Erro ao converter item para Transaction: 4 validation errors for Transaction
document_id
  Field required [type=missing, input_value={'date': '2025-05-06', 'd...10, 10, 13, 11, 305353)}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
user_id
  Field required [type=missing, input_value={'date': '2025-05-06', 'd...10, 10, 13, 11, 305353)}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
type
  Input should be 'credit' or 'debit' [type=enum, input_value='DEBIT', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/enum
method
  Input should be 'pix', 'ted', 'doc', 'boleto', 'payment', 'transfer', 'withdrawal', 'deposit', 'loan' or 'other' [type=enum, input_value='DEPÓSITO', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/enum
2025-05-10 10:13:11.305 | ERROR    | logging:callHandlers:1706 - Erro ao converter item para Transaction: 3 validation errors for Transaction
document_id
  Field required [type=missing, input_value={'date': '2025-05-06', 'd...10, 10, 13, 11, 305475)}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
user_id
  Field required [type=missing, input_value={'date': '2025-05-06', 'd...10, 10, 13, 11, 305475)}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
type
  Input should be 'credit' or 'debit' [type=enum, input_value='DEBIT', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/enum
2025-05-10 10:13:11.305 | ERROR    | logging:callHandlers:1706 - Erro ao converter item para Transaction: 4 validation errors for Transaction
document_id
  Field required [type=missing, input_value={'date': '2025-05-06', 'd...10, 10, 13, 11, 305600)}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
user_id
  Field required [type=missing, input_value={'date': '2025-05-06', 'd...10, 10, 13, 11, 305600)}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
type
  Input should be 'credit' or 'debit' [type=enum, input_value='DEBIT', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/enum
method
  Input should be 'pix', 'ted', 'doc', 'boleto', 'payment', 'transfer', 'withdrawal', 'deposit', 'loan' or 'other' [type=enum, input_value='PIX', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/enum
2025-05-10 10:13:11.305 | ERROR    | logging:callHandlers:1706 - Erro ao converter item para Transaction: 4 validation errors for Transaction
document_id
  Field required [type=missing, input_value={'date': '2025-05-06', 'd...10, 10, 13, 11, 305721)}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
user_id
  Field required [type=missing, input_value={'date': '2025-05-06', 'd...10, 10, 13, 11, 305721)}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
type
  Input should be 'credit' or 'debit' [type=enum, input_value='DEBIT', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/enum
method
  Input should be 'pix', 'ted', 'doc', 'boleto', 'payment', 'transfer', 'withdrawal', 'deposit', 'loan' or 'other' [type=enum, input_value='PIX', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/enum
2025-05-10 10:13:11.306 | ERROR    | logging:callHandlers:1706 - Erro ao converter item para Transaction: 4 validation errors for Transaction
document_id
  Field required [type=missing, input_value={'date': '2025-05-06', 'd...10, 10, 13, 11, 305840)}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
user_id
  Field required [type=missing, input_value={'date': '2025-05-06', 'd...10, 10, 13, 11, 305840)}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
type
  Input should be 'credit' or 'debit' [type=enum, input_value='DEBIT', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/enum
method
  Input should be 'pix', 'ted', 'doc', 'boleto', 'payment', 'transfer', 'withdrawal', 'deposit', 'loan' or 'other' [type=enum, input_value='PIX', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/enum
2025-05-10 10:13:11.306 | ERROR    | logging:callHandlers:1706 - Erro ao converter item para Transaction: 4 validation errors for Transaction
document_id
  Field required [type=missing, input_value={'date': '2025-05-06', 'd...10, 10, 13, 11, 306285)}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
user_id
  Field required [type=missing, input_value={'date': '2025-05-06', 'd...10, 10, 13, 11, 306285)}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
type
  Input should be 'credit' or 'debit' [type=enum, input_value='CREDIT', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/enum
method
  Input should be 'pix', 'ted', 'doc', 'boleto', 'payment', 'transfer', 'withdrawal', 'deposit', 'loan' or 'other' [type=enum, input_value='PIX', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/enum
2025-05-10 10:13:11.306 | ERROR    | logging:callHandlers:1706 - Erro ao converter item para Transaction: 4 validation errors for Transaction
document_id
  Field required [type=missing, input_value={'date': '2025-05-07', 'd...10, 10, 13, 11, 306440)}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
user_id
  Field required [type=missing, input_value={'date': '2025-05-07', 'd...10, 10, 13, 11, 306440)}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
type
  Input should be 'credit' or 'debit' [type=enum, input_value='CREDIT', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/enum
method
  Input should be 'pix', 'ted', 'doc', 'boleto', 'payment', 'transfer', 'withdrawal', 'deposit', 'loan' or 'other' [type=enum, input_value='TRANSFERÊNCIA', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/enum
2025-05-10 10:13:11.306 | ERROR    | logging:callHandlers:1706 - Erro ao converter item para Transaction: 4 validation errors for Transaction
document_id
  Field required [type=missing, input_value={'date': '2025-05-08', 'd...10, 10, 13, 11, 306583)}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
user_id
  Field required [type=missing, input_value={'date': '2025-05-08', 'd...10, 10, 13, 11, 306583)}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
type
  Input should be 'credit' or 'debit' [type=enum, input_value='CREDIT', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/enum
method
  Input should be 'pix', 'ted', 'doc', 'boleto', 'payment', 'transfer', 'withdrawal', 'deposit', 'loan' or 'other' [type=enum, input_value='TRANSFERÊNCIA', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/enum
2025-05-10 10:13:11.306 | ERROR    | logging:callHandlers:1706 - Erro ao converter item para Transaction: 4 validation errors for Transaction
document_id
  Field required [type=missing, input_value={'date': '2025-05-09', 'd...10, 10, 13, 11, 306705)}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
user_id
  Field required [type=missing, input_value={'date': '2025-05-09', 'd...10, 10, 13, 11, 306705)}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
type
  Input should be 'credit' or 'debit' [type=enum, input_value='DEBIT', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/enum
method
  Input should be 'pix', 'ted', 'doc', 'boleto', 'payment', 'transfer', 'withdrawal', 'deposit', 'loan' or 'other' [type=enum, input_value='PIX', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/enum
2025-05-10 10:13:11.307 | WARNING  | logging:callHandlers:1706 - Nenhuma transação extraída do documento 9
2025-05-10 10:13:11.307 | WARNING  | logging:callHandlers:1706 - Nenhuma transação extraída do documento 9
2025-05-10 10:13:11.336 | WARNING  | logging:callHandlers:1706 - Heartbeat failed: local member_id was not recognized; resetting and re-joining group
2025-05-10 10:13:11.336 | ERROR    | logging:callHandlers:1706 - Heartbeat session expired - marking coordinator dead
2025-05-10 10:13:11.336 | WARNING  | logging:callHandlers:1706 - Marking the coordinator dead (node 1)for group financial-document-processor.
2025-05-10 10:13:11.338 | WARNING  | logging:callHandlers:1706 - Documento 9 não encontrado para atualização de status
2025-05-10 10:13:11.340 | INFO     | logging:callHandlers:1706 - Discovered coordinator 1 for group financial-document-processor
2025-05-10 10:13:11.340 | INFO     | logging:callHandlers:1706 - Revoking previously assigned partitions frozenset({TopicPartition(topic='documents-processing', partition=0)}) for group financial-document-processor
2025-05-10 10:13:11.340 | INFO     | logging:callHandlers:1706 - (Re-)joining group financial-document-processor
2025-05-10 10:13:11.353 | INFO     | logging:callHandlers:1706 - Mensagem processada em 131.66s: documento_id=9, tipo=bank_statement
2025-05-10 10:13:14.355 | INFO     | logging:callHandlers:1706 - Joined group 'financial-document-processor' (generation 52) with member_id aiokafka-0.12.0-95b5fd3f-7a62-41db-a324-a008b2db8b60
2025-05-10 10:13:14.355 | INFO     | logging:callHandlers:1706 - Elected group leader -- performing partition assignments using roundrobin
2025-05-10 10:13:14.358 | ERROR    | logging:callHandlers:1706 - OffsetCommit failed for group financial-document-processor due to group error ([Error 22] IllegalGenerationError: financial-document-processor), will rejoin
2025-05-10 10:13:14.359 | ERROR    | logging:callHandlers:1706 - Erro ao processar mensagem: CommitFailedError: ('Commit cannot be completed since the group has already\n            rebalanced and assigned the partitions to another member.\n            This means that the time between subsequent calls to poll()\n            was longer than the configured max_poll_interval_ms, which\n            typically implies that the poll loop is spending too much\n            time message processing. You can address this either by\n            increasing the rebalance timeout with max_poll_interval_ms,\n            or by reducing the maximum size of batches returned in poll()\n            with max_poll_records.\n            ', 'Commit cannot be completed since the group has already rebalanced and may have assigned the partitions to another member')
2025-05-10 10:13:14.362 | INFO     | logging:callHandlers:1706 - Successfully synced group financial-document-processor with generation -1
2025-05-10 10:13:14.365 | INFO     | logging:callHandlers:1706 - Setting newly assigned partitions {TopicPartition(topic='documents-processing', partition=0)} for group financial-document-processor
2025-05-10 10:13:14.367 | INFO     | logging:callHandlers:1706 - Revoking previously assigned partitions frozenset({TopicPartition(topic='documents-processing', partition=0)}) for group financial-document-processor
2025-05-10 10:13:14.368 | INFO     | logging:callHandlers:1706 - (Re-)joining group financial-document-processor
2025-05-10 10:13:14.372 | INFO     | logging:callHandlers:1706 - Joined group 'financial-document-processor' (generation 53) with member_id aiokafka-0.12.0-95b5fd3f-7a62-41db-a324-a008b2db8b60
2025-05-10 10:13:14.373 | INFO     | logging:callHandlers:1706 - Elected group leader -- performing partition assignments using roundrobin
2025-05-10 10:13:14.375 | INFO     | logging:callHandlers:1706 - Successfully synced group financial-document-processor with generation 53
2025-05-10 10:13:14.376 | INFO     | logging:callHandlers:1706 - Setting newly assigned partitions {TopicPartition(topic='documents-processing', partition=0)} for group financial-document-processor
2025-05-10 10:13:14.384 | INFO     | logging:callHandlers:1706 - Processando documento 9 do tipo bank_statement
2025-05-10 10:13:14.388 | WARNING  | logging:callHandlers:1706 - Documento 9 não encontrado para atualização de status
2025-05-10 10:13:14.389 | INFO     | logging:callHandlers:1706 - Iniciando processamento do documento 9 do tipo bank_statement para o usuário 2
2025-05-10 10:13:28.550 | INFO     | logging:callHandlers:1706 - Sinal 2 recebido, iniciando desligamento...
2025-05-10 10:36:12.975 | INFO     | financial_document_processor.utils.logging:setup_logging:69 - Sistema de logging configurado com nível INFO
2025-05-10 10:36:12.999 | INFO     | logging:callHandlers:1706 - Inicializando aplicação...
2025-05-10 10:36:13.235 | INFO     | logging:callHandlers:1706 - Conexão estabelecida com o PostgreSQL. Pool criado com 5-20 conexões.
2025-05-10 10:36:13.243 | INFO     | logging:callHandlers:1706 - Esquema do banco de dados verificado/criado com sucesso
2025-05-10 10:36:13.263 | INFO     | logging:callHandlers:1706 - Produtor Kafka iniciado
2025-05-10 10:36:13.295 | INFO     | logging:callHandlers:1706 - Usando provedor de IA: claude
2025-05-10 10:36:13.296 | INFO     | logging:callHandlers:1706 - Carregadas 61 categorias padrão
2025-05-10 10:36:13.296 | INFO     | logging:callHandlers:1706 - Serviço de categorização inicializado
2025-05-10 10:36:13.297 | INFO     | logging:callHandlers:1706 - Updating subscribed topics to: frozenset({'documents-processing'})
2025-05-10 10:36:13.324 | INFO     | logging:callHandlers:1706 - Discovered coordinator 1 for group financial-document-processor
2025-05-10 10:36:13.324 | INFO     | logging:callHandlers:1706 - Revoking previously assigned partitions set() for group financial-document-processor
2025-05-10 10:36:13.324 | INFO     | logging:callHandlers:1706 - (Re-)joining group financial-document-processor
2025-05-10 10:36:16.344 | INFO     | logging:callHandlers:1706 - Joined group 'financial-document-processor' (generation 55) with member_id aiokafka-0.12.0-6c59ada4-e692-43df-bdfa-07f21658fe8f
2025-05-10 10:36:16.345 | INFO     | logging:callHandlers:1706 - Elected group leader -- performing partition assignments using roundrobin
2025-05-10 10:36:16.362 | INFO     | logging:callHandlers:1706 - Successfully synced group financial-document-processor with generation 55
2025-05-10 10:36:16.366 | INFO     | logging:callHandlers:1706 - Setting newly assigned partitions {TopicPartition(topic='documents-processing', partition=0)} for group financial-document-processor
2025-05-10 10:36:16.367 | INFO     | logging:callHandlers:1706 - Consumidor Kafka iniciado para o tópico documents-processing
2025-05-10 10:36:16.367 | INFO     | logging:callHandlers:1706 - Aplicação inicializada com sucesso
2025-05-10 10:36:16.367 | INFO     | logging:callHandlers:1706 - Aplicação em execução
2025-05-10 10:36:16.380 | INFO     | logging:callHandlers:1706 - Processando documento 9 do tipo bank_statement
2025-05-10 10:36:16.383 | ERROR    | logging:callHandlers:1706 - Erro ao processar documento 9: 1 validation error for Document
status
  Instance is frozen [type=frozen_instance, input_value='PROCESSING', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/frozen_instance
2025-05-10 10:36:16.425 | WARNING  | logging:callHandlers:1706 - Documento 9 não encontrado para atualização de status
2025-05-10 10:36:16.439 | INFO     | logging:callHandlers:1706 - Mensagem processada em 0.06s: documento_id=9, tipo=bank_statement
2025-05-10 10:36:48.451 | INFO     | logging:callHandlers:1706 - Processando documento 10 do tipo bank_statement
2025-05-10 10:36:48.452 | ERROR    | logging:callHandlers:1706 - Erro ao processar documento 10: 1 validation error for Document
status
  Instance is frozen [type=frozen_instance, input_value='PROCESSING', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/frozen_instance
2025-05-10 10:36:48.462 | WARNING  | logging:callHandlers:1706 - Documento 10 não encontrado para atualização de status
2025-05-10 10:36:48.607 | INFO     | logging:callHandlers:1706 - Mensagem processada em 0.16s: documento_id=10, tipo=bank_statement
2025-05-10 10:38:39.572 | INFO     | logging:callHandlers:1706 - Processando documento 11 do tipo bank_statement
2025-05-10 10:38:49.729 | ERROR    | logging:callHandlers:1706 - Erro ao processar documento 11: 1 validation error for Document
status
  Instance is frozen [type=frozen_instance, input_value='PROCESSING', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/frozen_instance
2025-05-10 10:38:49.746 | WARNING  | logging:callHandlers:1706 - Documento 11 não encontrado para atualização de status
2025-05-10 10:38:49.749 | WARNING  | logging:callHandlers:1706 - Heartbeat failed: local member_id was not recognized; resetting and re-joining group
2025-05-10 10:38:49.750 | ERROR    | logging:callHandlers:1706 - Heartbeat session expired - marking coordinator dead
2025-05-10 10:38:49.750 | WARNING  | logging:callHandlers:1706 - Marking the coordinator dead (node 1)for group financial-document-processor.
2025-05-10 10:38:49.754 | INFO     | logging:callHandlers:1706 - Discovered coordinator 1 for group financial-document-processor
2025-05-10 10:38:49.754 | INFO     | logging:callHandlers:1706 - Revoking previously assigned partitions frozenset({TopicPartition(topic='documents-processing', partition=0)}) for group financial-document-processor
2025-05-10 10:38:49.754 | INFO     | logging:callHandlers:1706 - (Re-)joining group financial-document-processor
2025-05-10 10:38:49.761 | INFO     | logging:callHandlers:1706 - Mensagem processada em 35.43s: documento_id=11, tipo=bank_statement
2025-05-10 10:38:52.343 | INFO     | logging:callHandlers:1706 - Sinal 2 recebido, iniciando desligamento...
2025-05-10 10:38:52.363 | INFO     | logging:callHandlers:1706 - Iniciando desligamento da aplicação...
2025-05-10 10:38:52.364 | INFO     | logging:callHandlers:1706 - Tarefa de consumo cancelada
2025-05-10 10:39:20.893 | INFO     | financial_document_processor.utils.logging:setup_logging:69 - Sistema de logging configurado com nível INFO
2025-05-10 10:39:20.910 | INFO     | logging:callHandlers:1706 - Inicializando aplicação...
2025-05-10 10:39:21.099 | INFO     | logging:callHandlers:1706 - Conexão estabelecida com o PostgreSQL. Pool criado com 5-20 conexões.
2025-05-10 10:39:21.121 | INFO     | logging:callHandlers:1706 - Esquema do banco de dados verificado/criado com sucesso
2025-05-10 10:39:21.154 | INFO     | logging:callHandlers:1706 - Produtor Kafka iniciado
2025-05-10 10:39:21.188 | INFO     | logging:callHandlers:1706 - Usando provedor de IA: claude
2025-05-10 10:39:21.189 | INFO     | logging:callHandlers:1706 - Carregadas 61 categorias padrão
2025-05-10 10:39:21.189 | INFO     | logging:callHandlers:1706 - Serviço de categorização inicializado
2025-05-10 10:39:21.190 | INFO     | logging:callHandlers:1706 - Updating subscribed topics to: frozenset({'documents-processing'})
2025-05-10 10:39:21.210 | INFO     | logging:callHandlers:1706 - Discovered coordinator 1 for group financial-document-processor
2025-05-10 10:39:21.210 | INFO     | logging:callHandlers:1706 - Revoking previously assigned partitions set() for group financial-document-processor
2025-05-10 10:39:21.210 | INFO     | logging:callHandlers:1706 - (Re-)joining group financial-document-processor
2025-05-10 10:39:24.223 | INFO     | logging:callHandlers:1706 - Joined group 'financial-document-processor' (generation 59) with member_id aiokafka-0.12.0-704aa048-7ed2-42ae-be23-4d1d461a3f52
2025-05-10 10:39:24.223 | INFO     | logging:callHandlers:1706 - Elected group leader -- performing partition assignments using roundrobin
2025-05-10 10:39:24.233 | INFO     | logging:callHandlers:1706 - Successfully synced group financial-document-processor with generation 59
2025-05-10 10:39:24.235 | INFO     | logging:callHandlers:1706 - Setting newly assigned partitions {TopicPartition(topic='documents-processing', partition=0)} for group financial-document-processor
2025-05-10 10:39:24.235 | INFO     | logging:callHandlers:1706 - Consumidor Kafka iniciado para o tópico documents-processing
2025-05-10 10:39:24.235 | INFO     | logging:callHandlers:1706 - Aplicação inicializada com sucesso
2025-05-10 10:39:24.236 | INFO     | logging:callHandlers:1706 - Aplicação em execução
2025-05-10 10:39:24.249 | INFO     | logging:callHandlers:1706 - Processando documento 11 do tipo bank_statement
2025-05-10 10:39:24.250 | ERROR    | logging:callHandlers:1706 - Erro ao processar documento 11: 1 validation error for Document
status
  Instance is frozen [type=frozen_instance, input_value=<DocumentStatus.PROCESSING: 'processing'>, input_type=DocumentStatus]
    For further information visit https://errors.pydantic.dev/2.11/v/frozen_instance
2025-05-10 10:39:24.284 | WARNING  | logging:callHandlers:1706 - Documento 11 não encontrado para atualização de status
2025-05-10 10:39:24.298 | INFO     | logging:callHandlers:1706 - Mensagem processada em 0.05s: documento_id=11, tipo=bank_statement
2025-05-10 10:39:32.691 | INFO     | logging:callHandlers:1706 - Sinal 2 recebido, iniciando desligamento...
2025-05-10 10:39:32.833 | INFO     | logging:callHandlers:1706 - Iniciando desligamento da aplicação...
2025-05-10 10:39:32.834 | INFO     | logging:callHandlers:1706 - Tarefa de consumo cancelada
2025-05-10 10:39:35.546 | INFO     | financial_document_processor.utils.logging:setup_logging:69 - Sistema de logging configurado com nível INFO
2025-05-10 10:39:35.556 | INFO     | logging:callHandlers:1706 - Inicializando aplicação...
2025-05-10 10:39:35.722 | INFO     | logging:callHandlers:1706 - Conexão estabelecida com o PostgreSQL. Pool criado com 5-20 conexões.
2025-05-10 10:39:35.727 | INFO     | logging:callHandlers:1706 - Esquema do banco de dados verificado/criado com sucesso
2025-05-10 10:39:35.762 | INFO     | logging:callHandlers:1706 - Produtor Kafka iniciado
2025-05-10 10:39:35.796 | INFO     | logging:callHandlers:1706 - Usando provedor de IA: claude
2025-05-10 10:39:35.797 | INFO     | logging:callHandlers:1706 - Carregadas 61 categorias padrão
2025-05-10 10:39:35.797 | INFO     | logging:callHandlers:1706 - Serviço de categorização inicializado
2025-05-10 10:39:35.798 | INFO     | logging:callHandlers:1706 - Updating subscribed topics to: frozenset({'documents-processing'})
2025-05-10 10:39:35.817 | INFO     | logging:callHandlers:1706 - Discovered coordinator 1 for group financial-document-processor
2025-05-10 10:39:35.817 | INFO     | logging:callHandlers:1706 - Revoking previously assigned partitions set() for group financial-document-processor
2025-05-10 10:39:35.817 | INFO     | logging:callHandlers:1706 - (Re-)joining group financial-document-processor
2025-05-10 10:39:38.830 | INFO     | logging:callHandlers:1706 - Joined group 'financial-document-processor' (generation 61) with member_id aiokafka-0.12.0-1bb76fbd-dc8e-420c-8e91-65e3d112daa0
2025-05-10 10:39:38.830 | INFO     | logging:callHandlers:1706 - Elected group leader -- performing partition assignments using roundrobin
2025-05-10 10:39:38.838 | INFO     | logging:callHandlers:1706 - Successfully synced group financial-document-processor with generation 61
2025-05-10 10:39:38.840 | INFO     | logging:callHandlers:1706 - Setting newly assigned partitions {TopicPartition(topic='documents-processing', partition=0)} for group financial-document-processor
2025-05-10 10:39:38.840 | INFO     | logging:callHandlers:1706 - Consumidor Kafka iniciado para o tópico documents-processing
2025-05-10 10:39:38.840 | INFO     | logging:callHandlers:1706 - Aplicação inicializada com sucesso
2025-05-10 10:39:38.840 | INFO     | logging:callHandlers:1706 - Aplicação em execução
2025-05-10 10:39:58.568 | INFO     | logging:callHandlers:1706 - Processando documento 12 do tipo bank_statement
2025-05-10 10:40:01.630 | ERROR    | logging:callHandlers:1706 - Erro ao processar documento 12: 1 validation error for Document
status
  Instance is frozen [type=frozen_instance, input_value='processing', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/frozen_instance
2025-05-10 10:40:01.653 | WARNING  | logging:callHandlers:1706 - Heartbeat failed: local member_id was not recognized; resetting and re-joining group
2025-05-10 10:40:01.654 | ERROR    | logging:callHandlers:1706 - Heartbeat session expired - marking coordinator dead
2025-05-10 10:40:01.654 | WARNING  | logging:callHandlers:1706 - Marking the coordinator dead (node 1)for group financial-document-processor.
2025-05-10 10:40:01.660 | INFO     | logging:callHandlers:1706 - Discovered coordinator 1 for group financial-document-processor
2025-05-10 10:40:01.660 | INFO     | logging:callHandlers:1706 - Revoking previously assigned partitions frozenset({TopicPartition(topic='documents-processing', partition=0)}) for group financial-document-processor
2025-05-10 10:40:01.661 | INFO     | logging:callHandlers:1706 - (Re-)joining group financial-document-processor
2025-05-10 10:40:01.720 | WARNING  | logging:callHandlers:1706 - Documento 12 não encontrado para atualização de status
2025-05-10 10:40:01.742 | INFO     | logging:callHandlers:1706 - Mensagem processada em 11.14s: documento_id=12, tipo=bank_statement
2025-05-10 10:40:04.676 | INFO     | logging:callHandlers:1706 - Joined group 'financial-document-processor' (generation 63) with member_id aiokafka-0.12.0-b4c07bda-1613-4b45-b901-a7cb1df65e1a
2025-05-10 10:40:04.677 | INFO     | logging:callHandlers:1706 - Elected group leader -- performing partition assignments using roundrobin
2025-05-10 10:40:04.679 | ERROR    | logging:callHandlers:1706 - OffsetCommit failed for group financial-document-processor due to group error ([Error 22] IllegalGenerationError: financial-document-processor), will rejoin
2025-05-10 10:40:04.680 | ERROR    | logging:callHandlers:1706 - Erro ao processar mensagem: CommitFailedError: ('Commit cannot be completed since the group has already\n            rebalanced and assigned the partitions to another member.\n            This means that the time between subsequent calls to poll()\n            was longer than the configured max_poll_interval_ms, which\n            typically implies that the poll loop is spending too much\n            time message processing. You can address this either by\n            increasing the rebalance timeout with max_poll_interval_ms,\n            or by reducing the maximum size of batches returned in poll()\n            with max_poll_records.\n            ', 'Commit cannot be completed since the group has already rebalanced and may have assigned the partitions to another member')
2025-05-10 10:40:04.683 | INFO     | logging:callHandlers:1706 - Successfully synced group financial-document-processor with generation -1
2025-05-10 10:40:04.686 | INFO     | logging:callHandlers:1706 - Setting newly assigned partitions {TopicPartition(topic='documents-processing', partition=0)} for group financial-document-processor
2025-05-10 10:40:04.687 | INFO     | logging:callHandlers:1706 - Revoking previously assigned partitions frozenset({TopicPartition(topic='documents-processing', partition=0)}) for group financial-document-processor
2025-05-10 10:40:04.687 | INFO     | logging:callHandlers:1706 - (Re-)joining group financial-document-processor
2025-05-10 10:40:04.691 | INFO     | logging:callHandlers:1706 - Joined group 'financial-document-processor' (generation 64) with member_id aiokafka-0.12.0-b4c07bda-1613-4b45-b901-a7cb1df65e1a
2025-05-10 10:40:04.691 | INFO     | logging:callHandlers:1706 - Elected group leader -- performing partition assignments using roundrobin
2025-05-10 10:40:04.695 | INFO     | logging:callHandlers:1706 - Successfully synced group financial-document-processor with generation 64
2025-05-10 10:40:04.696 | INFO     | logging:callHandlers:1706 - Setting newly assigned partitions {TopicPartition(topic='documents-processing', partition=0)} for group financial-document-processor
2025-05-10 10:40:04.702 | INFO     | logging:callHandlers:1706 - Processando documento 12 do tipo bank_statement
2025-05-10 10:40:04.703 | ERROR    | logging:callHandlers:1706 - Erro ao processar documento 12: 1 validation error for Document
status
  Instance is frozen [type=frozen_instance, input_value='processing', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/frozen_instance
2025-05-10 10:40:04.704 | WARNING  | logging:callHandlers:1706 - Documento 12 não encontrado para atualização de status
2025-05-10 10:40:04.709 | INFO     | logging:callHandlers:1706 - Mensagem processada em 0.01s: documento_id=12, tipo=bank_statement
2025-05-10 10:40:13.701 | INFO     | logging:callHandlers:1706 - Sinal 2 recebido, iniciando desligamento...
2025-05-10 10:40:13.704 | INFO     | logging:callHandlers:1706 - Iniciando desligamento da aplicação...
2025-05-10 10:40:13.705 | INFO     | logging:callHandlers:1706 - Tarefa de consumo cancelada
2025-05-10 10:40:13.723 | INFO     | logging:callHandlers:1706 - LeaveGroup request succeeded
2025-05-10 10:40:13.726 | INFO     | logging:callHandlers:1706 - Consumidor Kafka parado
2025-05-10 10:40:13.727 | INFO     | logging:callHandlers:1706 - Produtor Kafka parado
2025-05-10 10:40:13.737 | INFO     | logging:callHandlers:1706 - Conexão com PostgreSQL encerrada
2025-05-10 10:40:13.738 | INFO     | logging:callHandlers:1706 - Aplicação desligada com sucesso
2025-05-10 10:40:16.329 | INFO     | financial_document_processor.utils.logging:setup_logging:69 - Sistema de logging configurado com nível INFO
2025-05-10 10:40:16.337 | INFO     | logging:callHandlers:1706 - Inicializando aplicação...
2025-05-10 10:40:16.512 | INFO     | logging:callHandlers:1706 - Conexão estabelecida com o PostgreSQL. Pool criado com 5-20 conexões.
2025-05-10 10:40:16.516 | INFO     | logging:callHandlers:1706 - Esquema do banco de dados verificado/criado com sucesso
2025-05-10 10:40:16.538 | INFO     | logging:callHandlers:1706 - Produtor Kafka iniciado
2025-05-10 10:40:16.571 | INFO     | logging:callHandlers:1706 - Usando provedor de IA: claude
2025-05-10 10:40:16.572 | INFO     | logging:callHandlers:1706 - Carregadas 61 categorias padrão
2025-05-10 10:40:16.572 | INFO     | logging:callHandlers:1706 - Serviço de categorização inicializado
2025-05-10 10:40:16.573 | INFO     | logging:callHandlers:1706 - Updating subscribed topics to: frozenset({'documents-processing'})
2025-05-10 10:40:16.597 | INFO     | logging:callHandlers:1706 - Discovered coordinator 1 for group financial-document-processor
2025-05-10 10:40:16.597 | INFO     | logging:callHandlers:1706 - Revoking previously assigned partitions set() for group financial-document-processor
2025-05-10 10:40:16.597 | INFO     | logging:callHandlers:1706 - (Re-)joining group financial-document-processor
2025-05-10 10:40:19.605 | INFO     | logging:callHandlers:1706 - Joined group 'financial-document-processor' (generation 66) with member_id aiokafka-0.12.0-3a032c0a-8849-4195-bdb7-1c217f9f380c
2025-05-10 10:40:19.605 | INFO     | logging:callHandlers:1706 - Elected group leader -- performing partition assignments using roundrobin
2025-05-10 10:40:19.613 | INFO     | logging:callHandlers:1706 - Successfully synced group financial-document-processor with generation 66
2025-05-10 10:40:19.615 | INFO     | logging:callHandlers:1706 - Setting newly assigned partitions {TopicPartition(topic='documents-processing', partition=0)} for group financial-document-processor
2025-05-10 10:40:19.615 | INFO     | logging:callHandlers:1706 - Consumidor Kafka iniciado para o tópico documents-processing
2025-05-10 10:40:19.616 | INFO     | logging:callHandlers:1706 - Aplicação inicializada com sucesso
2025-05-10 10:40:19.616 | INFO     | logging:callHandlers:1706 - Aplicação em execução
2025-05-10 10:40:33.257 | INFO     | logging:callHandlers:1706 - Processando documento 13 do tipo bank_statement
2025-05-10 10:41:01.430 | ERROR    | logging:callHandlers:1706 - Erro ao processar documento 13: 1 validation error for Document
status
  Instance is frozen [type=frozen_instance, input_value=<DocumentStatus.PROCESSING: 'processing'>, input_type=DocumentStatus]
    For further information visit https://errors.pydantic.dev/2.11/v/frozen_instance
2025-05-10 10:41:01.441 | WARNING  | logging:callHandlers:1706 - Heartbeat failed: local member_id was not recognized; resetting and re-joining group
2025-05-10 10:41:01.441 | ERROR    | logging:callHandlers:1706 - Heartbeat session expired - marking coordinator dead
2025-05-10 10:41:01.441 | WARNING  | logging:callHandlers:1706 - Marking the coordinator dead (node 1)for group financial-document-processor.
2025-05-10 10:41:01.445 | INFO     | logging:callHandlers:1706 - Discovered coordinator 1 for group financial-document-processor
2025-05-10 10:41:01.446 | INFO     | logging:callHandlers:1706 - Revoking previously assigned partitions frozenset({TopicPartition(topic='documents-processing', partition=0)}) for group financial-document-processor
2025-05-10 10:41:01.446 | INFO     | logging:callHandlers:1706 - (Re-)joining group financial-document-processor
2025-05-10 10:41:01.479 | WARNING  | logging:callHandlers:1706 - Documento 13 não encontrado para atualização de status
2025-05-10 10:41:01.492 | INFO     | logging:callHandlers:1706 - Mensagem processada em 28.24s: documento_id=13, tipo=bank_statement
2025-05-10 10:41:04.467 | INFO     | logging:callHandlers:1706 - Joined group 'financial-document-processor' (generation 68) with member_id aiokafka-0.12.0-4dda59ac-c9b7-49fa-aca8-15f876dd78f4
2025-05-10 10:41:04.467 | INFO     | logging:callHandlers:1706 - Elected group leader -- performing partition assignments using roundrobin
2025-05-10 10:41:04.469 | ERROR    | logging:callHandlers:1706 - OffsetCommit failed for group financial-document-processor due to group error ([Error 22] IllegalGenerationError: financial-document-processor), will rejoin
2025-05-10 10:41:04.470 | ERROR    | logging:callHandlers:1706 - Erro ao processar mensagem: CommitFailedError: ('Commit cannot be completed since the group has already\n            rebalanced and assigned the partitions to another member.\n            This means that the time between subsequent calls to poll()\n            was longer than the configured max_poll_interval_ms, which\n            typically implies that the poll loop is spending too much\n            time message processing. You can address this either by\n            increasing the rebalance timeout with max_poll_interval_ms,\n            or by reducing the maximum size of batches returned in poll()\n            with max_poll_records.\n            ', 'Commit cannot be completed since the group has already rebalanced and may have assigned the partitions to another member')
2025-05-10 10:41:04.474 | INFO     | logging:callHandlers:1706 - Successfully synced group financial-document-processor with generation -1
2025-05-10 10:41:04.476 | INFO     | logging:callHandlers:1706 - Setting newly assigned partitions {TopicPartition(topic='documents-processing', partition=0)} for group financial-document-processor
2025-05-10 10:41:04.478 | INFO     | logging:callHandlers:1706 - Revoking previously assigned partitions frozenset({TopicPartition(topic='documents-processing', partition=0)}) for group financial-document-processor
2025-05-10 10:41:04.479 | INFO     | logging:callHandlers:1706 - (Re-)joining group financial-document-processor
2025-05-10 10:41:04.481 | INFO     | logging:callHandlers:1706 - Joined group 'financial-document-processor' (generation 69) with member_id aiokafka-0.12.0-4dda59ac-c9b7-49fa-aca8-15f876dd78f4
2025-05-10 10:41:04.481 | INFO     | logging:callHandlers:1706 - Elected group leader -- performing partition assignments using roundrobin
2025-05-10 10:41:04.485 | INFO     | logging:callHandlers:1706 - Successfully synced group financial-document-processor with generation 69
2025-05-10 10:41:04.486 | INFO     | logging:callHandlers:1706 - Setting newly assigned partitions {TopicPartition(topic='documents-processing', partition=0)} for group financial-document-processor
2025-05-10 10:41:04.490 | INFO     | logging:callHandlers:1706 - Processando documento 13 do tipo bank_statement
2025-05-10 10:41:28.960 | INFO     | logging:callHandlers:1706 - Sinal 2 recebido, iniciando desligamento...
2025-05-10 10:41:56.564 | INFO     | financial_document_processor.utils.logging:setup_logging:69 - Sistema de logging configurado com nível INFO
2025-05-10 10:41:56.580 | INFO     | logging:callHandlers:1706 - Inicializando aplicação...
2025-05-10 10:41:56.746 | INFO     | logging:callHandlers:1706 - Conexão estabelecida com o PostgreSQL. Pool criado com 5-20 conexões.
2025-05-10 10:41:56.751 | INFO     | logging:callHandlers:1706 - Esquema do banco de dados verificado/criado com sucesso
2025-05-10 10:41:56.789 | INFO     | logging:callHandlers:1706 - Produtor Kafka iniciado
2025-05-10 10:41:56.828 | INFO     | logging:callHandlers:1706 - Usando provedor de IA: claude
2025-05-10 10:41:56.829 | INFO     | logging:callHandlers:1706 - Carregadas 61 categorias padrão
2025-05-10 10:41:56.829 | INFO     | logging:callHandlers:1706 - Serviço de categorização inicializado
2025-05-10 10:41:56.830 | INFO     | logging:callHandlers:1706 - Updating subscribed topics to: frozenset({'documents-processing'})
2025-05-10 10:41:56.856 | INFO     | logging:callHandlers:1706 - Discovered coordinator 1 for group financial-document-processor
2025-05-10 10:41:56.857 | INFO     | logging:callHandlers:1706 - Revoking previously assigned partitions set() for group financial-document-processor
2025-05-10 10:41:56.857 | INFO     | logging:callHandlers:1706 - (Re-)joining group financial-document-processor
2025-05-10 10:41:59.872 | INFO     | logging:callHandlers:1706 - Joined group 'financial-document-processor' (generation 71) with member_id aiokafka-0.12.0-0988e292-a833-43ae-be29-72860a07f1b1
2025-05-10 10:41:59.873 | INFO     | logging:callHandlers:1706 - Elected group leader -- performing partition assignments using roundrobin
2025-05-10 10:41:59.895 | INFO     | logging:callHandlers:1706 - Successfully synced group financial-document-processor with generation 71
2025-05-10 10:41:59.898 | INFO     | logging:callHandlers:1706 - Setting newly assigned partitions {TopicPartition(topic='documents-processing', partition=0)} for group financial-document-processor
2025-05-10 10:41:59.899 | INFO     | logging:callHandlers:1706 - Consumidor Kafka iniciado para o tópico documents-processing
2025-05-10 10:41:59.899 | INFO     | logging:callHandlers:1706 - Aplicação inicializada com sucesso
2025-05-10 10:41:59.900 | INFO     | logging:callHandlers:1706 - Aplicação em execução
2025-05-10 10:41:59.909 | INFO     | logging:callHandlers:1706 - Processando documento 13 do tipo bank_statement
2025-05-10 10:42:04.321 | ERROR    | logging:callHandlers:1706 - Erro ao salvar documento 13: invalid input for query argument $10: datetime.datetime(2025, 5, 10, 10, 40, 3... (can't subtract offset-naive and offset-aware datetimes)
2025-05-10 10:42:04.322 | WARNING  | logging:callHandlers:1706 - Erro em save_document, tentativa 1/3. Aguardando 1.15s antes de tentar novamente: invalid input for query argument $10: datetime.datetime(2025, 5, 10, 10, 40, 3... (can't subtract offset-naive and offset-aware datetimes)
2025-05-10 10:42:05.472 | INFO     | logging:callHandlers:1706 - Tentativa 1/3 para save_document
2025-05-10 10:42:05.474 | ERROR    | logging:callHandlers:1706 - Erro ao salvar documento 13: invalid input for query argument $10: datetime.datetime(2025, 5, 10, 10, 40, 3... (can't subtract offset-naive and offset-aware datetimes)
2025-05-10 10:42:05.476 | WARNING  | logging:callHandlers:1706 - Erro em save_document, tentativa 2/3. Aguardando 2.01s antes de tentar novamente: invalid input for query argument $10: datetime.datetime(2025, 5, 10, 10, 40, 3... (can't subtract offset-naive and offset-aware datetimes)
2025-05-10 10:42:07.487 | INFO     | logging:callHandlers:1706 - Tentativa 2/3 para save_document
2025-05-10 10:42:07.490 | ERROR    | logging:callHandlers:1706 - Erro ao salvar documento 13: invalid input for query argument $10: datetime.datetime(2025, 5, 10, 10, 40, 3... (can't subtract offset-naive and offset-aware datetimes)
2025-05-10 10:42:07.492 | WARNING  | logging:callHandlers:1706 - Erro em save_document, tentativa 3/3. Aguardando 2.17s antes de tentar novamente: invalid input for query argument $10: datetime.datetime(2025, 5, 10, 10, 40, 3... (can't subtract offset-naive and offset-aware datetimes)
2025-05-10 10:42:09.662 | INFO     | logging:callHandlers:1706 - Tentativa 3/3 para save_document
2025-05-10 10:42:09.664 | ERROR    | logging:callHandlers:1706 - Erro ao salvar documento 13: invalid input for query argument $10: datetime.datetime(2025, 5, 10, 10, 40, 3... (can't subtract offset-naive and offset-aware datetimes)
2025-05-10 10:42:09.666 | ERROR    | logging:callHandlers:1706 - Máximo de 3 tentativas excedido para save_document: invalid input for query argument $10: datetime.datetime(2025, 5, 10, 10, 40, 3... (can't subtract offset-naive and offset-aware datetimes)
2025-05-10 10:42:09.666 | ERROR    | logging:callHandlers:1706 - Erro ao processar documento 13: invalid input for query argument $10: datetime.datetime(2025, 5, 10, 10, 40, 3... (can't subtract offset-naive and offset-aware datetimes)
2025-05-10 10:42:09.669 | WARNING  | logging:callHandlers:1706 - Documento 13 não encontrado para atualização de status
2025-05-10 10:42:09.702 | INFO     | logging:callHandlers:1706 - Mensagem processada em 9.79s: documento_id=13, tipo=bank_statement
2025-05-10 10:43:34.180 | INFO     | logging:callHandlers:1706 - Processando documento 14 do tipo bank_statement
2025-05-10 10:46:49.339 | INFO     | logging:callHandlers:1706 - Sinal 2 recebido, iniciando desligamento...
2025-05-10 10:49:19.928 | INFO     | financial_document_processor.utils.logging:setup_logging:69 - Sistema de logging configurado com nível INFO
2025-05-10 10:49:19.942 | INFO     | logging:callHandlers:1706 - Inicializando aplicação...
2025-05-10 10:49:20.146 | INFO     | logging:callHandlers:1706 - Conexão estabelecida com o PostgreSQL. Pool criado com 5-20 conexões.
2025-05-10 10:49:20.159 | INFO     | logging:callHandlers:1706 - Esquema do banco de dados verificado/criado com sucesso
2025-05-10 10:49:20.188 | INFO     | logging:callHandlers:1706 - Produtor Kafka iniciado
2025-05-10 10:49:20.221 | INFO     | logging:callHandlers:1706 - Usando provedor de IA: claude
2025-05-10 10:49:20.222 | INFO     | logging:callHandlers:1706 - Carregadas 61 categorias padrão
2025-05-10 10:49:20.222 | INFO     | logging:callHandlers:1706 - Serviço de categorização inicializado
2025-05-10 10:49:20.222 | INFO     | logging:callHandlers:1706 - Updating subscribed topics to: frozenset({'documents-processing'})
2025-05-10 10:49:20.251 | INFO     | logging:callHandlers:1706 - Discovered coordinator 1 for group financial-document-processor
2025-05-10 10:49:20.251 | INFO     | logging:callHandlers:1706 - Revoking previously assigned partitions set() for group financial-document-processor
2025-05-10 10:49:20.251 | INFO     | logging:callHandlers:1706 - (Re-)joining group financial-document-processor
2025-05-10 10:49:23.267 | INFO     | logging:callHandlers:1706 - Joined group 'financial-document-processor' (generation 73) with member_id aiokafka-0.12.0-c9558b8c-c150-4de0-8512-42fcef8717fd
2025-05-10 10:49:23.268 | INFO     | logging:callHandlers:1706 - Elected group leader -- performing partition assignments using roundrobin
2025-05-10 10:49:23.285 | INFO     | logging:callHandlers:1706 - Successfully synced group financial-document-processor with generation 73
2025-05-10 10:49:23.288 | INFO     | logging:callHandlers:1706 - Setting newly assigned partitions {TopicPartition(topic='documents-processing', partition=0)} for group financial-document-processor
2025-05-10 10:49:23.289 | INFO     | logging:callHandlers:1706 - Consumidor Kafka iniciado para o tópico documents-processing
2025-05-10 10:49:23.289 | INFO     | logging:callHandlers:1706 - Aplicação inicializada com sucesso
2025-05-10 10:49:23.290 | INFO     | logging:callHandlers:1706 - Aplicação em execução
2025-05-10 10:49:23.303 | INFO     | logging:callHandlers:1706 - Processando documento 14 do tipo bank_statement
2025-05-10 10:49:34.007 | INFO     | logging:callHandlers:1706 - Sinal 2 recebido, iniciando desligamento...
2025-05-10 10:50:06.787 | INFO     | financial_document_processor.utils.logging:setup_logging:69 - Sistema de logging configurado com nível INFO
2025-05-10 10:50:06.797 | INFO     | logging:callHandlers:1706 - Inicializando aplicação...
2025-05-10 10:50:06.973 | INFO     | logging:callHandlers:1706 - Conexão estabelecida com o PostgreSQL. Pool criado com 5-20 conexões.
2025-05-10 10:50:06.978 | INFO     | logging:callHandlers:1706 - Esquema do banco de dados verificado/criado com sucesso
2025-05-10 10:50:07.007 | INFO     | logging:callHandlers:1706 - Produtor Kafka iniciado
2025-05-10 10:50:07.041 | INFO     | logging:callHandlers:1706 - Usando provedor de IA: claude
2025-05-10 10:50:07.042 | INFO     | logging:callHandlers:1706 - Carregadas 61 categorias padrão
2025-05-10 10:50:07.043 | INFO     | logging:callHandlers:1706 - Serviço de categorização inicializado
2025-05-10 10:50:07.043 | INFO     | logging:callHandlers:1706 - Updating subscribed topics to: frozenset({'documents-processing'})
2025-05-10 10:50:07.069 | INFO     | logging:callHandlers:1706 - Discovered coordinator 1 for group financial-document-processor
2025-05-10 10:50:07.069 | INFO     | logging:callHandlers:1706 - Revoking previously assigned partitions set() for group financial-document-processor
2025-05-10 10:50:07.070 | INFO     | logging:callHandlers:1706 - (Re-)joining group financial-document-processor
2025-05-10 10:50:10.078 | INFO     | logging:callHandlers:1706 - Joined group 'financial-document-processor' (generation 75) with member_id aiokafka-0.12.0-40c0ae43-c0b9-44c5-878f-eff4eb6f4815
2025-05-10 10:50:10.079 | INFO     | logging:callHandlers:1706 - Elected group leader -- performing partition assignments using roundrobin
2025-05-10 10:50:10.091 | INFO     | logging:callHandlers:1706 - Successfully synced group financial-document-processor with generation 75
2025-05-10 10:50:10.093 | INFO     | logging:callHandlers:1706 - Setting newly assigned partitions {TopicPartition(topic='documents-processing', partition=0)} for group financial-document-processor
2025-05-10 10:50:10.093 | INFO     | logging:callHandlers:1706 - Consumidor Kafka iniciado para o tópico documents-processing
2025-05-10 10:50:10.094 | INFO     | logging:callHandlers:1706 - Aplicação inicializada com sucesso
2025-05-10 10:50:10.094 | INFO     | logging:callHandlers:1706 - Aplicação em execução
2025-05-10 10:50:10.107 | INFO     | logging:callHandlers:1706 - Processando documento 14 do tipo bank_statement
2025-05-10 10:52:22.896 | INFO     | logging:callHandlers:1706 - Sinal 2 recebido, iniciando desligamento...
2025-05-10 10:52:25.741 | INFO     | financial_document_processor.utils.logging:setup_logging:69 - Sistema de logging configurado com nível INFO
2025-05-10 10:52:25.750 | INFO     | logging:callHandlers:1706 - Inicializando aplicação...
2025-05-10 10:52:25.933 | INFO     | logging:callHandlers:1706 - Conexão estabelecida com o PostgreSQL. Pool criado com 5-20 conexões.
2025-05-10 10:52:25.936 | INFO     | logging:callHandlers:1706 - Esquema do banco de dados verificado/criado com sucesso
2025-05-10 10:52:25.973 | INFO     | logging:callHandlers:1706 - Produtor Kafka iniciado
2025-05-10 10:52:26.007 | INFO     | logging:callHandlers:1706 - Usando provedor de IA: claude
2025-05-10 10:52:26.008 | INFO     | logging:callHandlers:1706 - Carregadas 61 categorias padrão
2025-05-10 10:52:26.008 | INFO     | logging:callHandlers:1706 - Serviço de categorização inicializado
2025-05-10 10:52:26.009 | INFO     | logging:callHandlers:1706 - Updating subscribed topics to: frozenset({'documents-processing'})
2025-05-10 10:52:26.029 | INFO     | logging:callHandlers:1706 - Discovered coordinator 1 for group financial-document-processor
2025-05-10 10:52:26.029 | INFO     | logging:callHandlers:1706 - Revoking previously assigned partitions set() for group financial-document-processor
2025-05-10 10:52:26.029 | INFO     | logging:callHandlers:1706 - (Re-)joining group financial-document-processor
2025-05-10 10:52:29.048 | INFO     | logging:callHandlers:1706 - Joined group 'financial-document-processor' (generation 77) with member_id aiokafka-0.12.0-71808472-71fe-464b-a757-2b515ca5e4d4
2025-05-10 10:52:29.049 | INFO     | logging:callHandlers:1706 - Elected group leader -- performing partition assignments using roundrobin
2025-05-10 10:52:29.061 | INFO     | logging:callHandlers:1706 - Successfully synced group financial-document-processor with generation 77
2025-05-10 10:52:29.063 | INFO     | logging:callHandlers:1706 - Setting newly assigned partitions {TopicPartition(topic='documents-processing', partition=0)} for group financial-document-processor
2025-05-10 10:52:29.064 | INFO     | logging:callHandlers:1706 - Consumidor Kafka iniciado para o tópico documents-processing
2025-05-10 10:52:29.064 | INFO     | logging:callHandlers:1706 - Aplicação inicializada com sucesso
2025-05-10 10:52:29.065 | INFO     | logging:callHandlers:1706 - Aplicação em execução
2025-05-10 10:54:09.535 | INFO     | logging:callHandlers:1706 - Sinal 2 recebido, iniciando desligamento...
2025-05-10 10:54:12.535 | INFO     | financial_document_processor.utils.logging:setup_logging:69 - Sistema de logging configurado com nível INFO
2025-05-10 10:54:12.549 | INFO     | logging:callHandlers:1706 - Inicializando aplicação...
2025-05-10 10:54:12.711 | INFO     | logging:callHandlers:1706 - Conexão estabelecida com o PostgreSQL. Pool criado com 5-20 conexões.
2025-05-10 10:54:12.715 | INFO     | logging:callHandlers:1706 - Esquema do banco de dados verificado/criado com sucesso
2025-05-10 10:54:12.745 | INFO     | logging:callHandlers:1706 - Produtor Kafka iniciado
2025-05-10 10:54:12.824 | INFO     | logging:callHandlers:1706 - Usando provedor de IA: claude
2025-05-10 10:54:12.826 | INFO     | logging:callHandlers:1706 - Carregadas 61 categorias padrão
2025-05-10 10:54:12.826 | INFO     | logging:callHandlers:1706 - Serviço de categorização inicializado
2025-05-10 10:54:12.826 | INFO     | logging:callHandlers:1706 - Updating subscribed topics to: frozenset({'documents-processing'})
2025-05-10 10:54:12.851 | INFO     | logging:callHandlers:1706 - Discovered coordinator 1 for group financial-document-processor
2025-05-10 10:54:12.851 | INFO     | logging:callHandlers:1706 - Revoking previously assigned partitions set() for group financial-document-processor
2025-05-10 10:54:12.851 | INFO     | logging:callHandlers:1706 - (Re-)joining group financial-document-processor
2025-05-10 10:54:15.866 | INFO     | logging:callHandlers:1706 - Joined group 'financial-document-processor' (generation 79) with member_id aiokafka-0.12.0-3744de5c-e52c-4e48-a5d8-c5abe31ea16c
2025-05-10 10:54:15.866 | INFO     | logging:callHandlers:1706 - Elected group leader -- performing partition assignments using roundrobin
2025-05-10 10:54:15.875 | INFO     | logging:callHandlers:1706 - Successfully synced group financial-document-processor with generation 79
2025-05-10 10:54:15.877 | INFO     | logging:callHandlers:1706 - Setting newly assigned partitions {TopicPartition(topic='documents-processing', partition=0)} for group financial-document-processor
2025-05-10 10:54:15.878 | INFO     | logging:callHandlers:1706 - Consumidor Kafka iniciado para o tópico documents-processing
2025-05-10 10:54:15.878 | INFO     | logging:callHandlers:1706 - Aplicação inicializada com sucesso
2025-05-10 10:54:15.879 | INFO     | logging:callHandlers:1706 - Aplicação em execução
2025-05-10 10:58:26.195 | INFO     | logging:callHandlers:1706 - Sinal 2 recebido, iniciando desligamento...
2025-05-10 10:58:28.874 | INFO     | financial_document_processor.utils.logging:setup_logging:69 - Sistema de logging configurado com nível INFO
2025-05-10 10:58:28.889 | INFO     | logging:callHandlers:1706 - Inicializando aplicação...
2025-05-10 10:58:29.066 | INFO     | logging:callHandlers:1706 - Conexão estabelecida com o PostgreSQL. Pool criado com 5-20 conexões.
2025-05-10 10:58:29.071 | INFO     | logging:callHandlers:1706 - Esquema do banco de dados verificado/criado com sucesso
2025-05-10 10:58:29.091 | INFO     | logging:callHandlers:1706 - Produtor Kafka iniciado
2025-05-10 10:58:29.125 | INFO     | logging:callHandlers:1706 - Usando provedor de IA: claude
2025-05-10 10:58:29.126 | INFO     | logging:callHandlers:1706 - Carregadas 61 categorias padrão
2025-05-10 10:58:29.126 | INFO     | logging:callHandlers:1706 - Serviço de categorização inicializado
2025-05-10 10:58:29.126 | INFO     | logging:callHandlers:1706 - Updating subscribed topics to: frozenset({'documents-processing'})
2025-05-10 10:58:29.152 | INFO     | logging:callHandlers:1706 - Discovered coordinator 1 for group financial-document-processor
2025-05-10 10:58:29.153 | INFO     | logging:callHandlers:1706 - Revoking previously assigned partitions set() for group financial-document-processor
2025-05-10 10:58:29.153 | INFO     | logging:callHandlers:1706 - (Re-)joining group financial-document-processor
2025-05-10 10:58:32.180 | INFO     | logging:callHandlers:1706 - Joined group 'financial-document-processor' (generation 81) with member_id aiokafka-0.12.0-366f76b5-7294-4fc3-8c3b-d638e6f3421c
2025-05-10 10:58:32.181 | INFO     | logging:callHandlers:1706 - Elected group leader -- performing partition assignments using roundrobin
2025-05-10 10:58:32.196 | INFO     | logging:callHandlers:1706 - Successfully synced group financial-document-processor with generation 81
2025-05-10 10:58:32.199 | INFO     | logging:callHandlers:1706 - Setting newly assigned partitions {TopicPartition(topic='documents-processing', partition=0)} for group financial-document-processor
2025-05-10 10:58:32.200 | INFO     | logging:callHandlers:1706 - Consumidor Kafka iniciado para o tópico documents-processing
2025-05-10 10:58:32.200 | INFO     | logging:callHandlers:1706 - Aplicação inicializada com sucesso
2025-05-10 10:58:32.200 | INFO     | logging:callHandlers:1706 - Aplicação em execução
2025-05-10 10:58:40.348 | INFO     | logging:callHandlers:1706 - Processando documento 14 do tipo bank_statement
2025-05-10 10:58:56.497 | WARNING  | logging:callHandlers:1706 - Heartbeat failed: local member_id was not recognized; resetting and re-joining group
2025-05-10 10:58:56.498 | ERROR    | logging:callHandlers:1706 - Heartbeat session expired - marking coordinator dead
2025-05-10 10:58:56.498 | WARNING  | logging:callHandlers:1706 - Marking the coordinator dead (node 1)for group financial-document-processor.
2025-05-10 10:58:56.506 | INFO     | logging:callHandlers:1706 - Discovered coordinator 1 for group financial-document-processor
2025-05-10 10:58:56.506 | INFO     | logging:callHandlers:1706 - Revoking previously assigned partitions frozenset({TopicPartition(topic='documents-processing', partition=0)}) for group financial-document-processor
2025-05-10 10:58:56.507 | INFO     | logging:callHandlers:1706 - (Re-)joining group financial-document-processor
2025-05-10 10:59:06.830 | INFO     | logging:callHandlers:1706 - Iniciando processamento do documento 14 do tipo bank_statement para o usuário 2
2025-05-10 11:00:32.863 | INFO     | logging:callHandlers:1706 - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-05-10 11:01:37.474 | ERROR    | logging:callHandlers:1706 - Erro ao converter item para Transaction: 2 validation errors for Transaction
type
  Input should be 'credit' or 'debit' [type=enum, input_value='CREDIT', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/enum
method
  Input should be 'pix', 'ted', 'doc', 'boleto', 'payment', 'transfer', 'withdrawal', 'deposit', 'loan' or 'other' [type=enum, input_value='PIX', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/enum
2025-05-10 11:01:37.476 | ERROR    | logging:callHandlers:1706 - Erro ao converter item para Transaction: 2 validation errors for Transaction
type
  Input should be 'credit' or 'debit' [type=enum, input_value='DEBIT', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/enum
method
  Input should be 'pix', 'ted', 'doc', 'boleto', 'payment', 'transfer', 'withdrawal', 'deposit', 'loan' or 'other' [type=enum, input_value='PIX', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/enum
2025-05-10 11:01:37.476 | ERROR    | logging:callHandlers:1706 - Erro ao converter item para Transaction: 1 validation error for Transaction
type
  Input should be 'credit' or 'debit' [type=enum, input_value='DEBIT', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/enum
2025-05-10 11:01:37.476 | ERROR    | logging:callHandlers:1706 - Erro ao converter item para Transaction: 1 validation error for Transaction
type
  Input should be 'credit' or 'debit' [type=enum, input_value='DEBIT', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/enum
2025-05-10 11:01:37.476 | ERROR    | logging:callHandlers:1706 - Erro ao converter item para Transaction: 1 validation error for Transaction
type
  Input should be 'credit' or 'debit' [type=enum, input_value='DEBIT', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/enum
2025-05-10 11:01:37.476 | ERROR    | logging:callHandlers:1706 - Erro ao converter item para Transaction: 2 validation errors for Transaction
type
  Input should be 'credit' or 'debit' [type=enum, input_value='CREDIT', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/enum
method
  Input should be 'pix', 'ted', 'doc', 'boleto', 'payment', 'transfer', 'withdrawal', 'deposit', 'loan' or 'other' [type=enum, input_value='PIX', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/enum
2025-05-10 11:01:37.477 | ERROR    | logging:callHandlers:1706 - Erro ao converter item para Transaction: 2 validation errors for Transaction
type
  Input should be 'credit' or 'debit' [type=enum, input_value='DEBIT', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/enum
method
  Input should be 'pix', 'ted', 'doc', 'boleto', 'payment', 'transfer', 'withdrawal', 'deposit', 'loan' or 'other' [type=enum, input_value='PIX', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/enum
2025-05-10 11:01:37.477 | ERROR    | logging:callHandlers:1706 - Erro ao converter item para Transaction: 2 validation errors for Transaction
type
  Input should be 'credit' or 'debit' [type=enum, input_value='DEBIT', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/enum
method
  Input should be 'pix', 'ted', 'doc', 'boleto', 'payment', 'transfer', 'withdrawal', 'deposit', 'loan' or 'other' [type=enum, input_value='PIX', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/enum
2025-05-10 11:01:37.477 | ERROR    | logging:callHandlers:1706 - Erro ao converter item para Transaction: 2 validation errors for Transaction
type
  Input should be 'credit' or 'debit' [type=enum, input_value='DEBIT', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/enum
method
  Input should be 'pix', 'ted', 'doc', 'boleto', 'payment', 'transfer', 'withdrawal', 'deposit', 'loan' or 'other' [type=enum, input_value='PIX', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/enum
2025-05-10 11:01:37.477 | ERROR    | logging:callHandlers:1706 - Erro ao converter item para Transaction: 1 validation error for Transaction
type
  Input should be 'credit' or 'debit' [type=enum, input_value='CREDIT', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/enum
2025-05-10 11:01:37.478 | ERROR    | logging:callHandlers:1706 - Erro ao converter item para Transaction: 2 validation errors for Transaction
type
  Input should be 'credit' or 'debit' [type=enum, input_value='CREDIT', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/enum
method
  Input should be 'pix', 'ted', 'doc', 'boleto', 'payment', 'transfer', 'withdrawal', 'deposit', 'loan' or 'other' [type=enum, input_value='PIX', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/enum
2025-05-10 11:01:37.478 | ERROR    | logging:callHandlers:1706 - Erro ao converter item para Transaction: 2 validation errors for Transaction
type
  Input should be 'credit' or 'debit' [type=enum, input_value='DEBIT', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/enum
method
  Input should be 'pix', 'ted', 'doc', 'boleto', 'payment', 'transfer', 'withdrawal', 'deposit', 'loan' or 'other' [type=enum, input_value='PIX', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/enum
2025-05-10 11:01:37.478 | ERROR    | logging:callHandlers:1706 - Erro ao converter item para Transaction: 1 validation error for Transaction
type
  Input should be 'credit' or 'debit' [type=enum, input_value='DEBIT', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/enum
2025-05-10 11:01:37.478 | ERROR    | logging:callHandlers:1706 - Erro ao converter item para Transaction: 1 validation error for Transaction
type
  Input should be 'credit' or 'debit' [type=enum, input_value='DEBIT', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/enum
2025-05-10 11:01:37.478 | ERROR    | logging:callHandlers:1706 - Erro ao converter item para Transaction: 1 validation error for Transaction
type
  Input should be 'credit' or 'debit' [type=enum, input_value='DEBIT', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/enum
2025-05-10 11:01:37.478 | ERROR    | logging:callHandlers:1706 - Erro ao converter item para Transaction: 2 validation errors for Transaction
type
  Input should be 'credit' or 'debit' [type=enum, input_value='DEBIT', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/enum
method
  Input should be 'pix', 'ted', 'doc', 'boleto', 'payment', 'transfer', 'withdrawal', 'deposit', 'loan' or 'other' [type=enum, input_value='PIX', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/enum
2025-05-10 11:01:37.478 | ERROR    | logging:callHandlers:1706 - Erro ao converter item para Transaction: 2 validation errors for Transaction
type
  Input should be 'credit' or 'debit' [type=enum, input_value='DEBIT', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/enum
method
  Input should be 'pix', 'ted', 'doc', 'boleto', 'payment', 'transfer', 'withdrawal', 'deposit', 'loan' or 'other' [type=enum, input_value='PIX', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/enum
2025-05-10 11:01:37.479 | ERROR    | logging:callHandlers:1706 - Erro ao converter item para Transaction: 2 validation errors for Transaction
type
  Input should be 'credit' or 'debit' [type=enum, input_value='DEBIT', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/enum
method
  Input should be 'pix', 'ted', 'doc', 'boleto', 'payment', 'transfer', 'withdrawal', 'deposit', 'loan' or 'other' [type=enum, input_value='PIX', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/enum
2025-05-10 11:01:37.479 | ERROR    | logging:callHandlers:1706 - Erro ao converter item para Transaction: 2 validation errors for Transaction
type
  Input should be 'credit' or 'debit' [type=enum, input_value='CREDIT', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/enum
method
  Input should be 'pix', 'ted', 'doc', 'boleto', 'payment', 'transfer', 'withdrawal', 'deposit', 'loan' or 'other' [type=enum, input_value='PIX', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/enum
2025-05-10 11:01:37.479 | ERROR    | logging:callHandlers:1706 - Erro ao converter item para Transaction: 2 validation errors for Transaction
type
  Input should be 'credit' or 'debit' [type=enum, input_value='CREDIT', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/enum
method
  Input should be 'pix', 'ted', 'doc', 'boleto', 'payment', 'transfer', 'withdrawal', 'deposit', 'loan' or 'other' [type=enum, input_value='TED', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/enum
2025-05-10 11:01:37.479 | ERROR    | logging:callHandlers:1706 - Erro ao converter item para Transaction: 2 validation errors for Transaction
type
  Input should be 'credit' or 'debit' [type=enum, input_value='CREDIT', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/enum
method
  Input should be 'pix', 'ted', 'doc', 'boleto', 'payment', 'transfer', 'withdrawal', 'deposit', 'loan' or 'other' [type=enum, input_value='TED', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/enum
2025-05-10 11:01:37.479 | ERROR    | logging:callHandlers:1706 - Erro ao converter item para Transaction: 2 validation errors for Transaction
type
  Input should be 'credit' or 'debit' [type=enum, input_value='DEBIT', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/enum
method
  Input should be 'pix', 'ted', 'doc', 'boleto', 'payment', 'transfer', 'withdrawal', 'deposit', 'loan' or 'other' [type=enum, input_value='PIX', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/enum
2025-05-10 11:01:37.479 | WARNING  | logging:callHandlers:1706 - Nenhuma transação extraída do documento 14
2025-05-10 11:07:14.696 | INFO     | logging:callHandlers:1706 - Sinal 2 recebido, iniciando desligamento...
2025-05-10 11:07:17.470 | INFO     | financial_document_processor.utils.logging:setup_logging:69 - Sistema de logging configurado com nível INFO
2025-05-10 11:07:17.484 | INFO     | logging:callHandlers:1706 - Inicializando aplicação...
2025-05-10 11:07:17.693 | INFO     | logging:callHandlers:1706 - Conexão estabelecida com o PostgreSQL. Pool criado com 5-20 conexões.
2025-05-10 11:07:17.702 | INFO     | logging:callHandlers:1706 - Esquema do banco de dados verificado/criado com sucesso
2025-05-10 11:07:17.735 | INFO     | logging:callHandlers:1706 - Produtor Kafka iniciado
2025-05-10 11:07:17.768 | INFO     | logging:callHandlers:1706 - Usando provedor de IA: claude
2025-05-10 11:07:17.769 | INFO     | logging:callHandlers:1706 - Carregadas 61 categorias padrão
2025-05-10 11:07:17.769 | INFO     | logging:callHandlers:1706 - Serviço de categorização inicializado
2025-05-10 11:07:17.770 | INFO     | logging:callHandlers:1706 - Updating subscribed topics to: frozenset({'documents-processing'})
2025-05-10 11:07:17.800 | INFO     | logging:callHandlers:1706 - Discovered coordinator 1 for group financial-document-processor
2025-05-10 11:07:17.801 | INFO     | logging:callHandlers:1706 - Revoking previously assigned partitions set() for group financial-document-processor
2025-05-10 11:07:17.801 | INFO     | logging:callHandlers:1706 - (Re-)joining group financial-document-processor
2025-05-10 11:07:20.823 | INFO     | logging:callHandlers:1706 - Joined group 'financial-document-processor' (generation 85) with member_id aiokafka-0.12.0-9bd38d97-d10e-49ca-aabb-001710a891cd
2025-05-10 11:07:20.824 | INFO     | logging:callHandlers:1706 - Elected group leader -- performing partition assignments using roundrobin
2025-05-10 11:07:20.835 | INFO     | logging:callHandlers:1706 - Successfully synced group financial-document-processor with generation 85
2025-05-10 11:07:20.836 | INFO     | logging:callHandlers:1706 - Setting newly assigned partitions {TopicPartition(topic='documents-processing', partition=0)} for group financial-document-processor
2025-05-10 11:07:20.836 | INFO     | logging:callHandlers:1706 - Consumidor Kafka iniciado para o tópico documents-processing
2025-05-10 11:07:20.836 | INFO     | logging:callHandlers:1706 - Aplicação inicializada com sucesso
2025-05-10 11:07:20.836 | INFO     | logging:callHandlers:1706 - Aplicação em execução
2025-05-10 11:07:24.432 | INFO     | logging:callHandlers:1706 - Processando documento 14 do tipo bank_statement
2025-05-10 11:07:32.256 | INFO     | logging:callHandlers:1706 - Iniciando processamento do documento 14 do tipo bank_statement para o usuário 2
2025-05-10 11:08:47.289 | INFO     | logging:callHandlers:1706 - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-05-10 11:08:51.885 | INFO     | logging:callHandlers:1706 - Utilizando serviço de categorização para o documento 14
2025-05-10 11:09:01.207 | ERROR    | logging:callHandlers:1706 - Erro ao categorizar lote com IA: Invalid format specifier ' "transaction-id-1",
      "date": "2023-01-15",
      "description": "TRANSFERÊNCIA RECEBIDA - JOÃO SILVA",
      "amount": "1500.00",
      "type": "CREDIT",
      "method": "TED",
      "categories": ["salário", "renda fixa"],
      "confidence_score": 0.95
    ' for object of type 'str'
2025-05-10 11:10:35.513 | INFO     | logging:callHandlers:1706 - Processamento do documento 14 concluído em 183.25s. Extraídas 22 transações.
2025-05-10 11:10:44.973 | WARNING  | logging:callHandlers:1706 - Heartbeat failed: local member_id was not recognized; resetting and re-joining group
2025-05-10 11:10:44.974 | ERROR    | logging:callHandlers:1706 - Heartbeat session expired - marking coordinator dead
2025-05-10 11:10:44.974 | WARNING  | logging:callHandlers:1706 - Marking the coordinator dead (node 1)for group financial-document-processor.
2025-05-10 11:10:44.987 | INFO     | logging:callHandlers:1706 - Discovered coordinator 1 for group financial-document-processor
2025-05-10 11:10:44.987 | INFO     | logging:callHandlers:1706 - Revoking previously assigned partitions frozenset({TopicPartition(topic='documents-processing', partition=0)}) for group financial-document-processor
2025-05-10 11:10:44.987 | INFO     | logging:callHandlers:1706 - (Re-)joining group financial-document-processor
2025-05-10 11:10:45.082 | INFO     | logging:callHandlers:1706 - Salvas 22 transações com sucesso
2025-05-10 11:10:45.134 | INFO     | logging:callHandlers:1706 - Documento 14 processado com sucesso. Extraídas 22 transações.
2025-05-10 11:10:45.134 | INFO     | logging:callHandlers:1706 - Mensagem processada em 204.29s: documento_id=14, tipo=bank_statement
2025-05-10 11:10:48.009 | INFO     | logging:callHandlers:1706 - Joined group 'financial-document-processor' (generation 87) with member_id aiokafka-0.12.0-e7e2f0d7-ec7c-4510-886a-f7f9ad676d4f
2025-05-10 11:10:48.009 | INFO     | logging:callHandlers:1706 - Elected group leader -- performing partition assignments using roundrobin
2025-05-10 11:10:48.024 | ERROR    | logging:callHandlers:1706 - OffsetCommit failed for group financial-document-processor due to group error ([Error 22] IllegalGenerationError: financial-document-processor), will rejoin
2025-05-10 11:10:48.025 | ERROR    | logging:callHandlers:1706 - Erro ao processar mensagem: CommitFailedError: ('Commit cannot be completed since the group has already\n            rebalanced and assigned the partitions to another member.\n            This means that the time between subsequent calls to poll()\n            was longer than the configured max_poll_interval_ms, which\n            typically implies that the poll loop is spending too much\n            time message processing. You can address this either by\n            increasing the rebalance timeout with max_poll_interval_ms,\n            or by reducing the maximum size of batches returned in poll()\n            with max_poll_records.\n            ', 'Commit cannot be completed since the group has already rebalanced and may have assigned the partitions to another member')
2025-05-10 11:10:48.028 | INFO     | logging:callHandlers:1706 - Successfully synced group financial-document-processor with generation -1
2025-05-10 11:10:48.035 | INFO     | logging:callHandlers:1706 - Setting newly assigned partitions {TopicPartition(topic='documents-processing', partition=0)} for group financial-document-processor
2025-05-10 11:10:48.037 | INFO     | logging:callHandlers:1706 - Revoking previously assigned partitions frozenset({TopicPartition(topic='documents-processing', partition=0)}) for group financial-document-processor
2025-05-10 11:10:48.037 | INFO     | logging:callHandlers:1706 - (Re-)joining group financial-document-processor
2025-05-10 11:10:48.041 | INFO     | logging:callHandlers:1706 - Joined group 'financial-document-processor' (generation 88) with member_id aiokafka-0.12.0-e7e2f0d7-ec7c-4510-886a-f7f9ad676d4f
2025-05-10 11:10:48.041 | INFO     | logging:callHandlers:1706 - Elected group leader -- performing partition assignments using roundrobin
2025-05-10 11:10:48.047 | INFO     | logging:callHandlers:1706 - Successfully synced group financial-document-processor with generation 88
2025-05-10 11:10:48.048 | INFO     | logging:callHandlers:1706 - Setting newly assigned partitions {TopicPartition(topic='documents-processing', partition=0)} for group financial-document-processor
2025-05-10 11:10:48.056 | INFO     | logging:callHandlers:1706 - Processando documento 14 do tipo bank_statement
2025-05-10 11:10:48.067 | INFO     | logging:callHandlers:1706 - Iniciando processamento do documento 14 do tipo bank_statement para o usuário 2
2025-05-10 11:11:06.611 | INFO     | logging:callHandlers:1706 - Sinal 2 recebido, iniciando desligamento...
2025-05-10 11:19:35.047 | INFO     | financial_document_processor.utils.logging:setup_logging:69 - Sistema de logging configurado com nível INFO
2025-05-10 11:19:35.100 | INFO     | logging:callHandlers:1706 - Inicializando aplicação...
2025-05-10 11:19:35.335 | INFO     | logging:callHandlers:1706 - Conexão estabelecida com o PostgreSQL. Pool criado com 5-20 conexões.
2025-05-10 11:19:35.347 | INFO     | logging:callHandlers:1706 - Esquema do banco de dados verificado/criado com sucesso
2025-05-10 11:19:35.375 | INFO     | logging:callHandlers:1706 - Produtor Kafka iniciado
2025-05-10 11:19:35.413 | INFO     | logging:callHandlers:1706 - Usando provedor de IA: claude
2025-05-10 11:19:35.414 | INFO     | logging:callHandlers:1706 - Carregadas 61 categorias padrão
2025-05-10 11:19:35.414 | INFO     | logging:callHandlers:1706 - Serviço de categorização inicializado
2025-05-10 11:19:35.415 | INFO     | logging:callHandlers:1706 - Updating subscribed topics to: frozenset({'documents-processing'})
2025-05-10 11:19:35.441 | INFO     | logging:callHandlers:1706 - Discovered coordinator 1 for group financial-document-processor
2025-05-10 11:19:35.441 | INFO     | logging:callHandlers:1706 - Revoking previously assigned partitions set() for group financial-document-processor
2025-05-10 11:19:35.442 | INFO     | logging:callHandlers:1706 - (Re-)joining group financial-document-processor
2025-05-10 11:19:38.462 | INFO     | logging:callHandlers:1706 - Joined group 'financial-document-processor' (generation 90) with member_id aiokafka-0.12.0-4b3a4338-c3f9-4c5f-b04c-a3c69aca5ce3
2025-05-10 11:19:38.462 | INFO     | logging:callHandlers:1706 - Elected group leader -- performing partition assignments using roundrobin
2025-05-10 11:19:38.477 | INFO     | logging:callHandlers:1706 - Successfully synced group financial-document-processor with generation 90
2025-05-10 11:19:38.478 | INFO     | logging:callHandlers:1706 - Setting newly assigned partitions {TopicPartition(topic='documents-processing', partition=0)} for group financial-document-processor
2025-05-10 11:19:38.478 | INFO     | logging:callHandlers:1706 - Consumidor Kafka iniciado para o tópico documents-processing
2025-05-10 11:19:38.478 | INFO     | logging:callHandlers:1706 - Aplicação inicializada com sucesso
2025-05-10 11:19:38.478 | INFO     | logging:callHandlers:1706 - Aplicação em execução
2025-05-10 11:19:38.503 | INFO     | logging:callHandlers:1706 - Fetch offset 11 is out of range for partition TopicPartition(topic='documents-processing', partition=0), resetting offset
2025-05-10 11:19:56.499 | INFO     | logging:callHandlers:1706 - Processando documento 15 do tipo bank_statement
2025-05-10 11:19:57.055 | INFO     | logging:callHandlers:1706 - Iniciando processamento do documento 15 do tipo bank_statement para o usuário 2
2025-05-10 11:22:14.518 | INFO     | logging:callHandlers:1706 - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-05-10 11:22:14.544 | ERROR    | logging:callHandlers:1706 - Erro ao processar resposta do Claude: Expecting ',' delimiter: line 415 column 6 (char 10752)
2025-05-10 11:22:14.544 | WARNING  | logging:callHandlers:1706 - Nenhuma transação extraída do documento 15
2025-05-10 11:22:47.418 | WARNING  | logging:callHandlers:1706 - Nenhuma transação extraída do documento 15
2025-05-10 11:22:47.427 | WARNING  | logging:callHandlers:1706 - Heartbeat failed: local member_id was not recognized; resetting and re-joining group
2025-05-10 11:22:47.428 | ERROR    | logging:callHandlers:1706 - Heartbeat session expired - marking coordinator dead
2025-05-10 11:22:47.428 | WARNING  | logging:callHandlers:1706 - Marking the coordinator dead (node 1)for group financial-document-processor.
2025-05-10 11:22:47.432 | INFO     | logging:callHandlers:1706 - Discovered coordinator 1 for group financial-document-processor
2025-05-10 11:22:47.432 | INFO     | logging:callHandlers:1706 - Revoking previously assigned partitions frozenset({TopicPartition(topic='documents-processing', partition=0)}) for group financial-document-processor
2025-05-10 11:22:47.432 | INFO     | logging:callHandlers:1706 - (Re-)joining group financial-document-processor
2025-05-10 11:22:47.466 | INFO     | logging:callHandlers:1706 - Mensagem processada em 170.98s: documento_id=15, tipo=bank_statement
2025-05-10 11:22:50.454 | INFO     | logging:callHandlers:1706 - Joined group 'financial-document-processor' (generation 92) with member_id aiokafka-0.12.0-9764334e-fc2c-48ec-8192-67b29d21a4cc
2025-05-10 11:22:50.454 | INFO     | logging:callHandlers:1706 - Elected group leader -- performing partition assignments using roundrobin
2025-05-10 11:22:50.458 | ERROR    | logging:callHandlers:1706 - OffsetCommit failed for group financial-document-processor due to group error ([Error 22] IllegalGenerationError: financial-document-processor), will rejoin
2025-05-10 11:22:50.459 | ERROR    | logging:callHandlers:1706 - Erro ao processar mensagem: CommitFailedError: ('Commit cannot be completed since the group has already\n            rebalanced and assigned the partitions to another member.\n            This means that the time between subsequent calls to poll()\n            was longer than the configured max_poll_interval_ms, which\n            typically implies that the poll loop is spending too much\n            time message processing. You can address this either by\n            increasing the rebalance timeout with max_poll_interval_ms,\n            or by reducing the maximum size of batches returned in poll()\n            with max_poll_records.\n            ', 'Commit cannot be completed since the group has already rebalanced and may have assigned the partitions to another member')
2025-05-10 11:22:50.461 | INFO     | logging:callHandlers:1706 - Successfully synced group financial-document-processor with generation -1
2025-05-10 11:22:50.466 | INFO     | logging:callHandlers:1706 - Setting newly assigned partitions {TopicPartition(topic='documents-processing', partition=0)} for group financial-document-processor
2025-05-10 11:22:50.466 | INFO     | logging:callHandlers:1706 - Revoking previously assigned partitions frozenset({TopicPartition(topic='documents-processing', partition=0)}) for group financial-document-processor
2025-05-10 11:22:50.467 | INFO     | logging:callHandlers:1706 - (Re-)joining group financial-document-processor
2025-05-10 11:22:50.470 | INFO     | logging:callHandlers:1706 - Joined group 'financial-document-processor' (generation 93) with member_id aiokafka-0.12.0-9764334e-fc2c-48ec-8192-67b29d21a4cc
2025-05-10 11:22:50.470 | INFO     | logging:callHandlers:1706 - Elected group leader -- performing partition assignments using roundrobin
2025-05-10 11:22:50.473 | INFO     | logging:callHandlers:1706 - Fetch offset 11 is out of range for partition TopicPartition(topic='documents-processing', partition=0), resetting offset
2025-05-10 11:22:50.474 | INFO     | logging:callHandlers:1706 - Successfully synced group financial-document-processor with generation 93
2025-05-10 11:22:50.474 | INFO     | logging:callHandlers:1706 - Setting newly assigned partitions {TopicPartition(topic='documents-processing', partition=0)} for group financial-document-processor
2025-05-10 11:22:50.478 | INFO     | logging:callHandlers:1706 - Fetch offset 11 is out of range for partition TopicPartition(topic='documents-processing', partition=0), resetting offset
2025-05-10 11:22:50.482 | INFO     | logging:callHandlers:1706 - Processando documento 15 do tipo bank_statement
2025-05-10 11:22:50.504 | INFO     | logging:callHandlers:1706 - Iniciando processamento do documento 15 do tipo bank_statement para o usuário 2
2025-05-10 11:24:54.907 | INFO     | logging:callHandlers:1706 - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-05-10 11:31:02.343 | INFO     | logging:callHandlers:1706 - Sinal 2 recebido, iniciando desligamento...
2025-05-10 11:31:05.262 | INFO     | financial_document_processor.utils.logging:setup_logging:69 - Sistema de logging configurado com nível INFO
2025-05-10 11:31:05.280 | INFO     | logging:callHandlers:1706 - Inicializando aplicação...
2025-05-10 11:31:05.495 | INFO     | logging:callHandlers:1706 - Conexão estabelecida com o PostgreSQL. Pool criado com 5-20 conexões.
2025-05-10 11:31:05.503 | INFO     | logging:callHandlers:1706 - Esquema do banco de dados verificado/criado com sucesso
2025-05-10 11:31:05.521 | INFO     | logging:callHandlers:1706 - Produtor Kafka iniciado
2025-05-10 11:31:05.552 | INFO     | logging:callHandlers:1706 - Usando provedor de IA: claude
2025-05-10 11:31:05.553 | INFO     | logging:callHandlers:1706 - Carregadas 61 categorias padrão
2025-05-10 11:31:05.553 | INFO     | logging:callHandlers:1706 - Serviço de categorização inicializado
2025-05-10 11:31:05.554 | INFO     | logging:callHandlers:1706 - Updating subscribed topics to: frozenset({'documents-processing'})
2025-05-10 11:31:05.588 | INFO     | logging:callHandlers:1706 - Discovered coordinator 1 for group financial-document-processor
2025-05-10 11:31:05.588 | INFO     | logging:callHandlers:1706 - Revoking previously assigned partitions set() for group financial-document-processor
2025-05-10 11:31:05.588 | INFO     | logging:callHandlers:1706 - (Re-)joining group financial-document-processor
2025-05-10 11:31:08.607 | INFO     | logging:callHandlers:1706 - Joined group 'financial-document-processor' (generation 95) with member_id aiokafka-0.12.0-2256b587-b720-49db-9ed2-59be00ecd6f6
2025-05-10 11:31:08.608 | INFO     | logging:callHandlers:1706 - Elected group leader -- performing partition assignments using roundrobin
2025-05-10 11:31:08.622 | INFO     | logging:callHandlers:1706 - Successfully synced group financial-document-processor with generation 95
2025-05-10 11:31:08.624 | INFO     | logging:callHandlers:1706 - Setting newly assigned partitions {TopicPartition(topic='documents-processing', partition=0)} for group financial-document-processor
2025-05-10 11:31:08.628 | INFO     | logging:callHandlers:1706 - Consumidor Kafka iniciado para o tópico documents-processing
2025-05-10 11:31:08.629 | INFO     | logging:callHandlers:1706 - Aplicação inicializada com sucesso
2025-05-10 11:31:08.629 | INFO     | logging:callHandlers:1706 - Aplicação em execução
2025-05-10 11:31:08.636 | INFO     | logging:callHandlers:1706 - Fetch offset 11 is out of range for partition TopicPartition(topic='documents-processing', partition=0), resetting offset
2025-05-10 11:31:08.643 | INFO     | logging:callHandlers:1706 - Processando documento 15 do tipo bank_statement
2025-05-10 11:31:08.709 | INFO     | logging:callHandlers:1706 - Iniciando processamento do documento 15 do tipo bank_statement para o usuário 2
2025-05-10 11:31:09.321 | INFO     | logging:callHandlers:1706 - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 400 Bad Request"
2025-05-10 11:31:09.324 | ERROR    | logging:callHandlers:1706 - Erro na chamada para Claude: Error code: 400 - {'type': 'error', 'error': {'type': 'invalid_request_error', 'message': 'max_tokens: 10000 > 4096, which is the maximum allowed number of output tokens for claude-3-opus-20240229'}}
2025-05-10 11:31:11.511 | INFO     | logging:callHandlers:1706 - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 400 Bad Request"
2025-05-10 11:31:11.514 | ERROR    | logging:callHandlers:1706 - Erro na chamada para Claude: Error code: 400 - {'type': 'error', 'error': {'type': 'invalid_request_error', 'message': 'max_tokens: 10000 > 4096, which is the maximum allowed number of output tokens for claude-3-opus-20240229'}}
2025-05-10 11:31:13.701 | INFO     | logging:callHandlers:1706 - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 400 Bad Request"
2025-05-10 11:31:13.704 | ERROR    | logging:callHandlers:1706 - Erro na chamada para Claude: Error code: 400 - {'type': 'error', 'error': {'type': 'invalid_request_error', 'message': 'max_tokens: 10000 > 4096, which is the maximum allowed number of output tokens for claude-3-opus-20240229'}}
2025-05-10 11:31:13.704 | ERROR    | logging:callHandlers:1706 - Erro ao processar documento 15: RetryError[<Future at 0x11d21a990 state=finished raised BadRequestError>]
2025-05-10 11:31:13.705 | ERROR    | logging:callHandlers:1706 - Erro ao processar documento 15: RetryError[<Future at 0x11d21a990 state=finished raised BadRequestError>]
2025-05-10 11:31:13.734 | INFO     | logging:callHandlers:1706 - Mensagem processada em 5.09s: documento_id=15, tipo=bank_statement
2025-05-10 11:31:22.790 | INFO     | logging:callHandlers:1706 - Sinal 2 recebido, iniciando desligamento...
2025-05-10 11:31:22.875 | INFO     | logging:callHandlers:1706 - Iniciando desligamento da aplicação...
2025-05-10 11:31:22.877 | INFO     | logging:callHandlers:1706 - Tarefa de consumo cancelada
2025-05-10 11:31:22.906 | INFO     | logging:callHandlers:1706 - LeaveGroup request succeeded
2025-05-10 11:31:22.910 | INFO     | logging:callHandlers:1706 - Consumidor Kafka parado
2025-05-10 11:31:22.914 | INFO     | logging:callHandlers:1706 - Produtor Kafka parado
2025-05-10 11:31:22.932 | INFO     | logging:callHandlers:1706 - Conexão com PostgreSQL encerrada
2025-05-10 11:31:22.933 | INFO     | logging:callHandlers:1706 - Aplicação desligada com sucesso
2025-05-10 11:31:25.365 | INFO     | financial_document_processor.utils.logging:setup_logging:69 - Sistema de logging configurado com nível INFO
2025-05-10 11:31:25.371 | INFO     | logging:callHandlers:1706 - Inicializando aplicação...
2025-05-10 11:31:25.524 | INFO     | logging:callHandlers:1706 - Conexão estabelecida com o PostgreSQL. Pool criado com 5-20 conexões.
2025-05-10 11:31:25.530 | INFO     | logging:callHandlers:1706 - Esquema do banco de dados verificado/criado com sucesso
2025-05-10 11:31:25.558 | INFO     | logging:callHandlers:1706 - Produtor Kafka iniciado
2025-05-10 11:31:25.596 | INFO     | logging:callHandlers:1706 - Usando provedor de IA: claude
2025-05-10 11:31:25.598 | INFO     | logging:callHandlers:1706 - Carregadas 61 categorias padrão
2025-05-10 11:31:25.599 | INFO     | logging:callHandlers:1706 - Serviço de categorização inicializado
2025-05-10 11:31:25.599 | INFO     | logging:callHandlers:1706 - Updating subscribed topics to: frozenset({'documents-processing'})
2025-05-10 11:31:25.624 | INFO     | logging:callHandlers:1706 - Discovered coordinator 1 for group financial-document-processor
2025-05-10 11:31:25.624 | INFO     | logging:callHandlers:1706 - Revoking previously assigned partitions set() for group financial-document-processor
2025-05-10 11:31:25.624 | INFO     | logging:callHandlers:1706 - (Re-)joining group financial-document-processor
2025-05-10 11:31:28.637 | INFO     | logging:callHandlers:1706 - Joined group 'financial-document-processor' (generation 97) with member_id aiokafka-0.12.0-28ef7301-3c56-488e-a98e-e07d32e9c845
2025-05-10 11:31:28.638 | INFO     | logging:callHandlers:1706 - Elected group leader -- performing partition assignments using roundrobin
2025-05-10 11:31:28.651 | INFO     | logging:callHandlers:1706 - Successfully synced group financial-document-processor with generation 97
2025-05-10 11:31:28.653 | INFO     | logging:callHandlers:1706 - Setting newly assigned partitions {TopicPartition(topic='documents-processing', partition=0)} for group financial-document-processor
2025-05-10 11:31:28.654 | INFO     | logging:callHandlers:1706 - Consumidor Kafka iniciado para o tópico documents-processing
2025-05-10 11:31:28.654 | INFO     | logging:callHandlers:1706 - Aplicação inicializada com sucesso
2025-05-10 11:31:28.654 | INFO     | logging:callHandlers:1706 - Aplicação em execução
2025-05-10 11:37:01.267 | INFO     | logging:callHandlers:1706 - Processando documento 16 do tipo bank_statement
2025-05-10 11:37:01.786 | INFO     | logging:callHandlers:1706 - Iniciando processamento do documento 16 do tipo bank_statement para o usuário 2
2025-05-10 11:39:16.480 | INFO     | logging:callHandlers:1706 - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-05-10 11:42:39.088 | INFO     | logging:callHandlers:1706 - Sinal 2 recebido, iniciando desligamento...
2025-05-10 11:52:46.363 | INFO     | financial_document_processor.utils.logging:setup_logging:69 - Sistema de logging configurado com nível INFO
2025-05-10 11:52:46.383 | INFO     | logging:callHandlers:1706 - Inicializando aplicação...
2025-05-10 11:52:46.618 | INFO     | logging:callHandlers:1706 - Conexão estabelecida com o PostgreSQL. Pool criado com 5-20 conexões.
2025-05-10 11:52:46.629 | INFO     | logging:callHandlers:1706 - Esquema do banco de dados verificado/criado com sucesso
2025-05-10 11:52:46.666 | INFO     | logging:callHandlers:1706 - Produtor Kafka iniciado
2025-05-10 11:52:46.666 | INFO     | logging:callHandlers:1706 - Usando provedor de IA: gemini
2025-05-10 11:52:46.667 | INFO     | logging:callHandlers:1706 - Carregadas 61 categorias padrão
2025-05-10 11:52:46.667 | INFO     | logging:callHandlers:1706 - Serviço de categorização inicializado
2025-05-10 11:52:46.668 | INFO     | logging:callHandlers:1706 - Updating subscribed topics to: frozenset({'documents-processing'})
2025-05-10 11:52:46.707 | INFO     | logging:callHandlers:1706 - Discovered coordinator 1 for group financial-document-processor
2025-05-10 11:52:46.707 | INFO     | logging:callHandlers:1706 - Revoking previously assigned partitions set() for group financial-document-processor
2025-05-10 11:52:46.708 | INFO     | logging:callHandlers:1706 - (Re-)joining group financial-document-processor
2025-05-10 11:52:49.749 | INFO     | logging:callHandlers:1706 - Joined group 'financial-document-processor' (generation 99) with member_id aiokafka-0.12.0-2e9f87b1-c5c8-426d-a36c-25424264cd9c
2025-05-10 11:52:49.749 | INFO     | logging:callHandlers:1706 - Elected group leader -- performing partition assignments using roundrobin
2025-05-10 11:52:49.788 | INFO     | logging:callHandlers:1706 - Successfully synced group financial-document-processor with generation 99
2025-05-10 11:52:49.790 | INFO     | logging:callHandlers:1706 - Setting newly assigned partitions {TopicPartition(topic='documents-processing', partition=0)} for group financial-document-processor
2025-05-10 11:52:49.790 | INFO     | logging:callHandlers:1706 - Consumidor Kafka iniciado para o tópico documents-processing
2025-05-10 11:52:49.791 | INFO     | logging:callHandlers:1706 - Aplicação inicializada com sucesso
2025-05-10 11:52:49.791 | INFO     | logging:callHandlers:1706 - Aplicação em execução
2025-05-10 11:52:49.820 | INFO     | logging:callHandlers:1706 - Processando documento 16 do tipo bank_statement
2025-05-10 11:52:49.890 | INFO     | logging:callHandlers:1706 - Iniciando processamento do documento 16 do tipo bank_statement para o usuário 2
2025-05-10 11:52:50.572 | ERROR    | logging:callHandlers:1706 - Erro na chamada para Gemini: 400 Content with system role is not supported.
2025-05-10 11:52:52.703 | ERROR    | logging:callHandlers:1706 - Erro na chamada para Gemini: 400 Content with system role is not supported.
2025-05-10 11:52:54.845 | ERROR    | logging:callHandlers:1706 - Erro na chamada para Gemini: 400 Content with system role is not supported.
2025-05-10 11:52:54.846 | ERROR    | logging:callHandlers:1706 - Erro ao processar documento 16: RetryError[<Future at 0x10a392690 state=finished raised InvalidArgument>]
2025-05-10 11:52:54.846 | ERROR    | logging:callHandlers:1706 - Erro ao processar documento 16: RetryError[<Future at 0x10a392690 state=finished raised InvalidArgument>]
2025-05-10 11:52:54.886 | INFO     | logging:callHandlers:1706 - Mensagem processada em 5.07s: documento_id=16, tipo=bank_statement
2025-05-10 11:59:24.282 | INFO     | logging:callHandlers:1706 - Processando documento 17 do tipo bank_statement
2025-05-10 11:59:24.932 | INFO     | logging:callHandlers:1706 - Iniciando processamento do documento 17 do tipo bank_statement para o usuário 2
2025-05-10 12:00:58.026 | ERROR    | logging:callHandlers:1706 - Erro na chamada para Gemini: 400 Content with system role is not supported.
2025-05-10 12:00:58.050 | WARNING  | logging:callHandlers:1706 - Heartbeat failed: local member_id was not recognized; resetting and re-joining group
2025-05-10 12:00:58.050 | ERROR    | logging:callHandlers:1706 - Heartbeat session expired - marking coordinator dead
2025-05-10 12:00:58.051 | WARNING  | logging:callHandlers:1706 - Marking the coordinator dead (node 1)for group financial-document-processor.
2025-05-10 12:00:58.064 | INFO     | logging:callHandlers:1706 - Discovered coordinator 1 for group financial-document-processor
2025-05-10 12:00:58.065 | INFO     | logging:callHandlers:1706 - Revoking previously assigned partitions frozenset({TopicPartition(topic='documents-processing', partition=0)}) for group financial-document-processor
2025-05-10 12:00:58.065 | INFO     | logging:callHandlers:1706 - (Re-)joining group financial-document-processor
2025-05-10 12:01:06.138 | ERROR    | logging:callHandlers:1706 - Erro na chamada para Gemini: 400 Content with system role is not supported.
2025-05-10 12:01:06.141 | INFO     | logging:callHandlers:1706 - Joined group 'financial-document-processor' (generation 101) with member_id aiokafka-0.12.0-71b0156f-25e6-42bc-9d36-fabf2f558911
2025-05-10 12:01:06.141 | INFO     | logging:callHandlers:1706 - Elected group leader -- performing partition assignments using roundrobin
2025-05-10 12:01:06.158 | INFO     | logging:callHandlers:1706 - Successfully synced group financial-document-processor with generation 101
2025-05-10 12:01:06.160 | INFO     | logging:callHandlers:1706 - Setting newly assigned partitions {TopicPartition(topic='documents-processing', partition=0)} for group financial-document-processor
2025-05-10 12:01:31.522 | ERROR    | logging:callHandlers:1706 - Erro na chamada para Gemini: 400 Content with system role is not supported.
2025-05-10 12:01:31.995 | ERROR    | logging:callHandlers:1706 - Erro ao processar documento 17: RetryError[<Future at 0x10a470150 state=finished raised InvalidArgument>]
2025-05-10 12:01:31.996 | ERROR    | logging:callHandlers:1706 - Erro ao processar documento 17: RetryError[<Future at 0x10a470150 state=finished raised InvalidArgument>]
2025-05-10 12:01:32.006 | WARNING  | logging:callHandlers:1706 - Heartbeat failed: local member_id was not recognized; resetting and re-joining group
2025-05-10 12:01:32.006 | ERROR    | logging:callHandlers:1706 - Heartbeat session expired - marking coordinator dead
2025-05-10 12:01:32.007 | WARNING  | logging:callHandlers:1706 - Marking the coordinator dead (node 1)for group financial-document-processor.
2025-05-10 12:01:32.025 | INFO     | logging:callHandlers:1706 - Discovered coordinator 1 for group financial-document-processor
2025-05-10 12:01:32.025 | INFO     | logging:callHandlers:1706 - Revoking previously assigned partitions frozenset({TopicPartition(topic='documents-processing', partition=0)}) for group financial-document-processor
2025-05-10 12:01:32.025 | INFO     | logging:callHandlers:1706 - (Re-)joining group financial-document-processor
2025-05-10 12:01:32.078 | INFO     | logging:callHandlers:1706 - Mensagem processada em 127.81s: documento_id=17, tipo=bank_statement
2025-05-10 12:01:35.043 | INFO     | logging:callHandlers:1706 - Joined group 'financial-document-processor' (generation 103) with member_id aiokafka-0.12.0-d15ac5f7-c63b-4a0c-a0f1-2e5cceff9c55
2025-05-10 12:01:35.044 | INFO     | logging:callHandlers:1706 - Elected group leader -- performing partition assignments using roundrobin
2025-05-10 12:01:35.047 | ERROR    | logging:callHandlers:1706 - OffsetCommit failed for group financial-document-processor due to group error ([Error 22] IllegalGenerationError: financial-document-processor), will rejoin
2025-05-10 12:01:35.048 | ERROR    | logging:callHandlers:1706 - Erro ao processar mensagem: CommitFailedError: ('Commit cannot be completed since the group has already\n            rebalanced and assigned the partitions to another member.\n            This means that the time between subsequent calls to poll()\n            was longer than the configured max_poll_interval_ms, which\n            typically implies that the poll loop is spending too much\n            time message processing. You can address this either by\n            increasing the rebalance timeout with max_poll_interval_ms,\n            or by reducing the maximum size of batches returned in poll()\n            with max_poll_records.\n            ', 'Commit cannot be completed since the group has already rebalanced and may have assigned the partitions to another member')
2025-05-10 12:01:35.050 | INFO     | logging:callHandlers:1706 - Successfully synced group financial-document-processor with generation -1
2025-05-10 12:01:35.056 | INFO     | logging:callHandlers:1706 - Setting newly assigned partitions {TopicPartition(topic='documents-processing', partition=0)} for group financial-document-processor
2025-05-10 12:01:35.057 | INFO     | logging:callHandlers:1706 - Revoking previously assigned partitions frozenset({TopicPartition(topic='documents-processing', partition=0)}) for group financial-document-processor
2025-05-10 12:01:35.058 | INFO     | logging:callHandlers:1706 - (Re-)joining group financial-document-processor
2025-05-10 12:01:35.063 | INFO     | logging:callHandlers:1706 - Joined group 'financial-document-processor' (generation 104) with member_id aiokafka-0.12.0-d15ac5f7-c63b-4a0c-a0f1-2e5cceff9c55
2025-05-10 12:01:35.063 | INFO     | logging:callHandlers:1706 - Elected group leader -- performing partition assignments using roundrobin
2025-05-10 12:01:35.067 | INFO     | logging:callHandlers:1706 - Successfully synced group financial-document-processor with generation 104
2025-05-10 12:01:35.068 | INFO     | logging:callHandlers:1706 - Setting newly assigned partitions {TopicPartition(topic='documents-processing', partition=0)} for group financial-document-processor
2025-05-10 12:01:35.088 | INFO     | logging:callHandlers:1706 - Processando documento 17 do tipo bank_statement
2025-05-10 12:01:35.107 | INFO     | logging:callHandlers:1706 - Iniciando processamento do documento 17 do tipo bank_statement para o usuário 2
2025-05-10 12:01:54.756 | INFO     | logging:callHandlers:1706 - Sinal 2 recebido, iniciando desligamento...
2025-05-10 12:01:57.546 | INFO     | financial_document_processor.utils.logging:setup_logging:69 - Sistema de logging configurado com nível INFO
2025-05-10 12:01:57.561 | INFO     | logging:callHandlers:1706 - Inicializando aplicação...
2025-05-10 12:01:57.728 | INFO     | logging:callHandlers:1706 - Conexão estabelecida com o PostgreSQL. Pool criado com 5-20 conexões.
2025-05-10 12:01:57.742 | INFO     | logging:callHandlers:1706 - Esquema do banco de dados verificado/criado com sucesso
2025-05-10 12:01:57.772 | INFO     | logging:callHandlers:1706 - Produtor Kafka iniciado
2025-05-10 12:01:57.772 | INFO     | logging:callHandlers:1706 - Usando provedor de IA: gemini
2025-05-10 12:01:57.773 | INFO     | logging:callHandlers:1706 - Carregadas 61 categorias padrão
2025-05-10 12:01:57.773 | INFO     | logging:callHandlers:1706 - Serviço de categorização inicializado
2025-05-10 12:01:57.774 | INFO     | logging:callHandlers:1706 - Updating subscribed topics to: frozenset({'documents-processing'})
2025-05-10 12:01:57.797 | INFO     | logging:callHandlers:1706 - Discovered coordinator 1 for group financial-document-processor
2025-05-10 12:01:57.797 | INFO     | logging:callHandlers:1706 - Revoking previously assigned partitions set() for group financial-document-processor
2025-05-10 12:01:57.797 | INFO     | logging:callHandlers:1706 - (Re-)joining group financial-document-processor
2025-05-10 12:02:00.812 | INFO     | logging:callHandlers:1706 - Joined group 'financial-document-processor' (generation 106) with member_id aiokafka-0.12.0-8639e587-ba1a-4437-9873-988f1415653c
2025-05-10 12:02:00.813 | INFO     | logging:callHandlers:1706 - Elected group leader -- performing partition assignments using roundrobin
2025-05-10 12:02:00.828 | INFO     | logging:callHandlers:1706 - Successfully synced group financial-document-processor with generation 106
2025-05-10 12:02:00.830 | INFO     | logging:callHandlers:1706 - Setting newly assigned partitions {TopicPartition(topic='documents-processing', partition=0)} for group financial-document-processor
2025-05-10 12:02:00.830 | INFO     | logging:callHandlers:1706 - Consumidor Kafka iniciado para o tópico documents-processing
2025-05-10 12:02:00.831 | INFO     | logging:callHandlers:1706 - Aplicação inicializada com sucesso
2025-05-10 12:02:00.831 | INFO     | logging:callHandlers:1706 - Aplicação em execução
2025-05-10 12:02:00.837 | INFO     | logging:callHandlers:1706 - Processando documento 17 do tipo bank_statement
2025-05-10 12:02:00.916 | INFO     | logging:callHandlers:1706 - Iniciando processamento do documento 17 do tipo bank_statement para o usuário 2
2025-05-10 12:07:23.184 | ERROR    | logging:callHandlers:1706 - Erro ao converter item para Transaction: 1 validation error for Transaction
date
  Input should be a valid date [type=date_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.11/v/date_type
2025-05-10 12:07:23.188 | ERROR    | logging:callHandlers:1706 - Erro ao converter item para Transaction: 1 validation error for Transaction
date
  Input should be a valid date [type=date_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.11/v/date_type
2025-05-10 12:07:23.189 | ERROR    | logging:callHandlers:1706 - Erro ao converter item para Transaction: 1 validation error for Transaction
date
  Input should be a valid date [type=date_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.11/v/date_type
2025-05-10 12:07:23.189 | ERROR    | logging:callHandlers:1706 - Erro ao converter item para Transaction: 1 validation error for Transaction
date
  Input should be a valid date [type=date_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.11/v/date_type
2025-05-10 12:07:23.189 | ERROR    | logging:callHandlers:1706 - Erro ao converter item para Transaction: 1 validation error for Transaction
date
  Input should be a valid date [type=date_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.11/v/date_type
2025-05-10 12:07:23.189 | ERROR    | logging:callHandlers:1706 - Erro ao converter item para Transaction: 1 validation error for Transaction
date
  Input should be a valid date [type=date_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.11/v/date_type
2025-05-10 12:07:23.189 | ERROR    | logging:callHandlers:1706 - Erro ao converter item para Transaction: 1 validation error for Transaction
date
  Input should be a valid date [type=date_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.11/v/date_type
2025-05-10 12:09:24.067 | ERROR    | logging:callHandlers:1706 - Erro ao processar documento 17: 'list' object has no attribute 'document_id'
2025-05-10 12:09:24.069 | ERROR    | logging:callHandlers:1706 - Erro ao processar documento 17: 'list' object has no attribute 'document_id'
2025-05-10 12:09:24.104 | WARNING  | logging:callHandlers:1706 - Heartbeat failed: local member_id was not recognized; resetting and re-joining group
2025-05-10 12:09:24.105 | ERROR    | logging:callHandlers:1706 - Heartbeat session expired - marking coordinator dead
2025-05-10 12:09:24.105 | WARNING  | logging:callHandlers:1706 - Marking the coordinator dead (node 1)for group financial-document-processor.
2025-05-10 12:09:24.116 | INFO     | logging:callHandlers:1706 - Discovered coordinator 1 for group financial-document-processor
2025-05-10 12:09:24.116 | INFO     | logging:callHandlers:1706 - Revoking previously assigned partitions frozenset({TopicPartition(topic='documents-processing', partition=0)}) for group financial-document-processor
2025-05-10 12:09:24.210 | INFO     | logging:callHandlers:1706 - Mensagem processada em 443.37s: documento_id=17, tipo=bank_statement
2025-05-10 12:09:24.318 | INFO     | logging:callHandlers:1706 - (Re-)joining group financial-document-processor
2025-05-10 12:09:27.342 | INFO     | logging:callHandlers:1706 - Joined group 'financial-document-processor' (generation 108) with member_id aiokafka-0.12.0-a5c471e3-1d6e-4ad0-ab11-a265fc5ee74e
2025-05-10 12:09:27.342 | INFO     | logging:callHandlers:1706 - Elected group leader -- performing partition assignments using roundrobin
2025-05-10 12:09:27.351 | INFO     | logging:callHandlers:1706 - Successfully synced group financial-document-processor with generation 108
2025-05-10 12:09:27.356 | INFO     | logging:callHandlers:1706 - Setting newly assigned partitions {TopicPartition(topic='documents-processing', partition=0)} for group financial-document-processor
2025-05-10 12:10:35.831 | INFO     | logging:callHandlers:1706 - Sinal 2 recebido, iniciando desligamento...
2025-05-10 12:10:35.920 | INFO     | logging:callHandlers:1706 - Iniciando desligamento da aplicação...
2025-05-10 12:10:35.921 | INFO     | logging:callHandlers:1706 - Tarefa de consumo cancelada
2025-05-10 12:10:35.945 | INFO     | logging:callHandlers:1706 - LeaveGroup request succeeded
2025-05-10 12:10:35.948 | INFO     | logging:callHandlers:1706 - Consumidor Kafka parado
2025-05-10 12:10:35.949 | INFO     | logging:callHandlers:1706 - Produtor Kafka parado
2025-05-10 12:10:35.959 | INFO     | logging:callHandlers:1706 - Conexão com PostgreSQL encerrada
2025-05-10 12:10:35.959 | INFO     | logging:callHandlers:1706 - Aplicação desligada com sucesso
2025-05-10 12:10:40.823 | INFO     | financial_document_processor.utils.logging:setup_logging:69 - Sistema de logging configurado com nível INFO
2025-05-10 12:10:40.844 | INFO     | logging:callHandlers:1706 - Inicializando aplicação...
2025-05-10 12:10:41.014 | INFO     | logging:callHandlers:1706 - Conexão estabelecida com o PostgreSQL. Pool criado com 5-20 conexões.
2025-05-10 12:10:41.024 | INFO     | logging:callHandlers:1706 - Esquema do banco de dados verificado/criado com sucesso
2025-05-10 12:10:41.048 | INFO     | logging:callHandlers:1706 - Produtor Kafka iniciado
2025-05-10 12:10:41.049 | INFO     | logging:callHandlers:1706 - Usando provedor de IA: gemini
2025-05-10 12:10:41.050 | INFO     | logging:callHandlers:1706 - Carregadas 61 categorias padrão
2025-05-10 12:10:41.050 | INFO     | logging:callHandlers:1706 - Serviço de categorização inicializado
2025-05-10 12:10:41.050 | INFO     | logging:callHandlers:1706 - Updating subscribed topics to: frozenset({'documents-processing'})
2025-05-10 12:10:41.072 | INFO     | logging:callHandlers:1706 - Discovered coordinator 1 for group financial-document-processor
2025-05-10 12:10:41.073 | INFO     | logging:callHandlers:1706 - Revoking previously assigned partitions set() for group financial-document-processor
2025-05-10 12:10:41.073 | INFO     | logging:callHandlers:1706 - (Re-)joining group financial-document-processor
2025-05-10 12:10:44.084 | INFO     | logging:callHandlers:1706 - Joined group 'financial-document-processor' (generation 110) with member_id aiokafka-0.12.0-5260d7cd-8d75-4923-9d79-a112c2c99d45
2025-05-10 12:10:44.085 | INFO     | logging:callHandlers:1706 - Elected group leader -- performing partition assignments using roundrobin
2025-05-10 12:10:44.094 | INFO     | logging:callHandlers:1706 - Successfully synced group financial-document-processor with generation 110
2025-05-10 12:10:44.096 | INFO     | logging:callHandlers:1706 - Setting newly assigned partitions {TopicPartition(topic='documents-processing', partition=0)} for group financial-document-processor
2025-05-10 12:10:44.096 | INFO     | logging:callHandlers:1706 - Consumidor Kafka iniciado para o tópico documents-processing
2025-05-10 12:10:44.097 | INFO     | logging:callHandlers:1706 - Aplicação inicializada com sucesso
2025-05-10 12:10:44.097 | INFO     | logging:callHandlers:1706 - Aplicação em execução
2025-05-10 12:11:03.526 | INFO     | logging:callHandlers:1706 - Processando documento 18 do tipo bank_statement
2025-05-10 12:11:04.105 | INFO     | logging:callHandlers:1706 - Iniciando processamento do documento 18 do tipo bank_statement para o usuário 2
2025-05-10 12:12:32.233 | INFO     | logging:callHandlers:1706 - Processamento do documento 18 concluído em 88.13s. Extraídas 44 transações.
2025-05-10 12:12:32.251 | WARNING  | logging:callHandlers:1706 - Heartbeat failed: local member_id was not recognized; resetting and re-joining group
2025-05-10 12:12:32.252 | ERROR    | logging:callHandlers:1706 - Heartbeat session expired - marking coordinator dead
2025-05-10 12:12:32.252 | WARNING  | logging:callHandlers:1706 - Marking the coordinator dead (node 1)for group financial-document-processor.
2025-05-10 12:12:32.258 | INFO     | logging:callHandlers:1706 - Discovered coordinator 1 for group financial-document-processor
2025-05-10 12:12:32.259 | INFO     | logging:callHandlers:1706 - Revoking previously assigned partitions frozenset({TopicPartition(topic='documents-processing', partition=0)}) for group financial-document-processor
2025-05-10 12:12:32.259 | INFO     | logging:callHandlers:1706 - (Re-)joining group financial-document-processor
2025-05-10 12:12:32.319 | INFO     | logging:callHandlers:1706 - Salvas 44 transações com sucesso
2025-05-10 12:12:32.346 | INFO     | logging:callHandlers:1706 - Documento 18 processado com sucesso. Extraídas 44 transações.
2025-05-10 12:12:32.346 | INFO     | logging:callHandlers:1706 - Mensagem processada em 88.82s: documento_id=18, tipo=bank_statement
2025-05-10 12:12:35.277 | INFO     | logging:callHandlers:1706 - Joined group 'financial-document-processor' (generation 112) with member_id aiokafka-0.12.0-53554975-e9a8-4a75-8e09-a6aba5680f61
2025-05-10 12:12:35.278 | INFO     | logging:callHandlers:1706 - Elected group leader -- performing partition assignments using roundrobin
2025-05-10 12:12:35.284 | ERROR    | logging:callHandlers:1706 - OffsetCommit failed for group financial-document-processor due to group error ([Error 22] IllegalGenerationError: financial-document-processor), will rejoin
2025-05-10 12:12:35.286 | ERROR    | logging:callHandlers:1706 - Erro ao processar mensagem: CommitFailedError: ('Commit cannot be completed since the group has already\n            rebalanced and assigned the partitions to another member.\n            This means that the time between subsequent calls to poll()\n            was longer than the configured max_poll_interval_ms, which\n            typically implies that the poll loop is spending too much\n            time message processing. You can address this either by\n            increasing the rebalance timeout with max_poll_interval_ms,\n            or by reducing the maximum size of batches returned in poll()\n            with max_poll_records.\n            ', 'Commit cannot be completed since the group has already rebalanced and may have assigned the partitions to another member')
2025-05-10 12:12:35.289 | INFO     | logging:callHandlers:1706 - Successfully synced group financial-document-processor with generation -1
2025-05-10 12:12:35.299 | INFO     | logging:callHandlers:1706 - Setting newly assigned partitions {TopicPartition(topic='documents-processing', partition=0)} for group financial-document-processor
2025-05-10 12:12:35.301 | INFO     | logging:callHandlers:1706 - Revoking previously assigned partitions frozenset({TopicPartition(topic='documents-processing', partition=0)}) for group financial-document-processor
2025-05-10 12:12:35.302 | INFO     | logging:callHandlers:1706 - (Re-)joining group financial-document-processor
2025-05-10 12:12:35.308 | INFO     | logging:callHandlers:1706 - Joined group 'financial-document-processor' (generation 113) with member_id aiokafka-0.12.0-53554975-e9a8-4a75-8e09-a6aba5680f61
2025-05-10 12:12:35.309 | INFO     | logging:callHandlers:1706 - Elected group leader -- performing partition assignments using roundrobin
2025-05-10 12:12:35.317 | INFO     | logging:callHandlers:1706 - Successfully synced group financial-document-processor with generation 113
2025-05-10 12:12:35.320 | INFO     | logging:callHandlers:1706 - Setting newly assigned partitions {TopicPartition(topic='documents-processing', partition=0)} for group financial-document-processor
2025-05-10 12:12:35.326 | INFO     | logging:callHandlers:1706 - Processando documento 18 do tipo bank_statement
2025-05-10 12:12:35.341 | INFO     | logging:callHandlers:1706 - Iniciando processamento do documento 18 do tipo bank_statement para o usuário 2
2025-05-10 12:13:28.780 | INFO     | logging:callHandlers:1706 - Sinal 2 recebido, iniciando desligamento...
